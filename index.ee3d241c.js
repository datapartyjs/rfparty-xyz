var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function e(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,enumerable:!0,configurable:!0})}var i={},n={},r=t.parcelRequire8253;null==r&&((r=function(t){if(t in i)return i[t].exports;if(t in n){var e=n[t];delete n[t];var r={id:t,exports:{}};return i[t]=r,e.call(r.exports,r,r.exports),r.exports}var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(t,e){n[t]=e},t.parcelRequire8253=r),r.register("k03Ww",(function(t,e){var i,n;i=t.exports,n=function(){return function(){function t(t,e){if(this.app="loki",this.options=e||{},void 0!==t&&(this.app=t),this.catalog=null,!this.checkAvailability())throw new Error("indexedDB does not seem to be supported for your environment")}function e(t){this.db=null,this.initializeLokiCatalog(t)}return t.prototype.closeDatabase=function(){this.catalog&&this.catalog.db&&(this.catalog.db.close(),this.catalog.db=null)},t.prototype.checkAvailability=function(){return!("undefined"==typeof indexedDB||!indexedDB)},t.prototype.loadDatabase=function(t,i){var n=this.app,r=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(n,t,(function(t){if("function"==typeof i){if(0===t.id)return void i(null);i(t.val)}else console.log(t.val)})):this.catalog=new e((function(e){r.catalog=e,r.loadDatabase(t,i)}))},t.prototype.loadKey=t.prototype.loadDatabase,t.prototype.saveDatabase=function(t,i,n){var r=this.app,o=this;function s(t){t&&!0===t.success?n(null):n(new Error("Error saving database")),o.options.closeAfterSave&&o.closeDatabase()}null!==this.catalog&&null!==this.catalog.db?this.catalog.setAppKey(r,t,i,s):this.catalog=new e((function(e){o.saveDatabase(t,i,s)}))},t.prototype.saveKey=t.prototype.saveDatabase,t.prototype.deleteDatabase=function(t,i){var n=this.app,r=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(n,t,(function(t){var e=t.id;0!==e?r.catalog.deleteAppKey(e,i):"function"==typeof i&&i({success:!0})})):this.catalog=new e((function(e){r.catalog=e,r.deleteDatabase(t,i)}))},t.prototype.deleteKey=t.prototype.deleteDatabase,t.prototype.deleteDatabasePartitions=function(t){var e=this;this.getDatabaseList((function(i){i.forEach((function(i){i.startsWith(t)&&e.deleteDatabase(i)}))}))},t.prototype.getDatabaseList=function(t){var i=this.app,n=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKeys(i,(function(e){for(var i=[],n=0;n<e.length;n++)i.push(e[n].key);"function"==typeof t?t(i):i.forEach((function(t){console.log(t)}))})):this.catalog=new e((function(e){n.catalog=e,n.getDatabaseList(t)}))},t.prototype.getKeyList=t.prototype.getDatabaseList,t.prototype.getCatalogSummary=function(t){this.app;var i=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAllKeys((function(e){for(var i,n,r,o,s,a=[],l=0;l<e.length;l++)r=(i=e[l]).app||"",o=i.key||"",s=i.val||"",n=2*r.length+2*o.length+s.length+1,a.push({app:i.app,key:i.key,size:n});"function"==typeof t?t(a):a.forEach((function(t){console.log(t)}))})):this.catalog=new e((function(e){i.catalog=e,i.getCatalogSummary(t)}))},e.prototype.initializeLokiCatalog=function(t){var e=indexedDB.open("LokiCatalog",1),i=this;e.onupgradeneeded=function(t){var e=t.target.result;if(e.objectStoreNames.contains("LokiAKV")&&e.deleteObjectStore("LokiAKV"),!e.objectStoreNames.contains("LokiAKV")){var i=e.createObjectStore("LokiAKV",{keyPath:"id",autoIncrement:!0});i.createIndex("app","app",{unique:!1}),i.createIndex("key","key",{unique:!1}),i.createIndex("appkey","appkey",{unique:!0})}},e.onsuccess=function(e){i.db=e.target.result,"function"==typeof t&&t(i)},e.onerror=function(t){throw t}},e.prototype.getAppKey=function(t,e,i){var n,r=t+","+e,o=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("appkey").get(r);o.onsuccess=(n=i,function(t){var e=t.target.result;null==e&&(e={id:0,success:!1}),"function"==typeof n?n(e):console.log(e)}),o.onerror=function(t){return function(e){if("function"!=typeof t)throw e;t({id:0,success:!1})}}(i)},e.prototype.getAppKeyById=function(t,e,i){var n,r;this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").get(t).onsuccess=(n=i,r=e,function(t){"function"==typeof r?r(t.target.result,n):console.log(t.target.result)})},e.prototype.setAppKey=function(t,e,i,n){var r,o=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV"),s=o.index("appkey"),a=t+","+e,l=s.get(a);l.onsuccess=function(r){var s=r.target.result;null==s?s={app:t,key:e,appkey:t+","+e,val:i}:s.val=i;var a,u=o.put(s);u.onerror=(a=n,function(t){"function"==typeof a?a({success:!1}):(console.error("LokiCatalog.setAppKey (set) onerror"),console.error(l.error))}),u.onsuccess=function(t){return function(e){"function"==typeof t&&t({success:!0})}}(n)},l.onerror=(r=n,function(t){"function"==typeof r?r({success:!1}):(console.error("LokiCatalog.setAppKey (get) onerror"),console.error(l.error))})},e.prototype.deleteAppKey=function(t,e){var i,n=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV").delete(t);n.onsuccess=(i=e,function(t){"function"==typeof i&&i({success:!0})}),n.onerror=function(t){return function(e){"function"==typeof t?t({success:!1}):(console.error("LokiCatalog.deleteAppKey raised onerror"),console.error(n.error))}}(e)},e.prototype.getAppKeys=function(t,e){var i,n,r,o=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("app"),s=IDBKeyRange.only(t),a=o.openCursor(s);a.onsuccess=(i=[],n=e,function(t){var e=t.target.result;if(e){var r=e.value;i.push(r),e.continue()}else"function"==typeof n?n(i):console.log(i)}),a.onerror=(r=e,function(t){"function"==typeof r?r(null):(console.error("LokiCatalog.getAppKeys raised onerror"),console.error(t))})},e.prototype.getAllKeys=function(t){var e,i,n,r=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").openCursor();r.onsuccess=(e=[],i=t,function(t){var n=t.target.result;if(n){var r=n.value;e.push(r),n.continue()}else"function"==typeof i?i(e):console.log(e)}),r.onerror=(n=t,function(t){"function"==typeof n&&n(null)})},t}()},"function"==typeof define&&define.amd?define([],n):"object"==typeof t.exports?t.exports=n():i.LokiIndexedAdapter=n()})),r.register("kjyEk",(function(t,e){})),r.register("45fvw",(function(t,e){!function(i,n){"object"==typeof e?t.exports=n():"function"==typeof define&&define.amd?define(n):i.moment=n()}(this,(function(){var e,i;function n(){return e.apply(null,arguments)}function r(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function o(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function a(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(s(t,e))return!1;return!0}function l(t){return void 0===t}function u(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function h(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function c(t,e){var i,n=[];for(i=0;i<t.length;++i)n.push(e(t[i],i));return n}function d(t,e){for(var i in e)s(e,i)&&(t[i]=e[i]);return s(e,"toString")&&(t.toString=e.toString),s(e,"valueOf")&&(t.valueOf=e.valueOf),t}function f(t,e,i,n){return Se(t,e,i,n,!0).utc()}function p(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function m(t){if(null==t._isValid){var e=p(t),n=i.call(e.parsedDateParts,(function(t){return null!=t})),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return r;t._isValid=r}return t._isValid}function _(t){var e=f(NaN);return null!=t?d(p(e),t):p(e).userInvalidated=!0,e}i=Array.prototype.some?Array.prototype.some:function(t){var e,i=Object(this),n=i.length>>>0;for(e=0;e<n;e++)if(e in i&&t.call(this,i[e],e,i))return!0;return!1};var g=n.momentProperties=[],y=!1;function v(t,e){var i,n,r;if(l(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),l(e._i)||(t._i=e._i),l(e._f)||(t._f=e._f),l(e._l)||(t._l=e._l),l(e._strict)||(t._strict=e._strict),l(e._tzm)||(t._tzm=e._tzm),l(e._isUTC)||(t._isUTC=e._isUTC),l(e._offset)||(t._offset=e._offset),l(e._pf)||(t._pf=p(e)),l(e._locale)||(t._locale=e._locale),g.length>0)for(i=0;i<g.length;i++)l(r=e[n=g[i]])||(t[n]=r);return t}function b(t){v(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===y&&(y=!0,n.updateOffset(this),y=!1)}function w(t){return t instanceof b||null!=t&&null!=t._isAMomentObject}function x(t){!1===n.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function T(t,e){var i=!0;return d((function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,t),i){var r,o,a,l=[];for(o=0;o<arguments.length;o++){if(r="","object"==typeof arguments[o]){for(a in r+="\n["+o+"] ",arguments[0])s(arguments[0],a)&&(r+=a+": "+arguments[0][a]+", ");r=r.slice(0,-2)}else r=arguments[o];l.push(r)}x(t+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),i=!1}return e.apply(this,arguments)}),e)}var S,E={};function P(t,e){null!=n.deprecationHandler&&n.deprecationHandler(t,e),E[t]||(x(e),E[t]=!0)}function O(t){return"undefined"!=typeof Function&&t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function k(t,e){var i,n=d({},t);for(i in e)s(e,i)&&(o(t[i])&&o(e[i])?(n[i]={},d(n[i],t[i]),d(n[i],e[i])):null!=e[i]?n[i]=e[i]:delete n[i]);for(i in t)s(t,i)&&!s(e,i)&&o(t[i])&&(n[i]=d({},n[i]));return n}function L(t){null!=t&&this.set(t)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,S=Object.keys?Object.keys:function(t){var e,i=[];for(e in t)s(t,e)&&i.push(e);return i};function I(t,e,i){var n=""+Math.abs(t),r=e-n.length;return(t>=0?i?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+n}var C=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,A=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,M={},D={};function N(t,e,i,n){var r=n;"string"==typeof n&&(r=function(){return this[n]()}),t&&(D[t]=r),e&&(D[e[0]]=function(){return I(r.apply(this,arguments),e[1],e[2])}),i&&(D[i]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function z(t,e){return t.isValid()?(e=R(e,t.localeData()),M[e]=M[e]||function(t){var e,i,n,r=t.match(C);for(e=0,i=r.length;e<i;e++)D[r[e]]?r[e]=D[r[e]]:r[e]=(n=r[e]).match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"");return function(e){var n,o="";for(n=0;n<i;n++)o+=O(r[n])?r[n].call(e,t):r[n];return o}}(e),M[e](t)):t.localeData().invalidDate()}function R(t,e){var i=5;function n(t){return e.longDateFormat(t)||t}for(A.lastIndex=0;i>=0&&A.test(t);)t=t.replace(A,n),A.lastIndex=0,i-=1;return t}var F={};function B(t,e){var i=t.toLowerCase();F[i]=F[i+"s"]=F[e]=t}function j(t){return"string"==typeof t?F[t]||F[t.toLowerCase()]:void 0}function U(t){var e,i,n={};for(i in t)s(t,i)&&(e=j(i))&&(n[e]=t[i]);return n}var Z={};function Y(t,e){Z[t]=e}function W(t){return t%4==0&&t%100!=0||t%400==0}function H(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function V(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=H(e)),i}function q(t,e){return function(i){return null!=i?(K(this,t,i),n.updateOffset(this,e),this):G(this,t)}}function G(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function K(t,e,i){t.isValid()&&!isNaN(i)&&("FullYear"===e&&W(t.year())&&1===t.month()&&29===t.date()?(i=V(i),t._d["set"+(t._isUTC?"UTC":"")+e](i,t.month(),wt(i,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](i))}var $,J=/\d/,X=/\d\d/,Q=/\d{3}/,tt=/\d{4}/,et=/[+-]?\d{6}/,it=/\d\d?/,nt=/\d\d\d\d?/,rt=/\d\d\d\d\d\d?/,ot=/\d{1,3}/,st=/\d{1,4}/,at=/[+-]?\d{1,6}/,lt=/\d+/,ut=/[+-]?\d+/,ht=/Z|[+-]\d\d:?\d\d/gi,ct=/Z|[+-]\d\d(?::?\d\d)?/gi,dt=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function ft(t,e,i){$[t]=O(e)?e:function(t,n){return t&&i?i:e}}function pt(t,e){return s($,t)?$[t](e._strict,e._locale):new RegExp(mt(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,i,n,r){return e||i||n||r}))))}function mt(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}$={};var _t={};function gt(t,e){var i,n=e;for("string"==typeof t&&(t=[t]),u(e)&&(n=function(t,i){i[e]=V(t)}),i=0;i<t.length;i++)_t[t[i]]=n}function yt(t,e){gt(t,(function(t,i,n,r){n._w=n._w||{},e(t,n._w,n,r)}))}function vt(t,e,i){null!=e&&s(_t,t)&&_t[t](e,i._a,i,t)}var bt;function wt(t,e){if(isNaN(t)||isNaN(e))return NaN;var i,n=(e%(i=12)+i)%i;return t+=(e-n)/12,1===n?W(t)?29:28:31-n%7%2}bt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},N("M",["MM",2],"Mo",(function(){return this.month()+1})),N("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),N("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),B("month","M"),Y("month",8),ft("M",it),ft("MM",it,X),ft("MMM",(function(t,e){return e.monthsShortRegex(t)})),ft("MMMM",(function(t,e){return e.monthsRegex(t)})),gt(["M","MM"],(function(t,e){e[1]=V(t)-1})),gt(["MMM","MMMM"],(function(t,e,i,n){var r=i._locale.monthsParse(t,n,i._strict);null!=r?e[1]=r:p(i).invalidMonth=t}));var xt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Tt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),St=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Et=dt,Pt=dt;function Ot(t,e,i){var n,r,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=f([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return i?"MMM"===e?-1!==(r=bt.call(this._shortMonthsParse,s))?r:null:-1!==(r=bt.call(this._longMonthsParse,s))?r:null:"MMM"===e?-1!==(r=bt.call(this._shortMonthsParse,s))||-1!==(r=bt.call(this._longMonthsParse,s))?r:null:-1!==(r=bt.call(this._longMonthsParse,s))||-1!==(r=bt.call(this._shortMonthsParse,s))?r:null}function kt(t,e){var i;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=V(e);else if(!u(e=t.localeData().monthsParse(e)))return t;return i=Math.min(t.date(),wt(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t}function Lt(t){return null!=t?(kt(this,t),n.updateOffset(this,!0),this):G(this,"Month")}function It(){function t(t,e){return e.length-t.length}var e,i,n=[],r=[],o=[];for(e=0;e<12;e++)i=f([2e3,e]),n.push(this.monthsShort(i,"")),r.push(this.months(i,"")),o.push(this.months(i,"")),o.push(this.monthsShort(i,""));for(n.sort(t),r.sort(t),o.sort(t),e=0;e<12;e++)n[e]=mt(n[e]),r[e]=mt(r[e]);for(e=0;e<24;e++)o[e]=mt(o[e]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function Ct(t){return W(t)?366:365}N("Y",0,0,(function(){var t=this.year();return t<=9999?I(t,4):"+"+t})),N(0,["YY",2],0,(function(){return this.year()%100})),N(0,["YYYY",4],0,"year"),N(0,["YYYYY",5],0,"year"),N(0,["YYYYYY",6,!0],0,"year"),B("year","y"),Y("year",1),ft("Y",ut),ft("YY",it,X),ft("YYYY",st,tt),ft("YYYYY",at,et),ft("YYYYYY",at,et),gt(["YYYYY","YYYYYY"],0),gt("YYYY",(function(t,e){e[0]=2===t.length?n.parseTwoDigitYear(t):V(t)})),gt("YY",(function(t,e){e[0]=n.parseTwoDigitYear(t)})),gt("Y",(function(t,e){e[0]=parseInt(t,10)})),n.parseTwoDigitYear=function(t){return V(t)+(V(t)>68?1900:2e3)};var At=q("FullYear",!0);function Mt(t,e,i,n,r,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,i,n,r,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,i,n,r,o,s),a}function Dt(t){var e,i;return t<100&&t>=0?((i=Array.prototype.slice.call(arguments))[0]=t+400,e=new Date(Date.UTC.apply(null,i)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Nt(t,e,i){var n=7+e-i;return-((7+Dt(t,0,n).getUTCDay()-e)%7)+n-1}function zt(t,e,i,n,r){var o,s,a=1+7*(e-1)+(7+i-n)%7+Nt(t,n,r);return a<=0?s=Ct(o=t-1)+a:a>Ct(t)?(o=t+1,s=a-Ct(t)):(o=t,s=a),{year:o,dayOfYear:s}}function Rt(t,e,i){var n,r,o=Nt(t.year(),e,i),s=Math.floor((t.dayOfYear()-o-1)/7)+1;return s<1?n=s+Ft(r=t.year()-1,e,i):s>Ft(t.year(),e,i)?(n=s-Ft(t.year(),e,i),r=t.year()+1):(r=t.year(),n=s),{week:n,year:r}}function Ft(t,e,i){var n=Nt(t,e,i),r=Nt(t+1,e,i);return(Ct(t)-n+r)/7}N("w",["ww",2],"wo","week"),N("W",["WW",2],"Wo","isoWeek"),B("week","w"),B("isoWeek","W"),Y("week",5),Y("isoWeek",5),ft("w",it),ft("ww",it,X),ft("W",it),ft("WW",it,X),yt(["w","ww","W","WW"],(function(t,e,i,n){e[n.substr(0,1)]=V(t)}));function Bt(t,e){return t.slice(e,7).concat(t.slice(0,e))}N("d",0,"do","day"),N("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),N("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),N("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),N("e",0,0,"weekday"),N("E",0,0,"isoWeekday"),B("day","d"),B("weekday","e"),B("isoWeekday","E"),Y("day",11),Y("weekday",11),Y("isoWeekday",11),ft("d",it),ft("e",it),ft("E",it),ft("dd",(function(t,e){return e.weekdaysMinRegex(t)})),ft("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),ft("dddd",(function(t,e){return e.weekdaysRegex(t)})),yt(["dd","ddd","dddd"],(function(t,e,i,n){var r=i._locale.weekdaysParse(t,n,i._strict);null!=r?e.d=r:p(i).invalidWeekday=t})),yt(["d","e","E"],(function(t,e,i,n){e[n]=V(t)}));var jt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ut="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Zt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Yt=dt,Wt=dt,Ht=dt;function Vt(t,e,i){var n,r,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=f([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return i?"dddd"===e?-1!==(r=bt.call(this._weekdaysParse,s))?r:null:"ddd"===e?-1!==(r=bt.call(this._shortWeekdaysParse,s))?r:null:-1!==(r=bt.call(this._minWeekdaysParse,s))?r:null:"dddd"===e?-1!==(r=bt.call(this._weekdaysParse,s))||-1!==(r=bt.call(this._shortWeekdaysParse,s))||-1!==(r=bt.call(this._minWeekdaysParse,s))?r:null:"ddd"===e?-1!==(r=bt.call(this._shortWeekdaysParse,s))||-1!==(r=bt.call(this._weekdaysParse,s))||-1!==(r=bt.call(this._minWeekdaysParse,s))?r:null:-1!==(r=bt.call(this._minWeekdaysParse,s))||-1!==(r=bt.call(this._weekdaysParse,s))||-1!==(r=bt.call(this._shortWeekdaysParse,s))?r:null}function qt(){function t(t,e){return e.length-t.length}var e,i,n,r,o,s=[],a=[],l=[],u=[];for(e=0;e<7;e++)i=f([2e3,1]).day(e),n=mt(this.weekdaysMin(i,"")),r=mt(this.weekdaysShort(i,"")),o=mt(this.weekdays(i,"")),s.push(n),a.push(r),l.push(o),u.push(n),u.push(r),u.push(o);s.sort(t),a.sort(t),l.sort(t),u.sort(t),this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Gt(){return this.hours()%12||12}function Kt(t,e){N(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function $t(t,e){return e._meridiemParse}N("H",["HH",2],0,"hour"),N("h",["hh",2],0,Gt),N("k",["kk",2],0,(function(){return this.hours()||24})),N("hmm",0,0,(function(){return""+Gt.apply(this)+I(this.minutes(),2)})),N("hmmss",0,0,(function(){return""+Gt.apply(this)+I(this.minutes(),2)+I(this.seconds(),2)})),N("Hmm",0,0,(function(){return""+this.hours()+I(this.minutes(),2)})),N("Hmmss",0,0,(function(){return""+this.hours()+I(this.minutes(),2)+I(this.seconds(),2)})),Kt("a",!0),Kt("A",!1),B("hour","h"),Y("hour",13),ft("a",$t),ft("A",$t),ft("H",it),ft("h",it),ft("k",it),ft("HH",it,X),ft("hh",it,X),ft("kk",it,X),ft("hmm",nt),ft("hmmss",rt),ft("Hmm",nt),ft("Hmmss",rt),gt(["H","HH"],3),gt(["k","kk"],(function(t,e,i){var n=V(t);e[3]=24===n?0:n})),gt(["a","A"],(function(t,e,i){i._isPm=i._locale.isPM(t),i._meridiem=t})),gt(["h","hh"],(function(t,e,i){e[3]=V(t),p(i).bigHour=!0})),gt("hmm",(function(t,e,i){var n=t.length-2;e[3]=V(t.substr(0,n)),e[4]=V(t.substr(n)),p(i).bigHour=!0})),gt("hmmss",(function(t,e,i){var n=t.length-4,r=t.length-2;e[3]=V(t.substr(0,n)),e[4]=V(t.substr(n,2)),e[5]=V(t.substr(r)),p(i).bigHour=!0})),gt("Hmm",(function(t,e,i){var n=t.length-2;e[3]=V(t.substr(0,n)),e[4]=V(t.substr(n))})),gt("Hmmss",(function(t,e,i){var n=t.length-4,r=t.length-2;e[3]=V(t.substr(0,n)),e[4]=V(t.substr(n,2)),e[5]=V(t.substr(r))}));var Jt=q("Hours",!0);var Xt,Qt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:xt,monthsShort:Tt,week:{dow:0,doy:6},weekdays:jt,weekdaysMin:Zt,weekdaysShort:Ut,meridiemParse:/[ap]\.?m?\.?/i},te={},ee={};function ie(t,e){var i,n=Math.min(t.length,e.length);for(i=0;i<n;i+=1)if(t[i]!==e[i])return i;return n}function ne(t){return t?t.toLowerCase().replace("_","-"):t}function re(e){var i=null;if(void 0===te[e]&&t&&t.exports)try{i=Xt._abbr,(void 0)("./locale/"+e),oe(i)}catch(t){te[e]=null}return te[e]}function oe(t,e){var i;return t&&((i=l(e)?ae(t):se(t,e))?Xt=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Xt._abbr}function se(t,e){if(null!==e){var i,n=Qt;if(e.abbr=t,null!=te[t])P("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=te[t]._config;else if(null!=e.parentLocale)if(null!=te[e.parentLocale])n=te[e.parentLocale]._config;else{if(null==(i=re(e.parentLocale)))return ee[e.parentLocale]||(ee[e.parentLocale]=[]),ee[e.parentLocale].push({name:t,config:e}),null;n=i._config}return te[t]=new L(k(n,e)),ee[t]&&ee[t].forEach((function(t){se(t.name,t.config)})),oe(t),te[t]}return delete te[t],null}function ae(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Xt;if(!r(t)){if(e=re(t))return e;t=[t]}return function(t){for(var e,i,n,r,o=0;o<t.length;){for(e=(r=ne(t[o]).split("-")).length,i=(i=ne(t[o+1]))?i.split("-"):null;e>0;){if(n=re(r.slice(0,e).join("-")))return n;if(i&&i.length>=e&&ie(r,i)>=e-1)break;e--}o++}return Xt}(t)}function le(t){var e,i=t._a;return i&&-2===p(t).overflow&&(e=i[1]<0||i[1]>11?1:i[2]<1||i[2]>wt(i[0],i[1])?2:i[3]<0||i[3]>24||24===i[3]&&(0!==i[4]||0!==i[5]||0!==i[6])?3:i[4]<0||i[4]>59?4:i[5]<0||i[5]>59?5:i[6]<0||i[6]>999?6:-1,p(t)._overflowDayOfYear&&(e<0||e>2)&&(e=2),p(t)._overflowWeeks&&-1===e&&(e=7),p(t)._overflowWeekday&&-1===e&&(e=8),p(t).overflow=e),t}var ue=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,he=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ce=/Z|[+-]\d\d(?::?\d\d)?/,de=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],fe=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pe=/^\/?Date\((-?\d+)/i,me=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,_e={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ge(t){var e,i,n,r,o,s,a=t._i,l=ue.exec(a)||he.exec(a);if(l){for(p(t).iso=!0,e=0,i=de.length;e<i;e++)if(de[e][1].exec(l[1])){r=de[e][0],n=!1!==de[e][2];break}if(null==r)return void(t._isValid=!1);if(l[3]){for(e=0,i=fe.length;e<i;e++)if(fe[e][1].exec(l[3])){o=(l[2]||" ")+fe[e][0];break}if(null==o)return void(t._isValid=!1)}if(!n&&null!=o)return void(t._isValid=!1);if(l[4]){if(!ce.exec(l[4]))return void(t._isValid=!1);s="Z"}t._f=r+(o||"")+(s||""),xe(t)}else t._isValid=!1}function ye(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function ve(t){var e,i,n,r,o,s,a,l,u=me.exec(t._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(u){if(i=u[4],n=u[3],r=u[2],o=u[5],s=u[6],a=u[7],l=[ye(i),Tt.indexOf(n),parseInt(r,10),parseInt(o,10),parseInt(s,10)],a&&l.push(parseInt(a,10)),e=l,!function(t,e,i){return!t||Ut.indexOf(t)===new Date(e[0],e[1],e[2]).getDay()||(p(i).weekdayMismatch=!0,i._isValid=!1,!1)}(u[1],e,t))return;t._a=e,t._tzm=function(t,e,i){if(t)return _e[t];if(e)return 0;var n=parseInt(i,10),r=n%100;return(n-r)/100*60+r}(u[8],u[9],u[10]),t._d=Dt.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),p(t).rfc2822=!0}else t._isValid=!1}function be(t,e,i){return null!=t?t:null!=e?e:i}function we(t){var e,i,r,o,s,a=[];if(!t._d){for(r=function(t){var e=new Date(n.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[2]&&null==t._a[1]&&function(t){var e,i,n,r,o,s,a,l,u;null!=(e=t._w).GG||null!=e.W||null!=e.E?(o=1,s=4,i=be(e.GG,t._a[0],Rt(Ee(),1,4).year),n=be(e.W,1),((r=be(e.E,1))<1||r>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Rt(Ee(),o,s),i=be(e.gg,t._a[0],u.year),n=be(e.w,u.week),null!=e.d?((r=e.d)<0||r>6)&&(l=!0):null!=e.e?(r=e.e+o,(e.e<0||e.e>6)&&(l=!0)):r=o);n<1||n>Ft(i,o,s)?p(t)._overflowWeeks=!0:null!=l?p(t)._overflowWeekday=!0:(a=zt(i,n,r,o,s),t._a[0]=a.year,t._dayOfYear=a.dayOfYear)}(t),null!=t._dayOfYear&&(s=be(t._a[0],r[0]),(t._dayOfYear>Ct(s)||0===t._dayOfYear)&&(p(t)._overflowDayOfYear=!0),i=Dt(s,0,t._dayOfYear),t._a[1]=i.getUTCMonth(),t._a[2]=i.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=a[e]=r[e];for(;e<7;e++)t._a[e]=a[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[3]&&0===t._a[4]&&0===t._a[5]&&0===t._a[6]&&(t._nextDay=!0,t._a[3]=0),t._d=(t._useUTC?Dt:Mt).apply(null,a),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[3]=24),t._w&&void 0!==t._w.d&&t._w.d!==o&&(p(t).weekdayMismatch=!0)}}function xe(t){if(t._f!==n.ISO_8601)if(t._f!==n.RFC_2822){t._a=[],p(t).empty=!0;var e,i,r,o,s,a,l=""+t._i,u=l.length,h=0;for(r=R(t._f,t._locale).match(C)||[],e=0;e<r.length;e++)o=r[e],(i=(l.match(pt(o,t))||[])[0])&&((s=l.substr(0,l.indexOf(i))).length>0&&p(t).unusedInput.push(s),l=l.slice(l.indexOf(i)+i.length),h+=i.length),D[o]?(i?p(t).empty=!1:p(t).unusedTokens.push(o),vt(o,i,t)):t._strict&&!i&&p(t).unusedTokens.push(o);p(t).charsLeftOver=u-h,l.length>0&&p(t).unusedInput.push(l),t._a[3]<=12&&!0===p(t).bigHour&&t._a[3]>0&&(p(t).bigHour=void 0),p(t).parsedDateParts=t._a.slice(0),p(t).meridiem=t._meridiem,t._a[3]=function(t,e,i){var n;if(null==i)return e;return null!=t.meridiemHour?t.meridiemHour(e,i):null!=t.isPM?((n=t.isPM(i))&&e<12&&(e+=12),n||12!==e||(e=0),e):e}(t._locale,t._a[3],t._meridiem),null!==(a=p(t).era)&&(t._a[0]=t._locale.erasConvertYear(a,t._a[0])),we(t),le(t)}else ve(t);else ge(t)}function Te(t){var e=t._i,i=t._f;return t._locale=t._locale||ae(t._l),null===e||void 0===i&&""===e?_({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),w(e)?new b(le(e)):(h(e)?t._d=e:r(i)?function(t){var e,i,n,r,o,s,a=!1;if(0===t._f.length)return p(t).invalidFormat=!0,void(t._d=new Date(NaN));for(r=0;r<t._f.length;r++)o=0,s=!1,e=v({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[r],xe(e),m(e)&&(s=!0),o+=p(e).charsLeftOver,o+=10*p(e).unusedTokens.length,p(e).score=o,a?o<n&&(n=o,i=e):(null==n||o<n||s)&&(n=o,i=e,s&&(a=!0));d(t,i||e)}(t):i?xe(t):function(t){var e=t._i;l(e)?t._d=new Date(n.now()):h(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=pe.exec(t._i);null===e?(ge(t),!1===t._isValid&&(delete t._isValid,ve(t),!1===t._isValid&&(delete t._isValid,t._strict?t._isValid=!1:n.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):r(e)?(t._a=c(e.slice(0),(function(t){return parseInt(t,10)})),we(t)):o(e)?function(t){if(!t._d){var e=U(t._i),i=void 0===e.day?e.date:e.day;t._a=c([e.year,e.month,i,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),we(t)}}(t):u(e)?t._d=new Date(e):n.createFromInputFallback(t)}(t),m(t)||(t._d=null),t))}function Se(t,e,i,n,s){var l,u={};return!0!==e&&!1!==e||(n=e,e=void 0),!0!==i&&!1!==i||(n=i,i=void 0),(o(t)&&a(t)||r(t)&&0===t.length)&&(t=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=s,u._l=i,u._i=t,u._f=e,u._strict=n,(l=new b(le(Te(u))))._nextDay&&(l.add(1,"d"),l._nextDay=void 0),l}function Ee(t,e,i,n){return Se(t,e,i,n,!1)}n.createFromInputFallback=T("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),n.ISO_8601=function(){},n.RFC_2822=function(){};var Pe=T("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Ee.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:_()})),Oe=T("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Ee.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:_()}));function ke(t,e){var i,n;if(1===e.length&&r(e[0])&&(e=e[0]),!e.length)return Ee();for(i=e[0],n=1;n<e.length;++n)e[n].isValid()&&!e[n][t](i)||(i=e[n]);return i}var Le=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ie(t){var e=U(t),i=e.year||0,n=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,a=e.day||0,l=e.hour||0,u=e.minute||0,h=e.second||0,c=e.millisecond||0;this._isValid=function(t){var e,i,n=!1;for(e in t)if(s(t,e)&&(-1===bt.call(Le,e)||null!=t[e]&&isNaN(t[e])))return!1;for(i=0;i<Le.length;++i)if(t[Le[i]]){if(n)return!1;parseFloat(t[Le[i]])!==V(t[Le[i]])&&(n=!0)}return!0}(e),this._milliseconds=+c+1e3*h+6e4*u+36e5*l,this._days=+a+7*o,this._months=+r+3*n+12*i,this._data={},this._locale=ae(),this._bubble()}function Ce(t){return t instanceof Ie}function Ae(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function Me(t,e){N(t,0,0,(function(){var t=this.utcOffset(),i="+";return t<0&&(t=-t,i="-"),i+I(~~(t/60),2)+e+I(~~t%60,2)}))}Me("Z",":"),Me("ZZ",""),ft("Z",ct),ft("ZZ",ct),gt(["Z","ZZ"],(function(t,e,i){i._useUTC=!0,i._tzm=Ne(ct,t)}));var De=/([\+\-]|\d\d)/gi;function Ne(t,e){var i,n,r=(e||"").match(t);return null===r?null:0===(n=60*(i=((r[r.length-1]||[])+"").match(De)||["-",0,0])[1]+V(i[2]))?0:"+"===i[0]?n:-n}function ze(t,e){var i,r;return e._isUTC?(i=e.clone(),r=(w(t)||h(t)?t.valueOf():Ee(t).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+r),n.updateOffset(i,!1),i):Ee(t).local()}function Re(t){return-Math.round(t._d.getTimezoneOffset())}function Fe(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}n.updateOffset=function(){};var Be=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,je=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ue(t,e){var i,n,r,o=t,a=null;return Ce(t)?o={ms:t._milliseconds,d:t._days,M:t._months}:u(t)||!isNaN(+t)?(o={},e?o[e]=+t:o.milliseconds=+t):(a=Be.exec(t))?(i="-"===a[1]?-1:1,o={y:0,d:V(a[2])*i,h:V(a[3])*i,m:V(a[4])*i,s:V(a[5])*i,ms:V(Ae(1e3*a[6]))*i}):(a=je.exec(t))?(i="-"===a[1]?-1:1,o={y:Ze(a[2],i),M:Ze(a[3],i),w:Ze(a[4],i),d:Ze(a[5],i),h:Ze(a[6],i),m:Ze(a[7],i),s:Ze(a[8],i)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(r=function(t,e){var i;if(!t.isValid()||!e.isValid())return{milliseconds:0,months:0};e=ze(e,t),t.isBefore(e)?i=Ye(t,e):((i=Ye(e,t)).milliseconds=-i.milliseconds,i.months=-i.months);return i}(Ee(o.from),Ee(o.to)),(o={}).ms=r.milliseconds,o.M=r.months),n=new Ie(o),Ce(t)&&s(t,"_locale")&&(n._locale=t._locale),Ce(t)&&s(t,"_isValid")&&(n._isValid=t._isValid),n}function Ze(t,e){var i=t&&parseFloat(t.replace(",","."));return(isNaN(i)?0:i)*e}function Ye(t,e){var i={};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function We(t,e){return function(i,n){var r;return null===n||isNaN(+n)||(P(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=i,i=n,n=r),He(this,Ue(i,n),t),this}}function He(t,e,i,r){var o=e._milliseconds,s=Ae(e._days),a=Ae(e._months);t.isValid()&&(r=null==r||r,a&&kt(t,G(t,"Month")+a*i),s&&K(t,"Date",G(t,"Date")+s*i),o&&t._d.setTime(t._d.valueOf()+o*i),r&&n.updateOffset(t,s||a))}Ue.fn=Ie.prototype,Ue.invalid=function(){return Ue(NaN)};var Ve=We(1,"add"),qe=We(-1,"subtract");function Ge(t){return"string"==typeof t||t instanceof String}function Ke(t){return w(t)||h(t)||Ge(t)||u(t)||function(t){var e=r(t),i=!1;e&&(i=0===t.filter((function(e){return!u(e)&&Ge(t)})).length);return e&&i}(t)||function(t){var e,i,n=o(t)&&!a(t),r=!1,l=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"];for(e=0;e<l.length;e+=1)i=l[e],r=r||s(t,i);return n&&r}(t)||null==t}function $e(t){var e,i=o(t)&&!a(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(e=0;e<r.length;e+=1)n=n||s(t,r[e]);return i&&n}function Je(t,e){if(t.date()<e.date())return-Je(e,t);var i=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(i,"months");return-(i+(e-n<0?(e-n)/(n-t.clone().add(i-1,"months")):(e-n)/(t.clone().add(i+1,"months")-n)))||0}function Xe(t){var e;return void 0===t?this._locale._abbr:(null!=(e=ae(t))&&(this._locale=e),this)}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Qe=T("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function ti(){return this._locale}var ei=1e3,ii=6e4,ni=36e5,ri=126227808e5;function oi(t,e){return(t%e+e)%e}function si(t,e,i){return t<100&&t>=0?new Date(t+400,e,i)-ri:new Date(t,e,i).valueOf()}function ai(t,e,i){return t<100&&t>=0?Date.UTC(t+400,e,i)-ri:Date.UTC(t,e,i)}function li(t,e){return e.erasAbbrRegex(t)}function ui(){var t,e,i=[],n=[],r=[],o=[],s=this.eras();for(t=0,e=s.length;t<e;++t)n.push(mt(s[t].name)),i.push(mt(s[t].abbr)),r.push(mt(s[t].narrow)),o.push(mt(s[t].name)),o.push(mt(s[t].abbr)),o.push(mt(s[t].narrow));this._erasRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+n.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}function hi(t,e){N(0,[t,t.length],0,e)}function ci(t,e,i,n,r){var o;return null==t?Rt(this,n,r).year:(e>(o=Ft(t,n,r))&&(e=o),di.call(this,t,e,i,n,r))}function di(t,e,i,n,r){var o=zt(t,e,i,n,r),s=Dt(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}N("N",0,0,"eraAbbr"),N("NN",0,0,"eraAbbr"),N("NNN",0,0,"eraAbbr"),N("NNNN",0,0,"eraName"),N("NNNNN",0,0,"eraNarrow"),N("y",["y",1],"yo","eraYear"),N("y",["yy",2],0,"eraYear"),N("y",["yyy",3],0,"eraYear"),N("y",["yyyy",4],0,"eraYear"),ft("N",li),ft("NN",li),ft("NNN",li),ft("NNNN",(function(t,e){return e.erasNameRegex(t)})),ft("NNNNN",(function(t,e){return e.erasNarrowRegex(t)})),gt(["N","NN","NNN","NNNN","NNNNN"],(function(t,e,i,n){var r=i._locale.erasParse(t,n,i._strict);r?p(i).era=r:p(i).invalidEra=t})),ft("y",lt),ft("yy",lt),ft("yyy",lt),ft("yyyy",lt),ft("yo",(function(t,e){return e._eraYearOrdinalRegex||lt})),gt(["y","yy","yyy","yyyy"],0),gt(["yo"],(function(t,e,i,n){var r;i._locale._eraYearOrdinalRegex&&(r=t.match(i._locale._eraYearOrdinalRegex)),i._locale.eraYearOrdinalParse?e[0]=i._locale.eraYearOrdinalParse(t,r):e[0]=parseInt(t,10)})),N(0,["gg",2],0,(function(){return this.weekYear()%100})),N(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),hi("gggg","weekYear"),hi("ggggg","weekYear"),hi("GGGG","isoWeekYear"),hi("GGGGG","isoWeekYear"),B("weekYear","gg"),B("isoWeekYear","GG"),Y("weekYear",1),Y("isoWeekYear",1),ft("G",ut),ft("g",ut),ft("GG",it,X),ft("gg",it,X),ft("GGGG",st,tt),ft("gggg",st,tt),ft("GGGGG",at,et),ft("ggggg",at,et),yt(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,i,n){e[n.substr(0,2)]=V(t)})),yt(["gg","GG"],(function(t,e,i,r){e[r]=n.parseTwoDigitYear(t)})),N("Q",0,"Qo","quarter"),B("quarter","Q"),Y("quarter",7),ft("Q",J),gt("Q",(function(t,e){e[1]=3*(V(t)-1)})),N("D",["DD",2],"Do","date"),B("date","D"),Y("date",9),ft("D",it),ft("DD",it,X),ft("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),gt(["D","DD"],2),gt("Do",(function(t,e){e[2]=V(t.match(it)[0])}));var fi=q("Date",!0);N("DDD",["DDDD",3],"DDDo","dayOfYear"),B("dayOfYear","DDD"),Y("dayOfYear",4),ft("DDD",ot),ft("DDDD",Q),gt(["DDD","DDDD"],(function(t,e,i){i._dayOfYear=V(t)})),N("m",["mm",2],0,"minute"),B("minute","m"),Y("minute",14),ft("m",it),ft("mm",it,X),gt(["m","mm"],4);var pi=q("Minutes",!1);N("s",["ss",2],0,"second"),B("second","s"),Y("second",15),ft("s",it),ft("ss",it,X),gt(["s","ss"],5);var mi,_i,gi=q("Seconds",!1);for(N("S",0,0,(function(){return~~(this.millisecond()/100)})),N(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),N(0,["SSS",3],0,"millisecond"),N(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),N(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),N(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),N(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),N(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),N(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),B("millisecond","ms"),Y("millisecond",16),ft("S",ot,J),ft("SS",ot,X),ft("SSS",ot,Q),mi="SSSS";mi.length<=9;mi+="S")ft(mi,lt);function yi(t,e){e[6]=V(1e3*("0."+t))}for(mi="S";mi.length<=9;mi+="S")gt(mi,yi);_i=q("Milliseconds",!1),N("z",0,0,"zoneAbbr"),N("zz",0,0,"zoneName");var vi=b.prototype;function bi(t){return t}vi.add=Ve,vi.calendar=function(t,e){1===arguments.length&&(arguments[0]?Ke(arguments[0])?(t=arguments[0],e=void 0):$e(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var i=t||Ee(),r=ze(i,this).startOf("day"),o=n.calendarFormat(this,r)||"sameElse",s=e&&(O(e[o])?e[o].call(this,i):e[o]);return this.format(s||this.localeData().calendar(o,this,Ee(i)))},vi.clone=function(){return new b(this)},vi.diff=function(t,e,i){var n,r,o;if(!this.isValid())return NaN;if(!(n=ze(t,this)).isValid())return NaN;switch(r=6e4*(n.utcOffset()-this.utcOffset()),e=j(e)){case"year":o=Je(this,n)/12;break;case"month":o=Je(this,n);break;case"quarter":o=Je(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-r)/864e5;break;case"week":o=(this-n-r)/6048e5;break;default:o=this-n}return i?o:H(o)},vi.endOf=function(t){var e,i;if(void 0===(t=j(t))||"millisecond"===t||!this.isValid())return this;switch(i=this._isUTC?ai:si,t){case"year":e=i(this.year()+1,0,1)-1;break;case"quarter":e=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=i(this.year(),this.month()+1,1)-1;break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=ni-oi(e+(this._isUTC?0:this.utcOffset()*ii),ni)-1;break;case"minute":e=this._d.valueOf(),e+=ii-oi(e,ii)-1;break;case"second":e=this._d.valueOf(),e+=ei-oi(e,ei)-1}return this._d.setTime(e),n.updateOffset(this,!0),this},vi.format=function(t){t||(t=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var e=z(this,t);return this.localeData().postformat(e)},vi.from=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||Ee(t).isValid())?Ue({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},vi.fromNow=function(t){return this.from(Ee(),t)},vi.to=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||Ee(t).isValid())?Ue({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},vi.toNow=function(t){return this.to(Ee(),t)},vi.get=function(t){return O(this[t=j(t)])?this[t]():this},vi.invalidAt=function(){return p(this).overflow},vi.isAfter=function(t,e){var i=w(t)?t:Ee(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=j(e)||"millisecond")?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(e).valueOf())},vi.isBefore=function(t,e){var i=w(t)?t:Ee(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=j(e)||"millisecond")?this.valueOf()<i.valueOf():this.clone().endOf(e).valueOf()<i.valueOf())},vi.isBetween=function(t,e,i,n){var r=w(t)?t:Ee(t),o=w(e)?e:Ee(e);return!!(this.isValid()&&r.isValid()&&o.isValid())&&(("("===(n=n||"()")[0]?this.isAfter(r,i):!this.isBefore(r,i))&&(")"===n[1]?this.isBefore(o,i):!this.isAfter(o,i)))},vi.isSame=function(t,e){var i,n=w(t)?t:Ee(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=j(e)||"millisecond")?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf()))},vi.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},vi.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},vi.isValid=function(){return m(this)},vi.lang=Qe,vi.locale=Xe,vi.localeData=ti,vi.max=Oe,vi.min=Pe,vi.parsingFlags=function(){return d({},p(this))},vi.set=function(t,e){if("object"==typeof t){var i,n=function(t){var e,i=[];for(e in t)s(t,e)&&i.push({unit:e,priority:Z[e]});return i.sort((function(t,e){return t.priority-e.priority})),i}(t=U(t));for(i=0;i<n.length;i++)this[n[i].unit](t[n[i].unit])}else if(O(this[t=j(t)]))return this[t](e);return this},vi.startOf=function(t){var e,i;if(void 0===(t=j(t))||"millisecond"===t||!this.isValid())return this;switch(i=this._isUTC?ai:si,t){case"year":e=i(this.year(),0,1);break;case"quarter":e=i(this.year(),this.month()-this.month()%3,1);break;case"month":e=i(this.year(),this.month(),1);break;case"week":e=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=i(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=oi(e+(this._isUTC?0:this.utcOffset()*ii),ni);break;case"minute":e=this._d.valueOf(),e-=oi(e,ii);break;case"second":e=this._d.valueOf(),e-=oi(e,ei)}return this._d.setTime(e),n.updateOffset(this,!0),this},vi.subtract=qe,vi.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},vi.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},vi.toDate=function(){return new Date(this.valueOf())},vi.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,i=e?this.clone().utc():this;return i.year()<0||i.year()>9999?z(i,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):O(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+6e4*this.utcOffset()).toISOString().replace("Z",z(i,"Z")):z(i,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},vi.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t,e,i,n="moment",r="";return this.isLocal()||(n=0===this.utcOffset()?"moment.utc":"moment.parseZone",r="Z"),t="["+n+'("]',e=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY","-MM-DD[T]HH:mm:ss.SSS",i=r+'[")]',this.format(t+e+"-MM-DD[T]HH:mm:ss.SSS"+i)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(vi[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),vi.toJSON=function(){return this.isValid()?this.toISOString():null},vi.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},vi.unix=function(){return Math.floor(this.valueOf()/1e3)},vi.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},vi.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},vi.eraName=function(){var t,e,i,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t){if(i=this.clone().startOf("day").valueOf(),n[t].since<=i&&i<=n[t].until)return n[t].name;if(n[t].until<=i&&i<=n[t].since)return n[t].name}return""},vi.eraNarrow=function(){var t,e,i,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t){if(i=this.clone().startOf("day").valueOf(),n[t].since<=i&&i<=n[t].until)return n[t].narrow;if(n[t].until<=i&&i<=n[t].since)return n[t].narrow}return""},vi.eraAbbr=function(){var t,e,i,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t){if(i=this.clone().startOf("day").valueOf(),n[t].since<=i&&i<=n[t].until)return n[t].abbr;if(n[t].until<=i&&i<=n[t].since)return n[t].abbr}return""},vi.eraYear=function(){var t,e,i,r,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t)if(i=o[t].since<=o[t].until?1:-1,r=this.clone().startOf("day").valueOf(),o[t].since<=r&&r<=o[t].until||o[t].until<=r&&r<=o[t].since)return(this.year()-n(o[t].since).year())*i+o[t].offset;return this.year()},vi.year=At,vi.isLeapYear=function(){return W(this.year())},vi.weekYear=function(t){return ci.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},vi.isoWeekYear=function(t){return ci.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},vi.quarter=vi.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},vi.month=Lt,vi.daysInMonth=function(){return wt(this.year(),this.month())},vi.week=vi.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},vi.isoWeek=vi.isoWeeks=function(t){var e=Rt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},vi.weeksInYear=function(){var t=this.localeData()._week;return Ft(this.year(),t.dow,t.doy)},vi.weeksInWeekYear=function(){var t=this.localeData()._week;return Ft(this.weekYear(),t.dow,t.doy)},vi.isoWeeksInYear=function(){return Ft(this.year(),1,4)},vi.isoWeeksInISOWeekYear=function(){return Ft(this.isoWeekYear(),1,4)},vi.date=fi,vi.day=vi.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},vi.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},vi.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},vi.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},vi.hour=vi.hours=Jt,vi.minute=vi.minutes=pi,vi.second=vi.seconds=gi,vi.millisecond=vi.milliseconds=_i,vi.utcOffset=function(t,e,i){var r,o=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=Ne(ct,t)))return this}else Math.abs(t)<16&&!i&&(t*=60);return!this._isUTC&&e&&(r=Re(this)),this._offset=t,this._isUTC=!0,null!=r&&this.add(r,"m"),o!==t&&(!e||this._changeInProgress?He(this,Ue(t-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:Re(this)},vi.utc=function(t){return this.utcOffset(0,t)},vi.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Re(this),"m")),this},vi.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=Ne(ht,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},vi.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?Ee(t).utcOffset():0,(this.utcOffset()-t)%60==0)},vi.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},vi.isLocal=function(){return!!this.isValid()&&!this._isUTC},vi.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},vi.isUtc=Fe,vi.isUTC=Fe,vi.zoneAbbr=function(){return this._isUTC?"UTC":""},vi.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},vi.dates=T("dates accessor is deprecated. Use date instead.",fi),vi.months=T("months accessor is deprecated. Use month instead",Lt),vi.years=T("years accessor is deprecated. Use year instead",At),vi.zone=T("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()})),vi.isDSTShifted=T("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var t,e={};return v(e,this),(e=Te(e))._a?(t=e._isUTC?f(e._a):Ee(e._a),this._isDSTShifted=this.isValid()&&function(t,e,i){var n,r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),s=0;for(n=0;n<r;n++)(i&&t[n]!==e[n]||!i&&V(t[n])!==V(e[n]))&&s++;return s+o}(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var wi=L.prototype;function xi(t,e,i,n){var r=ae(),o=f().set(n,e);return r[i](o,t)}function Ti(t,e,i){if(u(t)&&(e=t,t=void 0),t=t||"",null!=e)return xi(t,e,i,"month");var n,r=[];for(n=0;n<12;n++)r[n]=xi(t,n,i,"month");return r}function Si(t,e,i,n){"boolean"==typeof t?(u(e)&&(i=e,e=void 0),e=e||""):(i=e=t,t=!1,u(e)&&(i=e,e=void 0),e=e||"");var r,o=ae(),s=t?o._week.dow:0,a=[];if(null!=i)return xi(e,(i+s)%7,n,"day");for(r=0;r<7;r++)a[r]=xi(e,(r+s)%7,n,"day");return a}wi.calendar=function(t,e,i){var n=this._calendar[t]||this._calendar.sameElse;return O(n)?n.call(e,i):n},wi.longDateFormat=function(t){var e=this._longDateFormat[t],i=this._longDateFormat[t.toUpperCase()];return e||!i?e:(this._longDateFormat[t]=i.match(C).map((function(t){return"MMMM"===t||"MM"===t||"DD"===t||"dddd"===t?t.slice(1):t})).join(""),this._longDateFormat[t])},wi.invalidDate=function(){return this._invalidDate},wi.ordinal=function(t){return this._ordinal.replace("%d",t)},wi.preparse=bi,wi.postformat=bi,wi.relativeTime=function(t,e,i,n){var r=this._relativeTime[i];return O(r)?r(t,e,i,n):r.replace(/%d/i,t)},wi.pastFuture=function(t,e){var i=this._relativeTime[t>0?"future":"past"];return O(i)?i(e):i.replace(/%s/i,e)},wi.set=function(t){var e,i;for(i in t)s(t,i)&&(O(e=t[i])?this[i]=e:this["_"+i]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},wi.eras=function(t,e){var i,r,o,s=this._eras||ae("en")._eras;for(i=0,r=s.length;i<r;++i){if("string"==typeof s[i].since)o=n(s[i].since).startOf("day"),s[i].since=o.valueOf();switch(typeof s[i].until){case"undefined":s[i].until=1/0;break;case"string":o=n(s[i].until).startOf("day").valueOf(),s[i].until=o.valueOf()}}return s},wi.erasParse=function(t,e,i){var n,r,o,s,a,l=this.eras();for(t=t.toUpperCase(),n=0,r=l.length;n<r;++n)if(o=l[n].name.toUpperCase(),s=l[n].abbr.toUpperCase(),a=l[n].narrow.toUpperCase(),i)switch(e){case"N":case"NN":case"NNN":if(s===t)return l[n];break;case"NNNN":if(o===t)return l[n];break;case"NNNNN":if(a===t)return l[n]}else if([o,s,a].indexOf(t)>=0)return l[n]},wi.erasConvertYear=function(t,e){var i=t.since<=t.until?1:-1;return void 0===e?n(t.since).year():n(t.since).year()+(e-t.offset)*i},wi.erasAbbrRegex=function(t){return s(this,"_erasAbbrRegex")||ui.call(this),t?this._erasAbbrRegex:this._erasRegex},wi.erasNameRegex=function(t){return s(this,"_erasNameRegex")||ui.call(this),t?this._erasNameRegex:this._erasRegex},wi.erasNarrowRegex=function(t){return s(this,"_erasNarrowRegex")||ui.call(this),t?this._erasNarrowRegex:this._erasRegex},wi.months=function(t,e){return t?r(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||St).test(e)?"format":"standalone"][t.month()]:r(this._months)?this._months:this._months.standalone},wi.monthsShort=function(t,e){return t?r(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[St.test(e)?"format":"standalone"][t.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},wi.monthsParse=function(t,e,i){var n,r,o;if(this._monthsParseExact)return Ot.call(this,t,e,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(r=f([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[n].test(t))return n;if(i&&"MMM"===e&&this._shortMonthsParse[n].test(t))return n;if(!i&&this._monthsParse[n].test(t))return n}},wi.monthsRegex=function(t){return this._monthsParseExact?(s(this,"_monthsRegex")||It.call(this),t?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=Pt),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},wi.monthsShortRegex=function(t){return this._monthsParseExact?(s(this,"_monthsRegex")||It.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=Et),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},wi.week=function(t){return Rt(t,this._week.dow,this._week.doy).week},wi.firstDayOfYear=function(){return this._week.doy},wi.firstDayOfWeek=function(){return this._week.dow},wi.weekdays=function(t,e){var i=r(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?Bt(i,this._week.dow):t?i[t.day()]:i},wi.weekdaysMin=function(t){return!0===t?Bt(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},wi.weekdaysShort=function(t){return!0===t?Bt(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},wi.weekdaysParse=function(t,e,i){var n,r,o;if(this._weekdaysParseExact)return Vt.call(this,t,e,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(r=f([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),i&&"dddd"===e&&this._fullWeekdaysParse[n].test(t))return n;if(i&&"ddd"===e&&this._shortWeekdaysParse[n].test(t))return n;if(i&&"dd"===e&&this._minWeekdaysParse[n].test(t))return n;if(!i&&this._weekdaysParse[n].test(t))return n}},wi.weekdaysRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||qt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=Yt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},wi.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||qt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Wt),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},wi.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||qt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ht),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},wi.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},wi.meridiem=function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},oe("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===V(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),n.lang=T("moment.lang is deprecated. Use moment.locale instead.",oe),n.langData=T("moment.langData is deprecated. Use moment.localeData instead.",ae);var Ei=Math.abs;function Pi(t,e,i,n){var r=Ue(e,i);return t._milliseconds+=n*r._milliseconds,t._days+=n*r._days,t._months+=n*r._months,t._bubble()}function Oi(t){return t<0?Math.floor(t):Math.ceil(t)}function ki(t){return 4800*t/146097}function Li(t){return 146097*t/4800}function Ii(t){return function(){return this.as(t)}}var Ci=Ii("ms"),Ai=Ii("s"),Mi=Ii("m"),Di=Ii("h"),Ni=Ii("d"),zi=Ii("w"),Ri=Ii("M"),Fi=Ii("Q"),Bi=Ii("y");function ji(t){return function(){return this.isValid()?this._data[t]:NaN}}var Ui=ji("milliseconds"),Zi=ji("seconds"),Yi=ji("minutes"),Wi=ji("hours"),Hi=ji("days"),Vi=ji("months"),qi=ji("years");var Gi=Math.round,Ki={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function $i(t,e,i,n,r){return r.relativeTime(e||1,!!i,t,n)}var Ji=Math.abs;function Xi(t){return(t>0)-(t<0)||+t}function Qi(){if(!this.isValid())return this.localeData().invalidDate();var t,e,i,n,r,o,s,a,l=Ji(this._milliseconds)/1e3,u=Ji(this._days),h=Ji(this._months),c=this.asSeconds();return c?(t=H(l/60),e=H(t/60),l%=60,t%=60,i=H(h/12),h%=12,n=l?l.toFixed(3).replace(/\.?0+$/,""):"",r=c<0?"-":"",o=Xi(this._months)!==Xi(c)?"-":"",s=Xi(this._days)!==Xi(c)?"-":"",a=Xi(this._milliseconds)!==Xi(c)?"-":"",r+"P"+(i?o+i+"Y":"")+(h?o+h+"M":"")+(u?s+u+"D":"")+(e||t||l?"T":"")+(e?a+e+"H":"")+(t?a+t+"M":"")+(l?a+n+"S":"")):"P0D"}var tn=Ie.prototype;return tn.isValid=function(){return this._isValid},tn.abs=function(){var t=this._data;return this._milliseconds=Ei(this._milliseconds),this._days=Ei(this._days),this._months=Ei(this._months),t.milliseconds=Ei(t.milliseconds),t.seconds=Ei(t.seconds),t.minutes=Ei(t.minutes),t.hours=Ei(t.hours),t.months=Ei(t.months),t.years=Ei(t.years),this},tn.add=function(t,e){return Pi(this,t,e,1)},tn.subtract=function(t,e){return Pi(this,t,e,-1)},tn.as=function(t){if(!this.isValid())return NaN;var e,i,n=this._milliseconds;if("month"===(t=j(t))||"quarter"===t||"year"===t)switch(e=this._days+n/864e5,i=this._months+ki(e),t){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(e=this._days+Math.round(Li(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return 24*e+n/36e5;case"minute":return 1440*e+n/6e4;case"second":return 86400*e+n/1e3;case"millisecond":return Math.floor(864e5*e)+n;default:throw new Error("Unknown unit "+t)}},tn.asMilliseconds=Ci,tn.asSeconds=Ai,tn.asMinutes=Mi,tn.asHours=Di,tn.asDays=Ni,tn.asWeeks=zi,tn.asMonths=Ri,tn.asQuarters=Fi,tn.asYears=Bi,tn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*V(this._months/12):NaN},tn._bubble=function(){var t,e,i,n,r,o=this._milliseconds,s=this._days,a=this._months,l=this._data;return o>=0&&s>=0&&a>=0||o<=0&&s<=0&&a<=0||(o+=864e5*Oi(Li(a)+s),s=0,a=0),l.milliseconds=o%1e3,t=H(o/1e3),l.seconds=t%60,e=H(t/60),l.minutes=e%60,i=H(e/60),l.hours=i%24,s+=H(i/24),a+=r=H(ki(s)),s-=Oi(Li(r)),n=H(a/12),a%=12,l.days=s,l.months=a,l.years=n,this},tn.clone=function(){return Ue(this)},tn.get=function(t){return t=j(t),this.isValid()?this[t+"s"]():NaN},tn.milliseconds=Ui,tn.seconds=Zi,tn.minutes=Yi,tn.hours=Wi,tn.days=Hi,tn.weeks=function(){return H(this.days()/7)},tn.months=Vi,tn.years=qi,tn.humanize=function(t,e){if(!this.isValid())return this.localeData().invalidDate();var i,n,r=!1,o=Ki;return"object"==typeof t&&(e=t,t=!1),"boolean"==typeof t&&(r=t),"object"==typeof e&&(o=Object.assign({},Ki,e),null!=e.s&&null==e.ss&&(o.ss=e.s-1)),n=function(t,e,i,n){var r=Ue(t).abs(),o=Gi(r.as("s")),s=Gi(r.as("m")),a=Gi(r.as("h")),l=Gi(r.as("d")),u=Gi(r.as("M")),h=Gi(r.as("w")),c=Gi(r.as("y")),d=o<=i.ss&&["s",o]||o<i.s&&["ss",o]||s<=1&&["m"]||s<i.m&&["mm",s]||a<=1&&["h"]||a<i.h&&["hh",a]||l<=1&&["d"]||l<i.d&&["dd",l];return null!=i.w&&(d=d||h<=1&&["w"]||h<i.w&&["ww",h]),(d=d||u<=1&&["M"]||u<i.M&&["MM",u]||c<=1&&["y"]||["yy",c])[2]=e,d[3]=+t>0,d[4]=n,$i.apply(null,d)}(this,!r,o,i=this.localeData()),r&&(n=i.pastFuture(+this,n)),i.postformat(n)},tn.toISOString=Qi,tn.toString=Qi,tn.toJSON=Qi,tn.locale=Xe,tn.localeData=ti,tn.toIsoString=T("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Qi),tn.lang=Qe,N("X",0,0,"unix"),N("x",0,0,"valueOf"),ft("x",ut),ft("X",/[+-]?\d+(\.\d{1,3})?/),gt("X",(function(t,e,i){i._d=new Date(1e3*parseFloat(t))})),gt("x",(function(t,e,i){i._d=new Date(V(t))})),
//! moment.js
n.version="2.29.1",e=Ee,n.fn=vi,n.min=function(){var t=[].slice.call(arguments,0);return ke("isBefore",t)},n.max=function(){var t=[].slice.call(arguments,0);return ke("isAfter",t)},n.now=function(){return Date.now?Date.now():+new Date},n.utc=f,n.unix=function(t){return Ee(1e3*t)},n.months=function(t,e){return Ti(t,e,"months")},n.isDate=h,n.locale=oe,n.invalid=_,n.duration=Ue,n.isMoment=w,n.weekdays=function(t,e,i){return Si(t,e,i,"weekdays")},n.parseZone=function(){return Ee.apply(null,arguments).parseZone()},n.localeData=ae,n.isDuration=Ce,n.monthsShort=function(t,e){return Ti(t,e,"monthsShort")},n.weekdaysMin=function(t,e,i){return Si(t,e,i,"weekdaysMin")},n.defineLocale=se,n.updateLocale=function(t,e){if(null!=e){var i,n,r=Qt;null!=te[t]&&null!=te[t].parentLocale?te[t].set(k(te[t]._config,e)):(null!=(n=re(t))&&(r=n._config),e=k(r,e),null==n&&(e.abbr=t),(i=new L(e)).parentLocale=te[t],te[t]=i),oe(t)}else null!=te[t]&&(null!=te[t].parentLocale?(te[t]=te[t].parentLocale,t===oe()&&oe(t)):null!=te[t]&&delete te[t]);return te[t]},n.locales=function(){return S(te)},n.weekdaysShort=function(t,e,i){return Si(t,e,i,"weekdaysShort")},n.normalizeUnits=j,n.relativeTimeRounding=function(t){return void 0===t?Gi:"function"==typeof t&&(Gi=t,!0)},n.relativeTimeThreshold=function(t,e){return void 0!==Ki[t]&&(void 0===e?Ki[t]:(Ki[t]=e,"s"===t&&(Ki.ss=e-1),!0))},n.calendarFormat=function(t,e){var i=t.diff(e,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"},n.prototype=vi,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}))})),r.register("ioRHp",(function(t,e){t.exports=n;var i=r("7etJZ").EventEmitter;function n(){i.call(this)}r("dlqwk")(n,i),n.Readable=r("d4xg3"),n.Writable=r("3LwY7"),n.Duplex=r("DwJuQ"),n.Transform=r("b7kl8"),n.PassThrough=r("4wWcs"),n.finished=r("fiCvv"),n.pipeline=r("aGSwO"),n.Stream=n,n.prototype.pipe=function(t,e){var n=this;function r(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",r),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",a),n.on("close",l));var s=!1;function a(){s||(s=!0,t.end())}function l(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(h(),0===i.listenerCount(this,"error"))throw t}function h(){n.removeListener("data",r),t.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",l),n.removeListener("error",u),t.removeListener("error",u),n.removeListener("end",h),n.removeListener("close",h),t.removeListener("close",h)}return n.on("error",u),t.on("error",u),n.on("end",h),n.on("close",h),t.on("close",h),t.emit("pipe",n),t}})),r.register("7etJZ",(function(t,e){var i,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};i=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(i,n){function r(i){t.removeListener(e,o),n(i)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",r),i([].slice.call(arguments))}_(t,e,o,{once:!0}),"error"!==e&&function(t,e,i){"function"==typeof t.on&&_(t,"error",e,i)}(t,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function l(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,i,n){var r,o,s,a;if(l(i),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),o=t._events),s=o[e]),void 0===s)s=o[e]=i,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),(r=u(t))>0&&s.length>r&&!s.warned){s.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=s.length,a=h,console&&console.warn&&console.warn(a)}return t}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},r=c.bind(n);return r.listener=i,n.wrapFn=r,r}function f(t,e,i){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(r):m(r,r.length)}function p(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function m(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}function _(t,e,i,n){if("function"==typeof t.on)n.once?t.once(e,i):t.on(e,i);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(o){n.once&&t.removeEventListener(e,r),i(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n="error"===t,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[t];if(void 0===l)return!1;if("function"==typeof l)r(l,this,e);else{var u=l.length,h=m(l,u);for(i=0;i<u;++i)r(h[i],this,e)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){return l(e),this.on(t,d(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return l(e),this.prependListener(t,d(this,t,e)),this},s.prototype.removeListener=function(t,e){var i,n,r,o,s;if(l(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(r=-1,o=i.length-1;o>=0;o--)if(i[o]===e||i[o].listener===e){s=i[o].listener,r=o;break}if(r<0)return this;0===r?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,r),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var r,o=Object.keys(i);for(n=0;n<o.length;++n)"removeListener"!==(r=o[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},s.prototype.listeners=function(t){return f(this,t,!0)},s.prototype.rawListeners=function(t){return f(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}})),r.register("dlqwk",(function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}}})),r.register("d4xg3",(function(e,i){var n;e.exports=O,O.ReadableState=P;r("7etJZ").EventEmitter;var o=function(t,e){return t.listeners(e).length},s=r("jfAlf"),l=b,u=t.Uint8Array||function(){};var h,c=r("kjyEk");h=c&&c.debuglog?c.debuglog("stream"):function(){};var d,f,p,m=r("bF5dL"),_=r("fMCbt"),g=r("04a3B").getHighWaterMark,y=r("6JySE").codes,v=y.ERR_INVALID_ARG_TYPE,w=y.ERR_STREAM_PUSH_AFTER_EOF,x=y.ERR_METHOD_NOT_IMPLEMENTED,T=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("dlqwk")(O,s);var S=_.errorOrDestroy,E=["error","close","destroy","pause","resume"];function P(t,e,i){n=n||r("DwJuQ"),t=t||{},"boolean"!=typeof i&&(i=e instanceof n),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",i),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=r("eNRCS").StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function O(t){if(n=n||r("DwJuQ"),!(this instanceof O))return new O(t);var e=this instanceof n;this._readableState=new P(t,this,e),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function k(t,e,i,n,r){h("readableAddChunk",e);var o,s=t._readableState;if(null===e)s.reading=!1,function(t,e){if(h("onEofChunk"),e.ended)return;if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,e.sync?A(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,M(t)))}(t,s);else if(r||(o=function(t,e){var i;n=e,l.isBuffer(n)||n instanceof u||"string"==typeof e||void 0===e||t.objectMode||(i=new v("chunk",["string","Buffer","Uint8Array"],e));var n;return i}(s,e)),o)S(t,o);else if(s.objectMode||e&&e.length>0)if("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===l.prototype||(e=function(t){return l.from(t)}(e)),n)s.endEmitted?S(t,new T):L(t,s,e,!0);else if(s.ended)S(t,new w);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!i?(e=s.decoder.write(e),s.objectMode||0!==e.length?L(t,s,e,!1):D(t,s)):L(t,s,e,!1)}else n||(s.reading=!1,D(t,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function L(t,e,i,n){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",i)):(e.length+=e.objectMode?1:i.length,n?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&A(t)),D(t,e)}Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),O.prototype.destroy=_.destroy,O.prototype._undestroy=_.undestroy,O.prototype._destroy=function(t,e){e(t)},O.prototype.push=function(t,e){var i,n=this._readableState;return n.objectMode?i=!0:"string"==typeof t&&((e=e||n.defaultEncoding)!==n.encoding&&(t=l.from(t,e),e=""),i=!0),k(this,t,e,!1,i)},O.prototype.unshift=function(t){return k(this,t,null,!0,!1)},O.prototype.isPaused=function(){return!1===this._readableState.flowing},O.prototype.setEncoding=function(t){d||(d=r("eNRCS").StringDecoder);var e=new d(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,n="";null!==i;)n+=e.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var I=1073741824;function C(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=I?t=I:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function A(t){var e=t._readableState;h("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(h("emitReadable",e.flowing),e.emittedReadable=!0,a.nextTick(M,t))}function M(t){var e=t._readableState;h("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,B(t)}function D(t,e){e.readingMore||(e.readingMore=!0,a.nextTick(N,t,e))}function N(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var i=e.length;if(h("maybeReadMore read 0"),t.read(0),i===e.length)break}e.readingMore=!1}function z(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function R(t){h("readable nexttick read 0"),t.read(0)}function F(t,e){h("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),B(t),e.flowing&&!e.reading&&t.read(0)}function B(t){var e=t._readableState;for(h("flow",e.flowing);e.flowing&&null!==t.read(););}function j(t,e){return 0===e.length?null:(e.objectMode?i=e.buffer.shift():!t||t>=e.length?(i=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):i=e.buffer.consume(t,e.decoder),i);var i}function U(t){var e=t._readableState;h("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,a.nextTick(Z,e,t))}function Z(t,e){if(h("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var i=e._writableState;(!i||i.autoDestroy&&i.finished)&&e.destroy()}}function Y(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}O.prototype.read=function(t){h("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return h("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?U(this):A(this),null;if(0===(t=C(t,e))&&e.ended)return 0===e.length&&U(this),null;var n,r=e.needReadable;return h("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&h("length less than watermark",r=!0),e.ended||e.reading?h("reading or ended",r=!1):r&&(h("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=C(i,e))),null===(n=t>0?j(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&U(this)),null!==n&&this.emit("data",n),n},O.prototype._read=function(t){S(this,new x("_read()"))},O.prototype.pipe=function(t,e){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t)}n.pipesCount+=1,h("pipe count=%d opts=%j",n.pipesCount,e);var r=(!e||!1!==e.end)&&t!==a.stdout&&t!==a.stderr?l:_;function s(e,r){h("onunpipe"),e===i&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,h("cleanup"),t.removeListener("close",p),t.removeListener("finish",m),t.removeListener("drain",u),t.removeListener("error",f),t.removeListener("unpipe",s),i.removeListener("end",l),i.removeListener("end",_),i.removeListener("data",d),c=!0,!n.awaitDrain||t._writableState&&!t._writableState.needDrain||u())}function l(){h("onend"),t.end()}n.endEmitted?a.nextTick(r):i.once("end",r),t.on("unpipe",s);var u=function(t){return function(){var e=t._readableState;h("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,B(t))}}(i);t.on("drain",u);var c=!1;function d(e){h("ondata");var r=t.write(e);h("dest.write",r),!1===r&&((1===n.pipesCount&&n.pipes===t||n.pipesCount>1&&-1!==Y(n.pipes,t))&&!c&&(h("false write response, pause",n.awaitDrain),n.awaitDrain++),i.pause())}function f(e){h("onerror",e),_(),t.removeListener("error",f),0===o(t,"error")&&S(t,e)}function p(){t.removeListener("finish",m),_()}function m(){h("onfinish"),t.removeListener("close",p),_()}function _(){h("unpipe"),i.unpipe(t)}return i.on("data",d),function(t,e,i){if("function"==typeof t.prependListener)return t.prependListener(e,i);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]:t.on(e,i)}(t,"error",f),t.once("close",p),t.once("finish",m),t.emit("pipe",i),n.flowing||(h("pipe resume"),i.resume()),t},O.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i)),this;if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=Y(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i)),this},O.prototype.on=function(t,e){var i=s.prototype.on.call(this,t,e),n=this._readableState;return"data"===t?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===t&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,h("on readable",n.length,n.reading),n.length?A(this):n.reading||a.nextTick(R,this))),i},O.prototype.addListener=O.prototype.on,O.prototype.removeListener=function(t,e){var i=s.prototype.removeListener.call(this,t,e);return"readable"===t&&a.nextTick(z,this),i},O.prototype.removeAllListeners=function(t){var e=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||a.nextTick(z,this),e},O.prototype.resume=function(){var t=this._readableState;return t.flowing||(h("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,a.nextTick(F,t,e))}(this,t)),t.paused=!1,this},O.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},O.prototype.wrap=function(t){var e=this,i=this._readableState,n=!1;for(var r in t.on("end",(function(){if(h("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(r){(h("wrapped data"),i.decoder&&(r=i.decoder.write(r)),i.objectMode&&null==r)||(i.objectMode||r&&r.length)&&(e.push(r)||(n=!0,t.pause()))})),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(e){return function(){return t[e].apply(t,arguments)}}(r));for(var o=0;o<E.length;o++)t.on(E[o],this.emit.bind(this,E[o]));return this._read=function(e){h("wrapped _read",e),n&&(n=!1,t.resume())},this},"function"==typeof Symbol&&(O.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r("2UdT6")),f(this)}),Object.defineProperty(O.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(O.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(O.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),O._fromList=j,Object.defineProperty(O.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(O.from=function(t,e){return void 0===p&&(p=r("e6P81")),p(O,t,e)})}));var o,s,a={},l=a={};function u(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{s="function"==typeof clearTimeout?clearTimeout:h}catch(t){s=h}}();var d,f=[],p=!1,m=-1;function _(){p&&d&&(p=!1,d.length?f=d.concat(f):m=-1,f.length&&g())}function g(){if(!p){var t=c(_);p=!0;for(var e=f.length;e;){for(d=f,f=[];++m<e;)d&&d[m].run();m=-1,e=f.length}d=null,p=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===h||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function v(){}l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];f.push(new y(t,e)),1!==f.length||p||c(g)},y.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=v,l.addListener=v,l.once=v,l.off=v,l.removeListener=v,l.removeAllListeners=v,l.emit=v,l.prependListener=v,l.prependOnceListener=v,l.listeners=function(t){return[]},l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0},r.register("jfAlf",(function(t,e){t.exports=r("7etJZ").EventEmitter}));var b,w,x,T,S,E,P={};e(P,"Buffer",(()=>b),(t=>b=t)),e(P,"SlowBuffer",(()=>w),(t=>w=t)),e(P,"INSPECT_MAX_BYTES",(()=>x),(t=>x=t)),e(P,"kMaxLength",(()=>T),(t=>T=t)),S=function(t){var e,i,n=z(t),r=n[0],o=n[1],s=new A(function(t,e,i){return 3*(e+i)/4-i}(0,r,o)),a=0,l=o>0?r-4:r;for(i=0;i<l;i+=4)e=C[t.charCodeAt(i)]<<18|C[t.charCodeAt(i+1)]<<12|C[t.charCodeAt(i+2)]<<6|C[t.charCodeAt(i+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===o&&(e=C[t.charCodeAt(i)]<<2|C[t.charCodeAt(i+1)]>>4,s[a++]=255&e);1===o&&(e=C[t.charCodeAt(i)]<<10|C[t.charCodeAt(i+1)]<<4|C[t.charCodeAt(i+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},E=function(t){for(var e,i=t.length,n=i%3,r=[],o=16383,s=0,a=i-n;s<a;s+=o)r.push(R(t,s,s+o>a?a:s+o));1===n?(e=t[i-1],r.push(I[e>>2]+I[e<<4&63]+"==")):2===n&&(e=(t[i-2]<<8)+t[i-1],r.push(I[e>>10]+I[e>>4&63]+I[e<<2&63]+"="));return r.join("")}
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */;for(var O,k,I=[],C=[],A="undefined"!=typeof Uint8Array?Uint8Array:Array,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D=0,N=M.length;D<N;++D)I[D]=M[D],C[M.charCodeAt(D)]=D;function z(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function R(t,e,i){for(var n,r,o=[],s=e;s<i;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(I[(r=n)>>18&63]+I[r>>12&63]+I[r>>6&63]+I[63&r]);return o.join("")}C["-".charCodeAt(0)]=62,C["_".charCodeAt(0)]=63,O=function(t,e,i,n,r){var o,s,a=8*r-n-1,l=(1<<a)-1,u=l>>1,h=-7,c=i?r-1:0,d=i?-1:1,f=t[e+c];for(c+=d,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+t[e+c],c+=d,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[e+c],c+=d,h-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)},k=function(t,e,i,n,r,o){var s,a,l,u=8*o-r-1,h=(1<<u)-1,c=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+c>=1?d/l:d*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=h?(a=0,s=h):s+c>=1?(a=(e*l-1)*Math.pow(2,r),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,r),s=0));r>=8;t[i+f]=255&a,f+=p,a/=256,r-=8);for(s=s<<r|a,u+=r;u>0;t[i+f]=255&s,f+=p,s/=256,u-=8);t[i+f-p]|=128*m};var F="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;b=j,w=function(t){+t!=t&&(t=0);return j.alloc(+t)},x=50;function B(t){if(t>2147483647)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,j.prototype),e}function j(t,e,i){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return Y(t)}return U(t,e,i)}function U(t,e,i){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!j.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var i=0|q(t,e),n=B(i),r=n.write(t,e);r!==i&&(n=n.slice(0,r));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(yt(t,Uint8Array)){var e=new Uint8Array(t);return H(e.buffer,e.byteOffset,e.byteLength)}return W(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(yt(t,ArrayBuffer)||t&&yt(t.buffer,ArrayBuffer))return H(t,e,i);if("undefined"!=typeof SharedArrayBuffer&&(yt(t,SharedArrayBuffer)||t&&yt(t.buffer,SharedArrayBuffer)))return H(t,e,i);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return j.from(n,e,i);var r=function(t){if(j.isBuffer(t)){var e=0|V(t.length),i=B(e);return 0===i.length||t.copy(i,0,0,e),i}if(void 0!==t.length)return"number"!=typeof t.length||vt(t.length)?B(0):W(t);if("Buffer"===t.type&&Array.isArray(t.data))return W(t.data)}(t);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return j.from(t[Symbol.toPrimitive]("string"),e,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function Z(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function Y(t){return Z(t),B(t<0?0:0|V(t))}function W(t){for(var e=t.length<0?0:0|V(t.length),i=B(e),n=0;n<e;n+=1)i[n]=255&t[n];return i}function H(t,e,i){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i),Object.setPrototypeOf(n,j.prototype),n}function V(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function q(t,e){if(j.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||yt(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var i=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return mt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return _t(t).length;default:if(r)return n?-1:mt(t).length;e=(""+e).toLowerCase(),r=!0}}function G(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return at(this,e,i);case"utf8":case"utf-8":return rt(this,e,i);case"ascii":return ot(this,e,i);case"latin1":case"binary":return st(this,e,i);case"base64":return nt(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lt(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function K(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function $(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),vt(i=+i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=j.from(e,n)),j.isBuffer(e))return 0===e.length?-1:J(t,e,i,n,r);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):J(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function J(t,e,i,n,r){var o,s=1,a=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,i/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(r){var h=-1;for(o=i;o<a;o++)if(u(t,o)===u(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(i+l>a&&(i=a-l),o=i;o>=0;o--){for(var c=!0,d=0;d<l;d++)if(u(t,o+d)!==u(e,d)){c=!1;break}if(c)return o}return-1}function X(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(vt(a))return s;t[i+s]=a}return s}function Q(t,e,i,n){return gt(mt(e,t.length-i),t,i,n)}function tt(t,e,i,n){return gt(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function et(t,e,i,n){return gt(_t(e),t,i,n)}function it(t,e,i,n){return gt(function(t,e){for(var i,n,r,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(i=t.charCodeAt(s))>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function nt(t,e,i){return 0===e&&i===t.length?E(t):E(t.slice(e,i))}function rt(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var o,s,a,l,u=t[r],h=null,c=u>239?4:u>223?3:u>191?2:1;if(r+c<=i)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(o=t[r+1]))&&(l=(31&u)<<6|63&o)>127&&(h=l);break;case 3:o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&(l=(15&u)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:o=t[r+1],s=t[r+2],a=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),r+=c}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return i}(n)}T=2147483647,j.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),j.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(j.prototype,"parent",{enumerable:!0,get:function(){if(j.isBuffer(this))return this.buffer}}),Object.defineProperty(j.prototype,"offset",{enumerable:!0,get:function(){if(j.isBuffer(this))return this.byteOffset}}),j.poolSize=8192,j.from=function(t,e,i){return U(t,e,i)},Object.setPrototypeOf(j.prototype,Uint8Array.prototype),Object.setPrototypeOf(j,Uint8Array),j.alloc=function(t,e,i){return function(t,e,i){return Z(t),t<=0?B(t):void 0!==e?"string"==typeof i?B(t).fill(e,i):B(t).fill(e):B(t)}(t,e,i)},j.allocUnsafe=function(t){return Y(t)},j.allocUnsafeSlow=function(t){return Y(t)},j.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==j.prototype},j.compare=function(t,e){if(yt(t,Uint8Array)&&(t=j.from(t,t.offset,t.byteLength)),yt(e,Uint8Array)&&(e=j.from(e,e.offset,e.byteLength)),!j.isBuffer(t)||!j.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},j.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},j.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return j.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=j.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var o=t[i];if(yt(o,Uint8Array))r+o.length>n.length?j.from(o).copy(n,r):Uint8Array.prototype.set.call(n,o,r);else{if(!j.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r)}r+=o.length}return n},j.byteLength=q,j.prototype._isBuffer=!0,j.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)K(this,e,e+1);return this},j.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)K(this,e,e+3),K(this,e+1,e+2);return this},j.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)K(this,e,e+7),K(this,e+1,e+6),K(this,e+2,e+5),K(this,e+3,e+4);return this},j.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?rt(this,0,t):G.apply(this,arguments)},j.prototype.toLocaleString=j.prototype.toString,j.prototype.equals=function(t){if(!j.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===j.compare(this,t)},j.prototype.inspect=function(){var t="",e=x;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},F&&(j.prototype[F]=j.prototype.inspect),j.prototype.compare=function(t,e,i,n,r){if(yt(t,Uint8Array)&&(t=j.from(t,t.offset,t.byteLength)),!j.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(n>>>=0),s=(i>>>=0)-(e>>>=0),a=Math.min(o,s),l=this.slice(n,r),u=t.slice(e,i),h=0;h<a;++h)if(l[h]!==u[h]){o=l[h],s=u[h];break}return o<s?-1:s<o?1:0},j.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},j.prototype.indexOf=function(t,e,i){return $(this,t,e,i,!0)},j.prototype.lastIndexOf=function(t,e,i){return $(this,t,e,i,!1)},j.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return X(this,t,e,i);case"utf8":case"utf-8":return Q(this,t,e,i);case"ascii":case"latin1":case"binary":return tt(this,t,e,i);case"base64":return et(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return it(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},j.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ot(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function st(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function at(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",o=e;o<i;++o)r+=bt[t[o]];return r}function lt(t,e,i){for(var n=t.slice(e,i),r="",o=0;o<n.length-1;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function ut(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function ht(t,e,i,n,r,o){if(!j.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function ct(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function dt(t,e,i,n,r){return e=+e,i>>>=0,r||ct(t,0,i,4),k(t,e,i,n,23,4),i+4}function ft(t,e,i,n,r){return e=+e,i>>>=0,r||ct(t,0,i,8),k(t,e,i,n,52,8),i+8}j.prototype.slice=function(t,e){var i=this.length;(t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,j.prototype),n},j.prototype.readUintLE=j.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||ut(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n},j.prototype.readUintBE=j.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||ut(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},j.prototype.readUint8=j.prototype.readUInt8=function(t,e){return t>>>=0,e||ut(t,1,this.length),this[t]},j.prototype.readUint16LE=j.prototype.readUInt16LE=function(t,e){return t>>>=0,e||ut(t,2,this.length),this[t]|this[t+1]<<8},j.prototype.readUint16BE=j.prototype.readUInt16BE=function(t,e){return t>>>=0,e||ut(t,2,this.length),this[t]<<8|this[t+1]},j.prototype.readUint32LE=j.prototype.readUInt32LE=function(t,e){return t>>>=0,e||ut(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},j.prototype.readUint32BE=j.prototype.readUInt32BE=function(t,e){return t>>>=0,e||ut(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},j.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||ut(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},j.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||ut(t,e,this.length);for(var n=e,r=1,o=this[t+--n];n>0&&(r*=256);)o+=this[t+--n]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},j.prototype.readInt8=function(t,e){return t>>>=0,e||ut(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},j.prototype.readInt16LE=function(t,e){t>>>=0,e||ut(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},j.prototype.readInt16BE=function(t,e){t>>>=0,e||ut(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},j.prototype.readInt32LE=function(t,e){return t>>>=0,e||ut(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},j.prototype.readInt32BE=function(t,e){return t>>>=0,e||ut(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},j.prototype.readFloatLE=function(t,e){return t>>>=0,e||ut(t,4,this.length),O(this,t,!0,23,4)},j.prototype.readFloatBE=function(t,e){return t>>>=0,e||ut(t,4,this.length),O(this,t,!1,23,4)},j.prototype.readDoubleLE=function(t,e){return t>>>=0,e||ut(t,8,this.length),O(this,t,!0,52,8)},j.prototype.readDoubleBE=function(t,e){return t>>>=0,e||ut(t,8,this.length),O(this,t,!1,52,8)},j.prototype.writeUintLE=j.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e>>>=0,i>>>=0,n)||ht(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},j.prototype.writeUintBE=j.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e>>>=0,i>>>=0,n)||ht(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},j.prototype.writeUint8=j.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,1,255,0),this[e]=255&t,e+1},j.prototype.writeUint16LE=j.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},j.prototype.writeUint16BE=j.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},j.prototype.writeUint32LE=j.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},j.prototype.writeUint32BE=j.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},j.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var r=Math.pow(2,8*i-1);ht(this,t,e,i,r-1,-r)}var o=0,s=1,a=0;for(this[e]=255&t;++o<i&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+i},j.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var r=Math.pow(2,8*i-1);ht(this,t,e,i,r-1,-r)}var o=i-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+i},j.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},j.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},j.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},j.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},j.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||ht(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},j.prototype.writeFloatLE=function(t,e,i){return dt(this,t,e,!0,i)},j.prototype.writeFloatBE=function(t,e,i){return dt(this,t,e,!1,i)},j.prototype.writeDoubleLE=function(t,e,i){return ft(this,t,e,!0,i)},j.prototype.writeDoubleBE=function(t,e,i){return ft(this,t,e,!1,i)},j.prototype.copy=function(t,e,i,n){if(!j.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r=n-i;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,i,n):Uint8Array.prototype.set.call(t,this.subarray(i,n),e),r},j.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!j.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var r=t.charCodeAt(0);("utf8"===n&&r<128||"latin1"===n)&&(t=r)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var o;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=e;o<i;++o)this[o]=t;else{var s=j.isBuffer(t)?t:j.from(t,n),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<i-e;++o)this[o+e]=s[o%a]}return this};var pt=/[^+/0-9A-Za-z-_]/g;function mt(t,e){var i;e=e||1/0;for(var n=t.length,r=null,o=[],s=0;s<n;++s){if((i=t.charCodeAt(s))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function _t(t){return S(function(t){if((t=(t=t.split("=")[0]).trim().replace(pt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function gt(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}function yt(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function vt(t){return t!=t}var bt=function(){for(var t="0123456789abcdef",e=new Array(256),i=0;i<16;++i)for(var n=16*i,r=0;r<16;++r)e[n+r]=t[i]+t[r];return e}();r.register("bF5dL",(function(t,e){function i(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=b,a=r("kjyEk").inspect,l=a&&a.custom||"inspect";t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}var e,r,u;return e=t,r=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i}},{key:"concat",value:function(t){if(0===this.length)return s.alloc(0);for(var e,i,n,r=s.allocUnsafe(t>>>0),o=this.head,a=0;o;)e=o.data,i=r,n=a,s.prototype.copy.call(e,i,n),a+=o.data.length,o=o.next;return r}},{key:"consume",value:function(t,e){var i;return t<this.head.data.length?(i=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):i=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,i=1,n=e.data;for(t-=n.length;e=e.next;){var r=e.data,o=t>r.length?r.length:t;if(o===r.length?n+=r:n+=r.slice(0,t),0==(t-=o)){o===r.length?(++i,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=r.slice(o));break}++i}return this.length-=i,n}},{key:"_getBuffer",value:function(t){var e=s.allocUnsafe(t),i=this.head,n=1;for(i.data.copy(e),t-=i.data.length;i=i.next;){var r=i.data,o=t>r.length?r.length:t;if(r.copy(e,e.length-t,0,o),0==(t-=o)){o===r.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=r.slice(o));break}++n}return this.length-=n,e}},{key:l,value:function(t,e){return a(this,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e,{depth:0,customInspect:!1}))}}],r&&o(e.prototype,r),u&&o(e,u),t}()})),r.register("fMCbt",(function(t,e){function i(t,e){r(t,e),n(t)}function n(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function r(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var o=this,s=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return s||l?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,a.nextTick(r,this,t)):a.nextTick(r,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?o._writableState?o._writableState.errorEmitted?a.nextTick(n,o):(o._writableState.errorEmitted=!0,a.nextTick(i,o,t)):a.nextTick(i,o,t):e?(a.nextTick(n,o),e(t)):a.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var i=t._readableState,n=t._writableState;i&&i.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}}})),r.register("04a3B",(function(t,e){var i=r("6JySE").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(t,e,n,r){var o=function(t,e,i){return null!=t.highWaterMark?t.highWaterMark:e?t[i]:null}(e,r,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new i(r?n:"highWaterMark",o);return Math.floor(o)}return t.objectMode?16:16384}}})),r.register("6JySE",(function(t,i){var n;e(t.exports,"codes",(()=>n),(t=>n=t));var r={};function o(t,e,i){i||(i=Error);var n=function(t){var i,n;function r(i,n,r){return t.call(this,function(t,i,n){return"string"==typeof e?e:e(t,i,n)}(i,n,r))||this}return n=t,(i=r).prototype=Object.create(n.prototype),i.prototype.constructor=i,i.__proto__=n,r}(i);n.prototype.name=i.name,n.prototype.code=t,r[t]=n}function s(t,e){if(Array.isArray(t)){var i=t.length;return t=t.map((function(t){return String(t)})),i>2?"one of ".concat(e," ").concat(t.slice(0,i-1).join(", "),", or ")+t[i-1]:2===i?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}o("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(t,e,i){var n,r,o,a;if("string"==typeof e&&(r="not ",e.substr(!o||o<0?0:+o,r.length)===r)?(n="must not be",e=e.replace(/^not /,"")):n="must be",function(t,e,i){return(void 0===i||i>t.length)&&(i=t.length),t.substring(i-e.length,i)===e}(t," argument"))a="The ".concat(t," ").concat(n," ").concat(s(e,"type"));else{var l=function(t,e,i){return"number"!=typeof i&&(i=0),!(i+e.length>t.length)&&-1!==t.indexOf(e,i)}(t,".")?"property":"argument";a='The "'.concat(t,'" ').concat(l," ").concat(n," ").concat(s(e,"type"))}return a+=". Received type ".concat(typeof i)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n=r})),r.register("DwJuQ",(function(t,e){var i=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};t.exports=h;var n=r("d4xg3"),o=r("3LwY7");r("dlqwk")(h,n);for(var s=i(o.prototype),l=0;l<s.length;l++){var u=s[l];h.prototype[u]||(h.prototype[u]=o.prototype[u])}function h(t){if(!(this instanceof h))return new h(t);n.call(this,t),o.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||a.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})})),r.register("3LwY7",(function(e,i){function n(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,i){var n=t.entry;t.entry=null;for(;n;){var r=n.callback;e.pendingcb--,r(i),n=n.next}e.corkedRequestsFree.next=t}(e,t)}}var o;e.exports=O,O.WritableState=P;var s={deprecate:r("39vsn")},l=r("jfAlf"),u=b,h=t.Uint8Array||function(){};var c,d=r("fMCbt"),f=r("04a3B").getHighWaterMark,p=r("6JySE").codes,m=p.ERR_INVALID_ARG_TYPE,_=p.ERR_METHOD_NOT_IMPLEMENTED,g=p.ERR_MULTIPLE_CALLBACK,y=p.ERR_STREAM_CANNOT_PIPE,v=p.ERR_STREAM_DESTROYED,w=p.ERR_STREAM_NULL_VALUES,x=p.ERR_STREAM_WRITE_AFTER_END,T=p.ERR_UNKNOWN_ENCODING,S=d.errorOrDestroy;function E(){}function P(t,e,i){o=o||r("DwJuQ"),t=t||{},"boolean"!=typeof i&&(i=e instanceof o),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=f(this,t,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===t.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var i=t._writableState,n=i.sync,r=i.writecb;if("function"!=typeof r)throw new g;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),e)!function(t,e,i,n,r){--e.pendingcb,i?(a.nextTick(r,n),a.nextTick(M,t,e),t._writableState.errorEmitted=!0,S(t,n)):(r(n),t._writableState.errorEmitted=!0,S(t,n),M(t,e))}(t,i,n,e,r);else{var o=C(i)||t.destroyed;o||i.corked||i.bufferProcessing||!i.bufferedRequest||I(t,i),n?a.nextTick(L,t,i,o,r):L(t,i,o,r)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function O(t){var e=this instanceof(o=o||r("DwJuQ"));if(!e&&!c.call(O,this))return new O(t);this._writableState=new P(t,this,e),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function k(t,e,i,n,r,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new v("write")):i?t._writev(r,e.onwrite):t._write(r,o,e.onwrite),e.sync=!1}function L(t,e,i,n){i||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),M(t,e)}function I(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount,o=new Array(r),s=e.corkedRequestsFree;s.entry=i;for(var a=0,l=!0;i;)o[a]=i,i.isBuf||(l=!1),i=i.next,a+=1;o.allBuffers=l,k(t,e,!0,e.length,o,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new n(e),e.bufferedRequestCount=0}else{for(;i;){var u=i.chunk,h=i.encoding,c=i.callback;if(k(t,e,!1,e.objectMode?1:u.length,u,h,c),i=i.next,e.bufferedRequestCount--,e.writing)break}null===i&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}function C(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function A(t,e){t._final((function(i){e.pendingcb--,i&&S(t,i),e.prefinished=!0,t.emit("prefinish"),M(t,e)}))}function M(t,e){var i=C(e);if(i&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,a.nextTick(A,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return i}r("dlqwk")(O,l),P.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(P.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(O,Symbol.hasInstance,{value:function(t){return!!c.call(this,t)||this===O&&(t&&t._writableState instanceof P)}})):c=function(t){return t instanceof this},O.prototype.pipe=function(){S(this,new y)},O.prototype.write=function(t,e,i){var n,r=this._writableState,o=!1,s=!r.objectMode&&(n=t,u.isBuffer(n)||n instanceof h);return s&&!u.isBuffer(t)&&(t=function(t){return u.from(t)}(t)),"function"==typeof e&&(i=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof i&&(i=E),r.ending?function(t,e){var i=new x;S(t,i),a.nextTick(e,i)}(this,i):(s||function(t,e,i,n){var r;return null===i?r=new w:"string"==typeof i||e.objectMode||(r=new m("chunk",["string","Buffer"],i)),!r||(S(t,r),a.nextTick(n,r),!1)}(this,r,t,i))&&(r.pendingcb++,o=function(t,e,i,n,r,o){if(!i){var s=function(t,e,i){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=u.from(e,i));return e}(e,n,r);n!==s&&(i=!0,r="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var l=e.length<e.highWaterMark;l||(e.needDrain=!0);if(e.writing||e.corked){var h=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else k(t,e,!1,a,n,r,o);return l}(this,r,s,t,e,i)),o},O.prototype.cork=function(){this._writableState.corked++},O.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||I(this,t))},O.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new T(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),O.prototype._write=function(t,e,i){i(new _("_write()"))},O.prototype._writev=null,O.prototype.end=function(t,e,i){var n=this._writableState;return"function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!=t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||function(t,e,i){e.ending=!0,M(t,e),i&&(e.finished?a.nextTick(i):t.once("finish",i));e.ended=!0,t.writable=!1}(this,n,i),this},Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),O.prototype.destroy=d.destroy,O.prototype._undestroy=d.undestroy,O.prototype._destroy=function(t,e){e(t)}})),r.register("39vsn",(function(e,i){function n(e){try{if(!t.localStorage)return!1}catch(t){return!1}var i=t.localStorage[e];return null!=i&&"true"===String(i).toLowerCase()}e.exports=function(t,e){if(n("noDeprecation"))return t;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),i=!0}return t.apply(this,arguments)}}})),r.register("eNRCS",(function(t,i){var n;e(t.exports,"StringDecoder",(()=>n),(t=>n=t));var o=r("1U9GM").Buffer,s=o.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(o.isEncoding===s||!s(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=h,this.end=c,e=4;break;case"utf8":this.fillLast=u,e=4;break;case"base64":this.text=d,this.end=f,e=3;break;default:return this.write=p,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(e)}function l(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function u(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function h(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var n=i.charCodeAt(i.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function d(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function f(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function p(t){return t.toString(this.encoding)}function m(t){return t&&t.length?this.write(t):""}n=a,a.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},a.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},a.prototype.text=function(t,e){var i=function(t,e,i){var n=e.length-1;if(n<i)return 0;var r=l(e[n]);if(r>=0)return r>0&&(t.lastNeed=r-1),r;if(--n<i||-2===r)return 0;if((r=l(e[n]))>=0)return r>0&&(t.lastNeed=r-2),r;if(--n<i||-2===r)return 0;if((r=l(e[n]))>=0)return r>0&&(2===r?r=0:t.lastNeed=r-3),r;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var n=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}})),r.register("1U9GM",(function(t,e){var i=P.Buffer;function n(t,e){for(var i in t)e[i]=t[i]}function r(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=P:(n(P,t.exports),t.exports.Buffer=r),r.prototype=Object.create(i.prototype),n(i,r),r.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},r.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},r.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},r.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return P.SlowBuffer(t)}})),r.register("2UdT6",(function(t,e){var i;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var o=r("fiCvv"),s=Symbol("lastResolve"),l=Symbol("lastReject"),u=Symbol("error"),h=Symbol("ended"),c=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function p(t,e){return{value:t,done:e}}function m(t){var e=t[s];if(null!==e){var i=t[f].read();null!==i&&(t[c]=null,t[s]=null,t[l]=null,e(p(i,!1)))}}function _(t){a.nextTick(m,t)}var g=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((n(i={get stream(){return this[f]},next:function(){var t=this,e=this[u];if(null!==e)return Promise.reject(e);if(this[h])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise((function(e,i){a.nextTick((function(){t[u]?i(t[u]):e(p(void 0,!0))}))}));var i,n=this[c];if(n)i=new Promise(function(t,e){return function(i,n){t.then((function(){e[h]?i(p(void 0,!0)):e[d](i,n)}),n)}}(n,this));else{var r=this[f].read();if(null!==r)return Promise.resolve(p(r,!1));i=new Promise(this[d])}return this[c]=i,i}},Symbol.asyncIterator,(function(){return this})),n(i,"return",(function(){var t=this;return new Promise((function(e,i){t[f].destroy(null,(function(t){t?i(t):e(p(void 0,!0))}))}))})),i),g);t.exports=function(t){var e,i=Object.create(y,(n(e={},f,{value:t,writable:!0}),n(e,s,{value:null,writable:!0}),n(e,l,{value:null,writable:!0}),n(e,u,{value:null,writable:!0}),n(e,h,{value:t._readableState.endEmitted,writable:!0}),n(e,d,{value:function(t,e){var n=i[f].read();n?(i[c]=null,i[s]=null,i[l]=null,t(p(n,!1))):(i[s]=t,i[l]=e)},writable:!0}),e));return i[c]=null,o(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=i[l];return null!==e&&(i[c]=null,i[s]=null,i[l]=null,e(t)),void(i[u]=t)}var n=i[s];null!==n&&(i[c]=null,i[s]=null,i[l]=null,n(p(void 0,!0))),i[h]=!0})),t.on("readable",_.bind(null,i)),i}})),r.register("fiCvv",(function(t,e){var i=r("6JySE").codes.ERR_STREAM_PREMATURE_CLOSE;function n(){}t.exports=function t(e,r,o){if("function"==typeof r)return t(e,null,r);r||(r={}),o=function(t){var e=!1;return function(){if(!e){e=!0;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];t.apply(this,n)}}}(o||n);var s=r.readable||!1!==r.readable&&e.readable,a=r.writable||!1!==r.writable&&e.writable,l=function(){e.writable||h()},u=e._writableState&&e._writableState.finished,h=function(){a=!1,u=!0,s||o.call(e)},c=e._readableState&&e._readableState.endEmitted,d=function(){s=!1,c=!0,a||o.call(e)},f=function(t){o.call(e,t)},p=function(){var t;return s&&!c?(e._readableState&&e._readableState.ended||(t=new i),o.call(e,t)):a&&!u?(e._writableState&&e._writableState.ended||(t=new i),o.call(e,t)):void 0},m=function(){e.req.on("finish",h)};return!function(t){return t.setHeader&&"function"==typeof t.abort}(e)?a&&!e._writableState&&(e.on("end",l),e.on("close",l)):(e.on("complete",h),e.on("abort",p),e.req?m():e.on("request",m)),e.on("end",d),e.on("finish",h),!1!==r.error&&e.on("error",f),e.on("close",p),function(){e.removeListener("complete",h),e.removeListener("abort",p),e.removeListener("request",m),e.req&&e.req.removeListener("finish",h),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",h),e.removeListener("end",d),e.removeListener("error",f),e.removeListener("close",p)}}})),r.register("e6P81",(function(t,e){t.exports=function(){throw new Error("Readable.from is not available in the browser")}})),r.register("b7kl8",(function(t,e){t.exports=h;var i=r("6JySE").codes,n=i.ERR_METHOD_NOT_IMPLEMENTED,o=i.ERR_MULTIPLE_CALLBACK,s=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=i.ERR_TRANSFORM_WITH_LENGTH_0,l=r("DwJuQ");function u(t,e){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(null===n)return this.emit("error",new o);i.writechunk=null,i.writecb=null,null!=e&&this.push(e),n(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function h(t){if(!(this instanceof h))return new h(t);l.call(this,t),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",c)}function c(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(e,i){d(t,e,i)}))}function d(t,e,i){if(e)return t.emit("error",e);if(null!=i&&t.push(i),t._writableState.length)throw new a;if(t._transformState.transforming)throw new s;return t.push(null)}r("dlqwk")(h,l),h.prototype.push=function(t,e){return this._transformState.needTransform=!1,l.prototype.push.call(this,t,e)},h.prototype._transform=function(t,e,i){i(new n("_transform()"))},h.prototype._write=function(t,e,i){var n=this._transformState;if(n.writecb=i,n.writechunk=t,n.writeencoding=e,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},h.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},h.prototype._destroy=function(t,e){l.prototype._destroy.call(this,t,(function(t){e(t)}))}})),r.register("4wWcs",(function(t,e){t.exports=n;var i=r("b7kl8");function n(t){if(!(this instanceof n))return new n(t);i.call(this,t)}r("dlqwk")(n,i),n.prototype._transform=function(t,e,i){i(null,t)}})),r.register("aGSwO",(function(t,e){var i;var n=r("6JySE").codes,o=n.ERR_MISSING_ARGS,s=n.ERR_STREAM_DESTROYED;function a(t){if(t)throw t}function l(t,e,n,o){o=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(o);var a=!1;t.on("close",(function(){a=!0})),void 0===i&&(i=r("fiCvv")),i(t,{readable:e,writable:n},(function(t){if(t)return o(t);a=!0,o()}));var l=!1;return function(e){if(!a&&!l)return l=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void o(e||new s("pipe"))}}function u(t){t()}function h(t,e){return t.pipe(e)}function c(t){return t.length?"function"!=typeof t[t.length-1]?a:t.pop():a}t.exports=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n,r=c(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new o("streams");var s=e.map((function(t,i){var o=i<e.length-1;return l(t,o,i>0,(function(t){n||(n=t),t&&s.forEach(u),o||(s.forEach(u),r(n))}))}));return e.reduce(h)}}));var wt=b,xt={};!function(t,e){"object"==typeof xt?e(xt):"function"==typeof define&&define.amd?define(["exports"],e):e(t.L={})}(xt,(function(t){function e(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(e in r=arguments[i])t[e]=r[e];return t}var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function n(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}var r=0;function o(t){return t._leaflet_id=t._leaflet_id||++r,t._leaflet_id}function s(t,e,i){var n,r,o,s;return s=function(){n=!1,r&&(o.apply(i,r),r=!1)},o=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)},o}function a(t,e,i){var n=e[1],r=e[0],o=n-r;return t===n&&i?t:((t-r)%o+o)%o+r}function l(){return!1}function u(t,e){var i=Math.pow(10,void 0===e?6:e);return Math.round(t*i)/i}function h(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function c(t){return h(t).split(/\s+/)}function d(t,e){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?i(t.options):{}),e)t.options[n]=e[n];return t.options}function f(t,e,i){var n=[];for(var r in t)n.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}var p=/\{ *([\w_-]+) *\}/g;function m(t,e){return t.replace(p,(function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n}))}var _=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function g(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function v(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var b=0;function w(t){var e=+new Date,i=Math.max(0,16-(e-b));return b=e+i,window.setTimeout(t,i)}var x=window.requestAnimationFrame||v("RequestAnimationFrame")||w,T=window.cancelAnimationFrame||v("CancelAnimationFrame")||v("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function S(t,e,i){if(!i||x!==w)return x.call(window,n(t,e));t.call(e)}function E(t){t&&T.call(window,t)}var P={extend:e,create:i,bind:n,lastId:r,stamp:o,throttle:s,wrapNum:a,falseFn:l,formatNum:u,trim:h,splitWords:c,setOptions:d,getParamString:f,template:m,isArray:_,indexOf:g,emptyImageUrl:y,requestFn:x,cancelFn:T,requestAnimFrame:S,cancelAnimFrame:E};function O(){}O.extend=function(t){var n=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},r=n.__super__=this.prototype,o=i(r);for(var s in o.constructor=n,n.prototype=o,this)Object.prototype.hasOwnProperty.call(this,s)&&"prototype"!==s&&"__super__"!==s&&(n[s]=this[s]);return t.statics&&(e(n,t.statics),delete t.statics),t.includes&&(!function(t){if("undefined"==typeof L||!L||!L.Mixin)return;t=_(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}(t.includes),e.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=e(i(o.options),t.options)),e(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=o._initHooks.length;t<e;t++)o._initHooks[t].call(this)}},n},O.include=function(t){return e(this.prototype,t),this},O.mergeOptions=function(t){return e(this.prototype.options,t),this},O.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var k={on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var r=0,o=(t=c(t)).length;r<o;r++)this._on(t[r],e,i);return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else for(var r=0,o=(t=c(t)).length;r<o;r++)this._off(t[r],e,i);else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=void 0);for(var r={fn:e,ctx:i},o=n,s=0,a=o.length;s<a;s++)if(o[s].fn===e&&o[s].ctx===i)return;o.push(r)},_off:function(t,e,i){var n,r,o;if(this._events&&(n=this._events[t]))if(e){if(i===this&&(i=void 0),n)for(r=0,o=n.length;r<o;r++){var s=n[r];if(s.ctx===i&&s.fn===e)return s.fn=l,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(r,1)}}else{for(r=0,o=n.length;r<o;r++)n[r].fn=l;delete this._events[t]}},fire:function(t,i,n){if(!this.listens(t,n))return this;var r=e({},i,{type:t,target:this,sourceTarget:i&&i.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var s=0,a=o.length;s<a;s++){var l=o[s];l.fn.call(l.ctx||this,r)}this._firingCount--}}return n&&this._propagateEvent(r),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var r in t)this.once(r,t[r],e);return this}var o=n((function(){this.off(t,e,i).off(t,o,i)}),this);return this.on(t,e,i).on(t,o,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[o(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[o(t)],this},_propagateEvent:function(t){for(var i in this._eventParents)this._eventParents[i].fire(t.type,e({layer:t.target,propagatedFrom:t.target},t),!0)}};k.addEventListener=k.on,k.removeEventListener=k.clearAllEventListeners=k.off,k.addOneTimeEventListener=k.once,k.fireEvent=k.fire,k.hasEventListeners=k.listens;var I=O.extend(k);function C(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var A=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function M(t,e,i){return t instanceof C?t:_(t)?new C(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new C(t.x,t.y):new C(t,e,i)}function D(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function N(t,e){return!t||t instanceof D?t:new D(t,e)}function z(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function R(t,e){return t instanceof z?t:new z(t,e)}function F(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function B(t,e,i){return t instanceof F?t:_(t)&&"object"!=typeof t[0]?3===t.length?new F(t[0],t[1],t[2]):2===t.length?new F(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new F(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new F(t,e,i)}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(t){return this.clone()._add(M(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(M(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new C(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new C(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=A(this.x),this.y=A(this.y),this},distanceTo:function(t){var e=(t=M(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=M(t)).x===this.x&&t.y===this.y},contains:function(t){return t=M(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},D.prototype={extend:function(t){return t=M(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new C((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new C(this.min.x,this.max.y)},getTopRight:function(){return new C(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof C?M(t):N(t))instanceof D?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=N(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>=e.x&&n.x<=i.x,s=r.y>=e.y&&n.y<=i.y;return o&&s},overlaps:function(t){t=N(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>e.x&&n.x<i.x,s=r.y>e.y&&n.y<i.y;return o&&s},isValid:function(){return!(!this.min||!this.max)}},z.prototype={extend:function(t){var e,i,n=this._southWest,r=this._northEast;if(t instanceof F)e=t,i=t;else{if(!(t instanceof z))return t?this.extend(B(t)||R(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||r?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),r.lat=Math.max(i.lat,r.lat),r.lng=Math.max(i.lng,r.lng)):(this._southWest=new F(e.lat,e.lng),this._northEast=new F(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,r=Math.abs(e.lng-i.lng)*t;return new z(new F(e.lat-n,e.lng-r),new F(i.lat+n,i.lng+r))},getCenter:function(){return new F((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new F(this.getNorth(),this.getWest())},getSouthEast:function(){return new F(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof F||"lat"in t?B(t):R(t);var e,i,n=this._southWest,r=this._northEast;return t instanceof z?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=r.lat&&e.lng>=n.lng&&i.lng<=r.lng},intersects:function(t){t=R(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>=e.lat&&n.lat<=i.lat,s=r.lng>=e.lng&&n.lng<=i.lng;return o&&s},overlaps:function(t){t=R(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>e.lat&&n.lat<i.lat,s=r.lng>e.lng&&n.lng<i.lng;return o&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=R(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},F.prototype={equals:function(t,e){return!!t&&(t=B(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+u(this.lat,t)+", "+u(this.lng,t)+")"},distanceTo:function(t){return Z.distance(this,B(t))},wrap:function(){return Z.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return R([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new F(this.lat,this.lng,this.alt)}};var j,U={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new D(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?a(t.lng,this.wrapLng,!0):t.lng;return new F(this.wrapLat?a(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,r=e.lng-i.lng;if(0===n&&0===r)return t;var o=t.getSouthWest(),s=t.getNorthEast();return new z(new F(o.lat-n,o.lng-r),new F(s.lat-n,s.lng-r))}},Z=e({},U,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,r=e.lat*i,o=Math.sin((e.lat-t.lat)*i/2),s=Math.sin((e.lng-t.lng)*i/2),a=o*o+Math.cos(n)*Math.cos(r)*s*s,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),Y=6378137,W={R:Y,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=Math.sin(n*e);return new C(this.R*t.lng*e,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(t){var e=180/Math.PI;return new F((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(j=Y*Math.PI,new D([-j,-j],[j,j]))};function H(t,e,i,n){if(_(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function V(t,e,i,n){return new H(t,e,i,n)}H.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new C((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var q,G=e({},Z,{code:"EPSG:3857",projection:W,transformation:(q=.5/(Math.PI*W.R),V(q,.5,-q,.5))}),K=e({},G,{code:"EPSG:900913"});function $(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function J(t,e){var i,n,r,o,s,a,l="";for(i=0,r=t.length;i<r;i++){for(n=0,o=(s=t[i]).length;n<o;n++)l+=(n?"L":"M")+(a=s[n]).x+" "+a.y;l+=e?Lt?"z":"x":""}return l||"M0 0"}var X=document.documentElement.style,Q="ActiveXObject"in window,tt=Q&&!document.addEventListener,et="msLaunchUri"in navigator&&!("documentMode"in document),it=Ct("webkit"),nt=Ct("android"),rt=Ct("android 2")||Ct("android 3"),ot=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),st=nt&&Ct("Google")&&ot<537&&!("AudioNode"in window),at=!!window.opera,lt=!et&&Ct("chrome"),ut=Ct("gecko")&&!it&&!at&&!Q,ht=!lt&&Ct("safari"),ct=Ct("phantom"),dt="OTransition"in X,ft=0===navigator.platform.indexOf("Win"),pt=Q&&"transition"in X,mt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rt,_t="MozPerspective"in X,gt=!window.L_DISABLE_3D&&(pt||mt||_t)&&!dt&&!ct,yt="undefined"!=typeof orientation||Ct("mobile"),vt=yt&&it,bt=yt&&mt,wt=!window.PointerEvent&&window.MSPointerEvent,xt=!(!window.PointerEvent&&!wt),Tt=!window.L_NO_TOUCH&&(xt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),St=yt&&at,Et=yt&&ut,Pt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ot=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",l,e),window.removeEventListener("testPassiveEventSupport",l,e)}catch(t){}return t}(),kt=!!document.createElement("canvas").getContext,Lt=!(!document.createElementNS||!$("svg").createSVGRect),It=!Lt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Ct(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var At={ie:Q,ielt9:tt,edge:et,webkit:it,android:nt,android23:rt,androidStock:st,opera:at,chrome:lt,gecko:ut,safari:ht,phantom:ct,opera12:dt,win:ft,ie3d:pt,webkit3d:mt,gecko3d:_t,any3d:gt,mobile:yt,mobileWebkit:vt,mobileWebkit3d:bt,msPointer:wt,pointer:xt,touch:Tt,mobileOpera:St,mobileGecko:Et,retina:Pt,passiveEvents:Ot,canvas:kt,svg:Lt,vml:It},Mt=wt?"MSPointerDown":"pointerdown",Dt=wt?"MSPointerMove":"pointermove",Nt=wt?"MSPointerUp":"pointerup",zt=wt?"MSPointerCancel":"pointercancel",Rt={},Ft=!1;function Bt(t,e,i,r){return"touchstart"===e?function(t,e,i){var r=n((function(t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&ze(t),Yt(t,e)}));t["_leaflet_touchstart"+i]=r,t.addEventListener(Mt,r,!1),Ft||(document.addEventListener(Mt,jt,!0),document.addEventListener(Dt,Ut,!0),document.addEventListener(Nt,Zt,!0),document.addEventListener(zt,Zt,!0),Ft=!0)}(t,i,r):"touchmove"===e?function(t,e,i){var n=function(t){t.pointerType===(t.MSPOINTER_TYPE_MOUSE||"mouse")&&0===t.buttons||Yt(t,e)};t["_leaflet_touchmove"+i]=n,t.addEventListener(Dt,n,!1)}(t,i,r):"touchend"===e&&function(t,e,i){var n=function(t){Yt(t,e)};t["_leaflet_touchend"+i]=n,t.addEventListener(Nt,n,!1),t.addEventListener(zt,n,!1)}(t,i,r),this}function jt(t){Rt[t.pointerId]=t}function Ut(t){Rt[t.pointerId]&&(Rt[t.pointerId]=t)}function Zt(t){delete Rt[t.pointerId]}function Yt(t,e){for(var i in t.touches=[],Rt)t.touches.push(Rt[i]);t.changedTouches=[t],e(t)}var Wt=wt?"MSPointerDown":xt?"pointerdown":"touchstart",Ht=wt?"MSPointerUp":xt?"pointerup":"touchend",Vt="_leaflet_";var qt,Gt,Kt,$t,Jt,Xt=pe(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qt=pe(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),te="webkitTransition"===Qt||"OTransition"===Qt?Qt+"End":"transitionend";function ee(t){return"string"==typeof t?document.getElementById(t):t}function ie(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function ne(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function re(t){var e=t.parentNode;e&&e.removeChild(t)}function oe(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function se(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function ae(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function le(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=de(t);return i.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function ue(t,e){if(void 0!==t.classList)for(var i=c(e),n=0,r=i.length;n<r;n++)t.classList.add(i[n]);else if(!le(t,e)){var o=de(t);ce(t,(o?o+" ":"")+e)}}function he(t,e){void 0!==t.classList?t.classList.remove(e):ce(t,h((" "+de(t)+" ").replace(" "+e+" "," ")))}function ce(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function de(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function fe(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}(t,e)}function pe(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function me(t,e,i){var n=e||new C(0,0);t.style[Xt]=(pt?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function _e(t,e){t._leaflet_pos=e,gt?me(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function ge(t){return t._leaflet_pos||new C(0,0)}if("onselectstart"in document)qt=function(){Pe(window,"selectstart",ze)},Gt=function(){ke(window,"selectstart",ze)};else{var ye=pe(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);qt=function(){if(ye){var t=document.documentElement.style;Kt=t[ye],t[ye]="none"}},Gt=function(){ye&&(document.documentElement.style[ye]=Kt,Kt=void 0)}}function ve(){Pe(window,"dragstart",ze)}function be(){ke(window,"dragstart",ze)}function we(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(xe(),$t=t,Jt=t.style.outline,t.style.outline="none",Pe(window,"keydown",xe))}function xe(){$t&&($t.style.outline=Jt,$t=void 0,Jt=void 0,ke(window,"keydown",xe))}function Te(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Se(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Ee={TRANSFORM:Xt,TRANSITION:Qt,TRANSITION_END:te,get:ee,getStyle:ie,create:ne,remove:re,empty:oe,toFront:se,toBack:ae,hasClass:le,addClass:ue,removeClass:he,setClass:ce,getClass:de,setOpacity:fe,testProp:pe,setTransform:me,setPosition:_e,getPosition:ge,disableTextSelection:qt,enableTextSelection:Gt,disableImageDrag:ve,enableImageDrag:be,preventOutline:we,restoreOutline:xe,getSizedParentNode:Te,getScale:Se};function Pe(t,e,i,n){if("object"==typeof e)for(var r in e)Ce(t,r,e[r],i);else for(var o=0,s=(e=c(e)).length;o<s;o++)Ce(t,e[o],i,n);return this}var Oe="_leaflet_events";function ke(t,e,i,n){if("object"==typeof e)for(var r in e)Ae(t,r,e[r],i);else if(e)for(var o=0,s=(e=c(e)).length;o<s;o++)Ae(t,e[o],i,n);else{for(var a in t[Oe])Ae(t,a,t[Oe][a]);delete t[Oe]}return this}function Le(){if(xt)return!(et||ht)}var Ie={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ce(t,e,i,n){var r=e+o(i)+(n?"_"+o(n):"");if(t[Oe]&&t[Oe][r])return this;var s=function(e){return i.call(n||t,e||window.event)},a=s;xt&&0===e.indexOf("touch")?Bt(t,e,s,r):Tt&&"dblclick"===e&&!Le()?function(t,e,i){var n,r,o=!1;function s(t){if(xt){if(!t.isPrimary)return;if("mouse"===t.pointerType)return}else if(t.touches.length>1)return;var e=Date.now(),i=e-(n||e);r=t.touches?t.touches[0]:t,o=i>0&&i<=250,n=e}function a(t){if(o&&!r.cancelBubble){if(xt){if("mouse"===t.pointerType)return;var i,s,a={};for(s in r)i=r[s],a[s]=i&&i.bind?i.bind(r):i;r=a}r.type="dblclick",r.button=0,e(r),n=null}}t[Vt+Wt+i]=s,t[Vt+Ht+i]=a,t[Vt+"dblclick"+i]=e,t.addEventListener(Wt,s,!!Ot&&{passive:!1}),t.addEventListener(Ht,a,!!Ot&&{passive:!1}),t.addEventListener("dblclick",e,!1)}(t,s,r):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Ie[e]||e,s,!!Ot&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(s=function(e){e=e||window.event,We(t,e)&&a(e)},t.addEventListener(Ie[e],s,!1)):t.addEventListener(e,a,!1):"attachEvent"in t&&t.attachEvent("on"+e,s),t[Oe]=t[Oe]||{},t[Oe][r]=s}function Ae(t,e,i,n){var r=e+o(i)+(n?"_"+o(n):""),s=t[Oe]&&t[Oe][r];if(!s)return this;xt&&0===e.indexOf("touch")?function(t,e,i){var n=t["_leaflet_"+e+i];"touchstart"===e?t.removeEventListener(Mt,n,!1):"touchmove"===e?t.removeEventListener(Dt,n,!1):"touchend"===e&&(t.removeEventListener(Nt,n,!1),t.removeEventListener(zt,n,!1))}(t,e,r):Tt&&"dblclick"===e&&!Le()?function(t,e){var i=t[Vt+Wt+e],n=t[Vt+Ht+e],r=t[Vt+"dblclick"+e];t.removeEventListener(Wt,i,!!Ot&&{passive:!1}),t.removeEventListener(Ht,n,!!Ot&&{passive:!1}),t.removeEventListener("dblclick",r,!1)}(t,r):"removeEventListener"in t?t.removeEventListener(Ie[e]||e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[Oe][r]=null}function Me(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,Ye(t),this}function De(t){return Ce(t,"wheel",Me),this}function Ne(t){return Pe(t,"mousedown touchstart dblclick",Me),Ce(t,"click",Ze),this}function ze(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Re(t){return ze(t),Me(t),this}function Fe(t,e){if(!e)return new C(t.clientX,t.clientY);var i=Se(e),n=i.boundingClientRect;return new C((t.clientX-n.left)/i.x-e.clientLeft,(t.clientY-n.top)/i.y-e.clientTop)}var Be=ft&&lt?2*window.devicePixelRatio:ut?window.devicePixelRatio:1;function je(t){return et?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Be:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var Ue={};function Ze(t){Ue[t.type]=!0}function Ye(t){var e=Ue[t.type];return Ue[t.type]=!1,e}function We(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}var He={on:Pe,off:ke,stopPropagation:Me,disableScrollPropagation:De,disableClickPropagation:Ne,preventDefault:ze,stop:Re,getMousePosition:Fe,getWheelDelta:je,fakeStop:Ze,skipped:Ye,isExternalTarget:We,addListener:Pe,removeListener:ke},Ve=I.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=ge(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=S(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),_e(this._el,i),this.fire("step")},_complete:function(){E(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),qe=I.extend({options:{crs:G,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=d(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=n(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(B(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qt&&gt&&!St&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Pe(this._proxy,te,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,i,n){if((i=void 0===i?this._zoom:this._limitZoom(i),t=this._limitCenter(B(t),i,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n)&&(void 0!==n.animate&&(n.zoom=e({animate:n.animate},n.zoom),n.pan=e({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,i,n.zoom):this._tryAnimatedPan(t,n.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,i),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(gt?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(gt?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),r=this.getSize().divideBy(2),o=(t instanceof C?t:this.latLngToContainerPoint(t)).subtract(r).multiplyBy(1-1/n),s=this.containerPointToLatLng(r.add(o));return this.setView(s,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():R(t);var i=M(e.paddingTopLeft||e.padding||[0,0]),n=M(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,i.add(n));if((r="number"==typeof e.maxZoom?Math.min(e.maxZoom,r):r)===1/0)return{center:t.getCenter(),zoom:r};var o=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),r),a=this.project(t.getNorthEast(),r);return{center:this.unproject(s.add(a).divideBy(2).add(o),r),zoom:r}},fitBounds:function(t,e){if(!(t=R(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=M(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ve,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){ue(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(!1===(i=i||{}).animate||!gt)return this.setView(t,e,i);this._stop();var n=this.project(this.getCenter()),r=this.project(t),o=this.getSize(),s=this._zoom;t=B(t),e=void 0===e?s:e;var a=Math.max(o.x,o.y),l=a*this.getZoomScale(s,e),u=r.distanceTo(n)||1,h=1.42,c=2.0164;function d(t){var e=(l*l-a*a+(t?-1:1)*c*c*u*u)/(2*(t?l:a)*c*u),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function f(t){return(Math.exp(t)-Math.exp(-t))/2}function p(t){return(Math.exp(t)+Math.exp(-t))/2}var m=d(0);function _(t){return a*(p(m)*(f(e=m+h*t)/p(e))-f(m))/c;var e}var g=Date.now(),y=(d(1)-m)/h,v=i.duration?1e3*i.duration:1e3*y*.8;return this._moveStart(!0,i.noMoveStart),function i(){var o=(Date.now()-g)/v,l=function(t){return 1-Math.pow(1-t,1.5)}(o)*y;o<=1?(this._flyToFrame=S(i,this),this._move(this.unproject(n.add(r.subtract(n).multiplyBy(_(l)/u)),s),this.getScaleZoom(a/function(t){return a*(p(m)/p(m+h*t))}(l),s),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return(t=R(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,R(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},panInside:function(t,e){var i=M((e=e||{}).paddingTopLeft||e.padding||[0,0]),n=M(e.paddingBottomRight||e.padding||[0,0]),r=this.getCenter(),o=this.project(r),s=this.project(t),a=this.getPixelBounds(),l=a.getSize().divideBy(2),u=N([a.min.add(i),a.max.subtract(n)]);if(!u.contains(s)){this._enforcingBounds=!0;var h=o.subtract(s),c=M(s.x+h.x,s.y+h.y);(s.x<u.min.x||s.x>u.max.x)&&(c.x=o.x-h.x,h.x>0?c.x+=l.x-i.x:c.x-=l.x-n.x),(s.y<u.min.y||s.y>u.max.y)&&(c.y=o.y-h.y,h.y>0?c.y+=l.y-i.y:c.y-=l.y-n.y),this.panTo(this.unproject(c),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var i=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),o=i.divideBy(2).round(),s=r.divideBy(2).round(),a=o.subtract(s);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(n(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:r})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var i=n(this._handleGeolocationResponse,this),r=n(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,r,t):navigator.geolocation.getCurrentPosition(i,r,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=new F(t.coords.latitude,t.coords.longitude),i=e.toBounds(2*t.coords.accuracy),n=this._locateOptions;if(n.setView){var r=this.getBoundsZoom(i);this.setView(e,n.maxZoom?Math.min(r,n.maxZoom):r)}var o={latlng:e,bounds:i,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(o[s]=t.coords[s]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),re(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(E(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)re(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=ne("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new z(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=R(t),i=M(i||[0,0]);var n=this.getZoom()||0,r=this.getMinZoom(),o=this.getMaxZoom(),s=t.getNorthWest(),a=t.getSouthEast(),l=this.getSize().subtract(i),u=N(this.project(a,n),this.project(s,n)).getSize(),h=gt?this.options.zoomSnap:1,c=l.x/u.x,d=l.y/u.y,f=e?Math.max(c,d):Math.min(c,d);return n=this.getScaleZoom(f,n),h&&(n=Math.round(n/(h/100))*(h/100),n=e?Math.ceil(n/h)*h:Math.floor(n/h)*h),Math.max(r,Math.min(o,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new C(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new D(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(B(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(M(t),e)},layerPointToLatLng:function(t){var e=M(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(B(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(B(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(R(t))},distance:function(t,e){return this.options.crs.distance(B(t),B(e))},containerPointToLayerPoint:function(t){return M(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return M(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(M(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(B(t)))},mouseEventToContainerPoint:function(t){return Fe(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ee(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Pe(e,"scroll",this._onScroll,this),this._containerId=o(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&gt,ue(t,"leaflet-container"+(Tt?" leaflet-touch":"")+(Pt?" leaflet-retina":"")+(tt?" leaflet-oldie":"")+(ht?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=ie(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_e(this._mapPane,new C(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ue(t.markerPane,"leaflet-zoom-hide"),ue(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){_e(this._mapPane,new C(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n,!1)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return E(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){_e(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[o(this._container)]=this;var e=t?ke:Pe;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),gt&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){E(this._resizeRequest),this._resizeRequest=S((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],r="mouseout"===e||"mouseover"===e,s=t.target||t.srcElement,a=!1;s;){if((i=this._targets[o(s)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(r&&!We(s,t))break;if(n.push(i),r)break}if(s===this._container)break;s=s.parentNode}return n.length||a||r||!We(s,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!Ye(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e&&"keyup"!==e&&"keydown"!==e||we(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,i,n){if("click"===t.type){var r=e({},t);r.type="preclick",this._fireDOMEvent(r,r.type,n)}if(!t._stopped&&(n=(n||[]).concat(this._findEventTargets(t,i))).length){var o=n[0];"contextmenu"===i&&o.listens(i,!0)&&ze(t);var s={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var a=o.getLatLng&&(!o._radius||o._radius<=10);s.containerPoint=a?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=a?o.getLatLng():this.layerPointToLatLng(s.layerPoint)}for(var l=0;l<n.length;l++)if(n[l].fire(i,s,!0),s.originalEvent._stopped||!1===n[l].options.bubblingMouseEvents&&-1!==g(this._mouseEvents,i))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return ge(this._mapPane)||new C(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return N([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),r=this.getSize().divideBy(2),o=new D(n.subtract(r),n.add(r)),s=this._getBoundsOffset(o,i,e);return s.round().equals([0,0])?t:this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new D(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=N(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),r=n.min.subtract(t.min),o=n.max.subtract(t.max);return new C(this._rebound(r.x,-o.x),this._rebound(r.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=gt?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){he(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)},_createAnimProxy:function(){var t=this._proxy=ne("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=Xt,i=this._proxy.style[e];me(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){re(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();me(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(r))&&(S((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),!0)},_animateZoom:function(t,e,i,r){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ue(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:r}),setTimeout(n(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&he(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),S((function(){this._moveEnd(!0)}),this))}});var Ge=O.extend({options:{position:"topright"},initialize:function(t){d(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return ue(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(re(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ke=function(t){return new Ge(t)};qe.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=ne("div",e+"control-container",this._container);function n(n,r){var o=e+n+" "+e+r;t[n+r]=ne("div",o,i)}n("top","left"),n("top","right"),n("bottom","left"),n("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)re(this._controlCorners[t]);re(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var $e=Ge.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){for(var n in d(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Ge.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(o(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ue(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ue(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):he(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return he(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=ne("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Ne(e),De(e);var n=this._section=ne("section",t+"-list");i&&(this._map.on("click",this.collapse,this),nt||Pe(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var r=this._layersLink=ne("a",t+"-toggle",e);r.href="#",r.title="Layers",Tt?(Pe(r,"click",Re),Pe(r,"click",this.expand,this)):Pe(r,"focus",this.expand,this),i||this.expand(),this._baseLayersList=ne("div",t+"-base",n),this._separator=ne("div",t+"-separator",n),this._overlaysList=ne("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&o(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(n((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;oe(this._baseLayersList),oe(this._overlaysList),this._layerControlInputs=[];var t,e,i,n,r=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,r+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&r>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(o(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers_"+o(this),n),this._layerControlInputs.push(e),e.layerId=o(t.layer),Pe(e,"click",this._onInputClick,this);var r=document.createElement("span");r.innerHTML=" "+t.name;var s=document.createElement("div");return i.appendChild(s),s.appendChild(e),s.appendChild(r),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i=this._layerControlInputs,n=[],r=[];this._handlingClick=!0;for(var o=i.length-1;o>=0;o--)t=i[o],e=this._getLayer(t.layerId).layer,t.checked?n.push(e):t.checked||r.push(e);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])&&this._map.removeLayer(r[o]);for(o=0;o<n.length;o++)this._map.hasLayer(n[o])||this._map.addLayer(n[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,n=this._map.getZoom(),r=i.length-1;r>=0;r--)t=i[r],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Je=Ge.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=ne("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,r){var o=ne("a",i,n);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),Ne(o),Pe(o,"click",Re),Pe(o,"click",r,this),Pe(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";he(this._zoomInButton,e),he(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&ue(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&ue(this._zoomInButton,e)}});qe.mergeOptions({zoomControl:!0}),qe.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new Je,this.addControl(this.zoomControl))}));var Xe=Ge.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=ne("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=ne("div",e,i)),t.imperial&&(this._iScale=ne("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,r=3.2808399*t;r>5280?(e=r/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(r),this._updateScale(this._iScale,n+" ft",n/r))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1)}}),Qe=Ge.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){d(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=ne("div","leaflet-control-attribution"),Ne(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}});qe.mergeOptions({attributionControl:!0}),qe.addInitHook((function(){this.options.attributionControl&&(new Qe).addTo(this)}));Ge.Layers=$e,Ge.Zoom=Je,Ge.Scale=Xe,Ge.Attribution=Qe,Ke.layers=function(t,e,i){return new $e(t,e,i)},Ke.zoom=function(t){return new Je(t)},Ke.scale=function(t){return new Xe(t)},Ke.attribution=function(t){return new Qe(t)};var ti=O.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ti.addTo=function(t,e){return t.addHandler(e,this),this};var ei,ii={Events:k},ni=Tt?"touchstart mousedown":"mousedown",ri={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},oi={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},si=I.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){d(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Pe(this._dragStartTarget,ni,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(si._dragging===this&&this.finishDrag(),ke(this._dragStartTarget,ni,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!le(this._element,"leaflet-zoom-anim")&&!(si._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(si._dragging=this,this._preventOutline&&we(this._element),ve(),qt(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t,i=Te(this._element);this._startPoint=new C(e.clientX,e.clientY),this._parentScale=Se(i),Pe(document,oi[t.type],this._onMove,this),Pe(document,ri[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new C(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,ze(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=ge(this._element).subtract(i),ue(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ue(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,E(this._animRequest),this._lastEvent=t,this._animRequest=S(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),_e(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in he(document.body,"leaflet-dragging"),this._lastTarget&&(he(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),oi)ke(document,oi[t],this._onMove,this),ke(document,ri[t],this._onUp,this);be(),Gt(),this._moved&&this._moving&&(E(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,si._dragging=!1}});function ai(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=function(t,e){for(var i=[t[0]],n=1,r=0,o=t.length;n<o;n++)fi(t[n],t[r])>e&&(i.push(t[n]),r=n);r<o-1&&i.push(t[o-1]);return i}(t,i),t=function(t,e){var i=t.length,n=new("undefined"!=typeof Uint8Array?Uint8Array:Array)(i);n[0]=n[i-1]=1,ui(t,n,e,0,i-1);var r,o=[];for(r=0;r<i;r++)n[r]&&o.push(t[r]);return o}(t,i),t}function li(t,e,i){return Math.sqrt(pi(t,e,i,!0))}function ui(t,e,i,n,r){var o,s,a,l=0;for(s=n+1;s<=r-1;s++)(a=pi(t[s],t[n],t[r],!0))>l&&(o=s,l=a);l>i&&(e[o]=1,ui(t,e,i,n,o),ui(t,e,i,o,r))}function hi(t,e,i,n,r){var o,s,a,l=n?ei:di(t,i),u=di(e,i);for(ei=u;;){if(!(l|u))return[t,e];if(l&u)return!1;a=di(s=ci(t,e,o=l||u,i,r),i),o===l?(t=s,l=a):(e=s,u=a)}}function ci(t,e,i,n,r){var o,s,a=e.x-t.x,l=e.y-t.y,u=n.min,h=n.max;return 8&i?(o=t.x+a*(h.y-t.y)/l,s=h.y):4&i?(o=t.x+a*(u.y-t.y)/l,s=u.y):2&i?(o=h.x,s=t.y+l*(h.x-t.x)/a):1&i&&(o=u.x,s=t.y+l*(u.x-t.x)/a),new C(o,s,r)}function di(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function fi(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function pi(t,e,i,n){var r,o=e.x,s=e.y,a=i.x-o,l=i.y-s,u=a*a+l*l;return u>0&&((r=((t.x-o)*a+(t.y-s)*l)/u)>1?(o=i.x,s=i.y):r>0&&(o+=a*r,s+=l*r)),a=t.x-o,l=t.y-s,n?a*a+l*l:new C(o,s)}function mi(t){return!_(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function _i(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),mi(t)}var gi={simplify:ai,pointToSegmentDistance:li,closestPointOnSegment:function(t,e,i){return pi(t,e,i)},clipSegment:hi,_getEdgeIntersection:ci,_getBitCode:di,_sqClosestPointOnSegment:pi,isFlat:mi,_flat:_i};function yi(t,e,i){var n,r,o,s,a,l,u,h,c,d=[1,4,2,8];for(r=0,u=t.length;r<u;r++)t[r]._code=di(t[r],e);for(s=0;s<4;s++){for(h=d[s],n=[],r=0,o=(u=t.length)-1;r<u;o=r++)a=t[r],l=t[o],a._code&h?l._code&h||((c=ci(l,a,h,e,i))._code=di(c,e),n.push(c)):(l._code&h&&((c=ci(l,a,h,e,i))._code=di(c,e),n.push(c)),n.push(a));t=n}return t}var vi={clipPolygon:yi},bi={project:function(t){return new C(t.lng,t.lat)},unproject:function(t){return new F(t.y,t.x)},bounds:new D([-180,-90],[180,90])},wi={R:6378137,R_MINOR:6356752.314245179,bounds:new D([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,r=this.R_MINOR/i,o=Math.sqrt(1-r*r),s=o*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),o/2);return n=-i*Math.log(Math.max(a,1e-10)),new C(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,r=this.R_MINOR/n,o=Math.sqrt(1-r*r),s=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(s),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=o*Math.sin(a),e=Math.pow((1-e)/(1+e),o/2),a+=u=Math.PI/2-2*Math.atan(s*e)-a;return new F(a*i,t.x*i/n)}},xi={LonLat:bi,Mercator:wi,SphericalMercator:W},Ti=e({},Z,{code:"EPSG:3395",projection:wi,transformation:function(){var t=.5/(Math.PI*wi.R);return V(t,.5,-t,.5)}()}),Si=e({},Z,{code:"EPSG:4326",projection:bi,transformation:V(1/180,1,-1/180,.5)}),Ei=e({},U,{projection:bi,transformation:V(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});U.Earth=Z,U.EPSG3395=Ti,U.EPSG3857=G,U.EPSG900913=K,U.EPSG4326=Si,U.Simple=Ei;var Pi=I.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[o(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[o(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",(function(){e.off(i,this)}),this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});qe.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=o(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=o(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&o(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?_(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[o(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=o(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var r=this._zoomBoundLayers[n].options;t=void 0===r.minZoom?t:Math.min(t,r.minZoom),e=void 0===r.maxZoom?e:Math.max(e,r.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Oi=Pi.extend({initialize:function(t,e){var i,n;if(d(this,e),this._layers={},t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return o(t)}}),ki=Oi.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Oi.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Oi.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new z;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),Li=O.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){d(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var r=M(n),o=M("shadow"===e&&i.shadowAnchor||i.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Pt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var Ii=Li.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Ii.imagePath||(Ii.imagePath=this._detectIconPath()),(this.options.imagePath||Ii.imagePath)+Li.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=ne("div","leaflet-default-icon-path",document.body),e=ie(t,"background-image")||ie(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Ci=ti.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new si(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ue(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&he(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,o=ge(e._icon),s=i.getPixelBounds(),a=i.getPixelOrigin(),l=N(s.min._subtract(a).add(r),s.max._subtract(a).subtract(r));if(!l.contains(o)){var u=M((Math.max(l.max.x,o.x)-l.max.x)/(s.max.x-l.max.x)-(Math.min(l.min.x,o.x)-l.min.x)/(s.min.x-l.min.x),(Math.max(l.max.y,o.y)-l.max.y)/(s.max.y-l.max.y)-(Math.min(l.min.y,o.y)-l.min.y)/(s.min.y-l.min.y)).multiplyBy(n);i.panBy(u,{animate:!1}),this._draggable._newPos._add(u),this._draggable._startPos._add(u),_e(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=S(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(E(this._panRequest),this._panRequest=S(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=ge(e._icon),r=e._map.layerPointToLatLng(n);i&&_e(i,n),e._latlng=r,t.latlng=r,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){E(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Ai=Pi.extend({options:{icon:new Ii,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){d(this,e),this._latlng=B(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=B(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),ue(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var r=t.icon.createShadow(this._shadow),o=!1;r!==this._shadow&&(this._removeShadow(),o=!0),r&&(ue(r,e),r.alt=""),this._shadow=r,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&o&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),re(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&re(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&_e(this._icon,t),this._shadow&&_e(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ue(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ci)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ci(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&fe(this._icon,t),this._shadow&&fe(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Mi=Pi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return d(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Di=Mi.extend({options:{fill:!0,radius:10},initialize:function(t,e){d(this,e),this._latlng=B(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=B(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Mi.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new D(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var Ni=Di.extend({initialize:function(t,i,n){if("number"==typeof i&&(i=e({},n,{radius:i})),d(this,i),this._latlng=B(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new z(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Mi.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===Z.distance){var r=Math.PI/180,o=this._mRadius/Z.R/r,s=i.project([e+o,t]),a=i.project([e-o,t]),l=s.add(a).divideBy(2),u=i.unproject(l).lat,h=Math.acos((Math.cos(o*r)-Math.sin(e*r)*Math.sin(u*r))/(Math.cos(e*r)*Math.cos(u*r)))/r;(isNaN(h)||0===h)&&(h=o/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(h)?0:l.x-i.project([u,t-h]).x,this._radiusY=l.y-s.y}else{var c=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(c).x}this._updateBounds()}});var zi=Mi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){d(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,r=null,o=pi,s=0,a=this._parts.length;s<a;s++)for(var l=this._parts[s],u=1,h=l.length;u<h;u++){var c=o(t,e=l[u-1],i=l[u],!0);c<n&&(n=c,r=o(t,e,i))}return r&&(r.distance=Math.sqrt(n)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,o,s,a=this._rings[0],l=a.length;if(!l)return null;for(t=0,e=0;t<l-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<l-1;t++)if(r=a[t],o=a[t+1],(n+=i=r.distanceTo(o))>e)return s=(n-e)/i,this._map.layerPointToLatLng([o.x-s*(o.x-r.x),o.y-s*(o.y-r.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=B(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new z,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return mi(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=mi(t),n=0,r=t.length;n<r;n++)i?(e[n]=B(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new D;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new C(t,t);this._pxBounds=new D([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)])},_projectLatlngs:function(t,e,i){var n,r,o=t[0]instanceof F,s=t.length;if(o){for(r=[],n=0;n<s;n++)r[n]=this._map.latLngToLayerPoint(t[n]),i.extend(r[n]);e.push(r)}else for(n=0;n<s;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,r,o,s,a,l=this._parts;for(e=0,n=0,r=this._rings.length;e<r;e++)for(i=0,o=(a=this._rings[e]).length;i<o-1;i++)(s=hi(a[i],a[i+1],t,i,!0))&&(l[n]=l[n]||[],l[n].push(s[0]),s[1]===a[i+1]&&i!==o-2||(l[n].push(s[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=ai(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,r,o,s,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,o=this._parts.length;i<o;i++)for(n=0,r=(s=(a=this._parts[i]).length)-1;n<s;r=n++)if((e||0!==n)&&li(t,a[r],a[n])<=l)return!0;return!1}});zi._flat=_i;var Ri=zi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,o,s,a,l,u=this._rings[0],h=u.length;if(!h)return null;for(o=s=a=0,t=0,e=h-1;t<h;e=t++)i=u[t],n=u[e],r=i.y*n.x-n.y*i.x,s+=(i.x+n.x)*r,a+=(i.y+n.y)*r,o+=3*r;return l=0===o?u[0]:[s/o,a/o],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=zi.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof F&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){zi.prototype._setLatLngs.call(this,t),mi(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return mi(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new C(e,e);if(t=new D(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,r=0,o=this._rings.length;r<o;r++)(n=yi(this._rings[r],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,r,o,s,a,l,u=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(r=0,a=this._parts.length;r<a;r++)for(o=0,s=(l=(e=this._parts[r]).length)-1;o<l;s=o++)i=e[o],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u||zi.prototype._containsPoint.call(this,t,!0)}});var Fi=ki.extend({initialize:function(t,e){d(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,r=_(t)?t:t.features;if(r){for(e=0,i=r.length;e<i;e++)((n=r[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var s=Bi(t,o);return s?(s.feature=Vi(t),s.defaultOptions=s.options,this.resetStyle(s),o.onEachFeature&&o.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Bi(t,e){var i,n,r,o,s="Feature"===t.type?t.geometry:t,a=s?s.coordinates:null,l=[],u=e&&e.pointToLayer,h=e&&e.coordsToLatLng||Ui;if(!a&&!s)return null;switch(s.type){case"Point":return ji(u,t,i=h(a),e);case"MultiPoint":for(r=0,o=a.length;r<o;r++)i=h(a[r]),l.push(ji(u,t,i,e));return new ki(l);case"LineString":case"MultiLineString":return n=Zi(a,"LineString"===s.type?0:1,h),new zi(n,e);case"Polygon":case"MultiPolygon":return n=Zi(a,"Polygon"===s.type?1:2,h),new Ri(n,e);case"GeometryCollection":for(r=0,o=s.geometries.length;r<o;r++){var c=Bi({geometry:s.geometries[r],type:"Feature",properties:t.properties},e);c&&l.push(c)}return new ki(l);default:throw new Error("Invalid GeoJSON object.")}}function ji(t,e,i,n){return t?t(e,i):new Ai(i,n&&n.markersInheritOptions&&n)}function Ui(t){return new F(t[1],t[0],t[2])}function Zi(t,e,i){for(var n,r=[],o=0,s=t.length;o<s;o++)n=e?Zi(t[o],e-1,i):(i||Ui)(t[o]),r.push(n);return r}function Yi(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[u(t.lng,e),u(t.lat,e),u(t.alt,e)]:[u(t.lng,e),u(t.lat,e)]}function Wi(t,e,i,n){for(var r=[],o=0,s=t.length;o<s;o++)r.push(e?Wi(t[o],e-1,i,n):Yi(t[o],n));return!e&&i&&r.push(r[0]),r}function Hi(t,i){return t.feature?e({},t.feature,{geometry:i}):Vi(i)}function Vi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var qi={toGeoJSON:function(t){return Hi(this,{type:"Point",coordinates:Yi(this.getLatLng(),t)})}};function Gi(t,e){return new Fi(t,e)}Ai.include(qi),Ni.include(qi),Di.include(qi),zi.include({toGeoJSON:function(t){var e=!mi(this._latlngs);return Hi(this,{type:(e?"Multi":"")+"LineString",coordinates:Wi(this._latlngs,e?1:0,!1,t)})}}),Ri.include({toGeoJSON:function(t){var e=!mi(this._latlngs),i=e&&!mi(this._latlngs[0]),n=Wi(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),Hi(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Oi.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(i){e.push(i.toGeoJSON(t).geometry.coordinates)})),Hi(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer((function(e){if(e.toGeoJSON){var r=e.toGeoJSON(t);if(i)n.push(r.geometry);else{var o=Vi(r);"FeatureCollection"===o.type?n.push.apply(n,o.features):n.push(o)}}})),i?Hi(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var Ki=Gi,$i=Pi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=R(e),d(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ue(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){re(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&se(this._image),this},bringToBack:function(){return this._map&&ae(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=R(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:ne("img");ue(e,"leaflet-image-layer"),this._zoomAnimated&&ue(e,"leaflet-zoom-animated"),this.options.className&&ue(e,this.options.className),e.onselectstart=l,e.onmousemove=l,e.onload=n(this.fire,this,"load"),e.onerror=n(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;me(this._image,i,e)},_reset:function(){var t=this._image,e=new D(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();_e(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){fe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Ji=$i.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:ne("video");if(ue(e,"leaflet-image-layer"),this._zoomAnimated&&ue(e,"leaflet-zoom-animated"),this.options.className&&ue(e,this.options.className),e.onselectstart=l,e.onmousemove=l,e.onloadeddata=n(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),r=[],o=0;o<i.length;o++)r.push(i[o].src);this._url=i.length>0?r:[e.src]}else{_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted;for(var s=0;s<this._url.length;s++){var a=ne("source");a.src=this._url[s],e.appendChild(a)}}}});var Xi=$i.extend({_initImage:function(){var t=this._image=this._url;ue(t,"leaflet-image-layer"),this._zoomAnimated&&ue(t,"leaflet-zoom-animated"),this.options.className&&ue(t,this.options.className),t.onselectstart=l,t.onmousemove=l}});var Qi=Pi.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){d(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&fe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&fe(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(fe(this._container,0),this._removeTimeout=setTimeout(n(re,void 0,this._container),200)):re(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=B(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&se(this._container),this},bringToBack:function(){return this._map&&ae(this._container),this},_prepareOpen:function(t,e,i){if(e instanceof Pi||(i=e,e=t),e instanceof ki)for(var n in t._layers){e=t._layers[n];break}if(!i)if(e.getCenter)i=e.getCenter();else{if(!e.getLatLng)throw new Error("Unable to get source layer LatLng.");i=e.getLatLng()}return this._source=e,this.update(),i},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=M(this.options.offset),i=this._getAnchor();this._zoomAnimated?_e(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}}),tn=Qi.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Qi.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Mi||this._source.on("preclick",Me))},onRemove:function(t){Qi.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Mi||this._source.off("preclick",Me))},getEvents:function(){var t=Qi.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=ne("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=ne("div",t+"-content-wrapper",e);if(this._contentNode=ne("div",t+"-content",i),Ne(e),De(this._contentNode),Pe(e,"contextmenu",Me),this._tipContainer=ne("div",t+"-tip-container",e),this._tip=ne("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=ne("a",t+"-close-button",e);n.href="#close",n.innerHTML="&#215;",Pe(n,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,r=this.options.maxHeight,o="leaflet-popup-scrolled";r&&n>r?(e.height=r+"px",ue(t,o)):he(t,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();_e(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var t=this._map,e=parseInt(ie(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,r=new C(this._containerLeft,-i-this._containerBottom);r._add(ge(this._container));var o=t.layerPointToContainerPoint(r),s=M(this.options.autoPanPadding),a=M(this.options.autoPanPaddingTopLeft||s),l=M(this.options.autoPanPaddingBottomRight||s),u=t.getSize(),h=0,c=0;o.x+n+l.x>u.x&&(h=o.x+n-u.x+l.x),o.x-h-a.x<0&&(h=o.x-a.x),o.y+i+l.y>u.y&&(c=o.y+i-u.y+l.y),o.y-c-a.y<0&&(c=o.y-a.y),(h||c)&&t.fire("autopanstart").panBy([h,c])}},_onCloseButtonClick:function(t){this._close(),Re(t)},_getAnchor:function(){return M(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});qe.mergeOptions({closePopupOnClick:!0}),qe.include({openPopup:function(t,e,i){return t instanceof tn||(t=new tn(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Pi.include({bindPopup:function(t,e){return t instanceof tn?(d(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new tn(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){return this._popup&&this._map&&(e=this._popup._prepareOpen(this,t,e),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(Re(t),e instanceof Mi?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var en=Qi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Qi.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Qi.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Qi.prototype.getEvents.call(this);return Tt&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ne("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,i,n=this._map,r=this._container,o=n.latLngToContainerPoint(n.getCenter()),s=n.layerPointToContainerPoint(t),a=this.options.direction,l=r.offsetWidth,u=r.offsetHeight,h=M(this.options.offset),c=this._getAnchor();"top"===a?(e=l/2,i=u):"bottom"===a?(e=l/2,i=0):"center"===a?(e=l/2,i=u/2):"right"===a?(e=0,i=u/2):"left"===a?(e=l,i=u/2):s.x<o.x?(a="right",e=0,i=u/2):(a="left",e=l+2*(h.x+c.x),i=u/2),t=t.subtract(M(e,i,!0)).add(h).add(c),he(r,"leaflet-tooltip-right"),he(r,"leaflet-tooltip-left"),he(r,"leaflet-tooltip-top"),he(r,"leaflet-tooltip-bottom"),ue(r,"leaflet-tooltip-"+a),_e(r,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&fe(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return M(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});qe.include({openTooltip:function(t,e,i){return t instanceof en||(t=new en(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Pi.include({bindTooltip:function(t,e){return t instanceof en?(d(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new en(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),Tt&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){return this._tooltip&&this._map&&(e=this._tooltip._prepareOpen(this,t,e),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(ue(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(he(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}});var nn=Li.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(oe(e),e.appendChild(i.html)):e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=M(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Li.Default=Ii;var rn=Pi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:yt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){d(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),re(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(se(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ae(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof C?t:new C(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),r=0,o=i.length;r<o;r++)e=i[r].style.zIndex,i[r]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!tt){fe(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var r=this._tiles[n];if(r.current&&r.loaded){var o=Math.min(1,(t-r.loaded)/200);fe(r.el,o),o<1?e=!0:(r.active?i=!0:this._onOpaqueTile(r),r.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(E(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this))}},_onOpaqueTile:l,_initContainer:function(){this._container||(this._container=ne("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)i=Number(i),this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(re(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var n=this._levels[t],r=this._map;return n||((n=this._levels[t]={}).el=ne("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,r.getCenter(),r.getZoom()),n.el.offsetWidth,this._onCreateLevel(n)),this._level=n,n}},_onUpdateLevel:l,_onRemoveLevel:l,_onCreateLevel:l,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)re(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,n){var r=Math.floor(t/2),o=Math.floor(e/2),s=i-1,a=new C(+r,+o);a.z=+s;var l=this._tileCoordsToKey(a),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),s>n&&this._retainParent(r,o,s,n))},_retainChildren:function(t,e,i,n){for(var r=2*t;r<2*t+2;r++)for(var o=2*e;o<2*e+2;o++){var s=new C(r,o);s.z=i+1;var a=this._tileCoordsToKey(s),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<n&&this._retainChildren(r,o,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,n){var r=Math.round(e);r=void 0!==this.options.maxZoom&&r>this.options.maxZoom||void 0!==this.options.minZoom&&r<this.options.minZoom?void 0:this._clampZoom(r);var o=this.options.updateWhenZooming&&r!==this._tileZoom;n&&!o||(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==r&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),r=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();gt?me(t.el,r,n):_e(t.el,r)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),r=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*n);return new D(r.subtract(o),r.add(o))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(n),o=r.getCenter(),s=[],a=this.options.keepBuffer,l=new D(r.getBottomLeft().subtract([a,-a]),r.getTopRight().add([a,-a]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var h=this._tiles[u].coords;h.z===this._tileZoom&&l.contains(new C(h.x,h.y))||(this._tiles[u].current=!1)}if(Math.abs(i-this._tileZoom)>1)this._setView(t,i);else{for(var c=r.min.y;c<=r.max.y;c++)for(var d=r.min.x;d<=r.max.x;d++){var f=new C(d,c);if(f.z=this._tileZoom,this._isValidTile(f)){var p=this._tiles[this._tileCoordsToKey(f)];p?p.current=!0:s.push(f)}}if(s.sort((function(t,e){return t.distanceTo(o)-e.distanceTo(o)})),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<s.length;d++)this._addTile(s[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return R(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),r=n.add(i);return[e.unproject(n,t.z),e.unproject(r,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new z(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new C(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(re(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ue(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=l,t.onmousemove=l,tt&&this.options.opacity<1&&fe(t,this.options.opacity),nt&&!rt&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),r=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),n(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&S(n(this._tileReady,this,t,null,o)),_e(o,i),this._tiles[r]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var r=this._tileCoordsToKey(t);(i=this._tiles[r])&&(i.loaded=+new Date,this._map._fadeAnimated?(fe(i.el,0),E(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(ue(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),tt||!this._map._fadeAnimated?S(this._pruneTiles,this):setTimeout(n(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new C(this._wrapX?a(t.x,this._wrapX):t.x,this._wrapY?a(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new D(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var on=rn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=d(this,e)).detectRetina&&Pt&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),nt||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Pe(i,"load",n(this._tileOnLoad,this,e,i)),Pe(i,"error",n(this._tileOnError,this,e,i)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i.alt="",i.setAttribute("role","presentation"),i.src=this.getTileUrl(t),i},getTileUrl:function(t){var i={r:Pt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(i.y=n),i["-y"]=n}return m(this._url,e(i,this.options))},_tileOnLoad:function(t,e){tt?setTimeout(n(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.getAttribute("src")!==n&&(e.src=n),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=l,e.onerror=l,e.complete||(e.src=y,re(e),delete this._tiles[t]))},_removeTile:function(t){var e=this._tiles[t];if(e)return st||e.el.setAttribute("src",y),rn.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(this._map&&(!i||i.getAttribute("src")!==y))return rn.prototype._tileReady.call(this,t,e,i)}});function sn(t,e){return new on(t,e)}var an=on.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,i){this._url=t;var n=e({},this.defaultWmsParams);for(var r in i)r in this.options||(n[r]=i[r]);var o=(i=d(this,i)).detectRetina&&Pt?2:1,s=this.getTileSize();n.width=s.x*o,n.height=s.y*o,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,on.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,n=N(i.project(e[0]),i.project(e[1])),r=n.min,o=n.max,s=(this._wmsVersion>=1.3&&this._crs===Si?[r.y,r.x,o.y,o.x]:[r.x,r.y,o.x,o.y]).join(","),a=on.prototype.getTileUrl.call(this,t);return a+f(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,i){return e(this.wmsParams,t),i||this.redraw(),this}});on.WMS=an,sn.wms=function(t,e){return new an(t,e)};var ln=Pi.extend({options:{padding:.1,tolerance:0},initialize:function(t){d(this,t),o(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&ue(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=ge(this._container),r=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),s=this._map.project(t,e).subtract(o),a=r.multiplyBy(-i).add(n).add(r).subtract(s);gt?me(this._container,a,i):_e(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new D(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),un=ln.extend({getEvents:function(){var t=ln.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ln.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Pe(t,"mousemove",this._onMouseMove,this),Pe(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Pe(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){E(this._redrawRequest),delete this._ctx,re(this._container),ke(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){ln.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=Pt?2:1;_e(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Pt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){ln.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[o(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[o(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,i,n=t.options.dashArray.split(/[, ]+/),r=[];for(i=0;i<n.length;i++){if(e=Number(n[i]),isNaN(e))return;r.push(e)}t.options._dashArray=r}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||S(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new D,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,r,o,s=t._parts,a=s.length,l=this._ctx;if(a){for(l.beginPath(),i=0;i<a;i++){for(n=0,r=s[i].length;n<r;n++)o=s[i][n],l[n?"lineTo":"moveTo"](o.x,o.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),r=(Math.max(Math.round(t._radiusY),1)||n)/n;1!==r&&(i.save(),i.scale(1,r)),i.beginPath(),i.arc(e.x,e.y/r,n,0,2*Math.PI,!1),1!==r&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),r=this._drawFirst;r;r=r.next)(e=r.layer).options.interactive&&e._containsPoint(n)&&("click"!==t.type&&"preclick"===t.type||!this._map._draggableMoved(e))&&(i=e);i&&(Ze(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(he(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var i,r,o=this._drawFirst;o;o=o.next)(i=o.layer).options.interactive&&i._containsPoint(e)&&(r=i);r!==this._hoveredLayer&&(this._handleMouseOut(t),r&&(ue(this._container,"leaflet-interactive"),this._fireEvent([r],t,"mouseover"),this._hoveredLayer=r)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(n((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;n&&(n.next=i,i?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function hn(t){return kt?new un(t):null}var cn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),dn={_initContainer:function(){this._container=ne("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ln.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=cn("shape");ue(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=cn("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[o(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;re(e),t.removeInteractiveTarget(e),delete this._layers[o(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,r=t._container;r.stroked=!!n.stroke,r.filled=!!n.fill,n.stroke?(e||(e=t._stroke=cn("stroke")),r.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=_(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(r.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=cn("fill")),r.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(r.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){se(t._container)},_bringToBack:function(t){ae(t._container)}},fn=It?cn:$,pn=ln.extend({getEvents:function(){var t=ln.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=fn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=fn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){re(this._container),ke(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){ln.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),_e(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=fn("path");t.options.className&&ue(e,t.options.className),t.options.interactive&&ue(e,"leaflet-interactive"),this._updateStyle(t),this._layers[o(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){re(t._path),t.removeInteractiveTarget(t._path),delete this._layers[o(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,J(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),n="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){se(t._path)},_bringToBack:function(t){ae(t._path)}});function mn(t){return Lt||It?new pn(t):null}It&&pn.include(dn),qe.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&hn(t)||mn(t)}});var _n=Ri.extend({initialize:function(t,e){Ri.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=R(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});pn.create=fn,pn.pointsToPath=J,Fi.geometryToLayer=Bi,Fi.coordsToLatLng=Ui,Fi.coordsToLatLngs=Zi,Fi.latLngToCoords=Yi,Fi.latLngsToCoords=Wi,Fi.getFeature=Hi,Fi.asFeature=Vi,qe.mergeOptions({boxZoom:!0});var gn=ti.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Pe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ke(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){re(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),qt(),ve(),this._startPoint=this._map.mouseEventToContainerPoint(t),Pe(document,{contextmenu:Re,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ne("div","leaflet-zoom-box",this._container),ue(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new D(this._point,this._startPoint),i=e.getSize();_e(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(re(this._box),he(this._container,"leaflet-crosshair")),Gt(),be(),ke(document,{contextmenu:Re,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(n(this._resetState,this),0);var e=new z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});qe.addInitHook("addHandler","boxZoom",gn),qe.mergeOptions({doubleClickZoom:!0});var yn=ti.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,r=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(r):e.setZoomAround(t.containerPoint,r)}});qe.addInitHook("addHandler","doubleClickZoom",yn),qe.mergeOptions({dragging:!0,inertia:!rt,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var vn=ti.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new si(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ue(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){he(this._map._container,"leaflet-grab"),he(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=R(this._map.options.maxBounds);this._offsetLimit=N(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,r=(n-e+i)%t+e-i,o=(n+e+i)%t-e-i,s=Math.abs(r+i)<Math.abs(o+i)?r:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{this._prunePositions(+new Date);var r=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,a=r.multiplyBy(s/o),l=a.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,l),h=a.multiplyBy(u/l),c=u/(i.inertiaDeceleration*s),d=h.multiplyBy(-c/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),S((function(){e.panBy(d,{duration:c,easeLinearity:s,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});qe.addInitHook("addHandler","dragging",vn),qe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var bn=ti.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Pe(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ke(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},r=this.keyCodes;for(e=0,i=r.left.length;e<i;e++)n[r.left[e]]=[-1*t,0];for(e=0,i=r.right.length;e<i;e++)n[r.right[e]]=[t,0];for(e=0,i=r.down.length;e<i;e++)n[r.down[e]]=[0,t];for(e=0,i=r.up.length;e<i;e++)n[r.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},r=this.keyCodes;for(e=0,i=r.zoomIn.length;e<i;e++)n[r.zoomIn[e]]=t;for(e=0,i=r.zoomOut.length;e<i;e++)n[r.zoomOut[e]]=-t},_addHooks:function(){Pe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ke(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys)n._panAnim&&n._panAnim._inProgress||(e=this._panKeys[i],t.shiftKey&&(e=M(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds));else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Re(t)}}});qe.addInitHook("addHandler","keyboard",bn),qe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var wn=ti.extend({addHooks:function(){Pe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ke(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=je(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var r=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(n(this._performZoom,this),r),Re(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),r=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,o=i?Math.ceil(r/i)*i:r,s=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});qe.addInitHook("addHandler","scrollWheelZoom",wn),qe.mergeOptions({tap:!0,tapTolerance:15});var xn=ti.extend({addHooks:function(){Pe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ke(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(ze(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new C(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&ue(i,"leaflet-active"),this._holdTimeout=setTimeout(n((function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))}),this),1e3),this._simulateEvent("mousedown",e),Pe(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),ke(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&he(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new C(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}});!Tt||xt&&!ht||qe.addInitHook("addHandler","tap",xn),qe.mergeOptions({touchZoom:Tt&&!rt,bounceAtZoomLimits:!0});var Tn=ti.extend({addHooks:function(){ue(this._map._container,"leaflet-touch-zoom"),Pe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){he(this._map._container,"leaflet-touch-zoom"),ke(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Pe(document,"touchmove",this._onTouchMove,this),Pe(document,"touchend",this._onTouchEnd,this),ze(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]),o=i.distanceTo(r)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var s=i._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===s.x&&0===s.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),E(this._animRequest);var a=n(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=S(a,this,!0),ze(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,E(this._animRequest),ke(document,"touchmove",this._onTouchMove,this),ke(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});qe.addInitHook("addHandler","touchZoom",Tn),qe.BoxZoom=gn,qe.DoubleClickZoom=yn,qe.Drag=vn,qe.Keyboard=bn,qe.ScrollWheelZoom=wn,qe.Tap=xn,qe.TouchZoom=Tn,t.version="1.7.1",t.Control=Ge,t.control=Ke,t.Browser=At,t.Evented=I,t.Mixin=ii,t.Util=P,t.Class=O,t.Handler=ti,t.extend=e,t.bind=n,t.stamp=o,t.setOptions=d,t.DomEvent=He,t.DomUtil=Ee,t.PosAnimation=Ve,t.Draggable=si,t.LineUtil=gi,t.PolyUtil=vi,t.Point=C,t.point=M,t.Bounds=D,t.bounds=N,t.Transformation=H,t.transformation=V,t.Projection=xi,t.LatLng=F,t.latLng=B,t.LatLngBounds=z,t.latLngBounds=R,t.CRS=U,t.GeoJSON=Fi,t.geoJSON=Gi,t.geoJson=Ki,t.Layer=Pi,t.LayerGroup=Oi,t.layerGroup=function(t,e){return new Oi(t,e)},t.FeatureGroup=ki,t.featureGroup=function(t,e){return new ki(t,e)},t.ImageOverlay=$i,t.imageOverlay=function(t,e,i){return new $i(t,e,i)},t.VideoOverlay=Ji,t.videoOverlay=function(t,e,i){return new Ji(t,e,i)},t.SVGOverlay=Xi,t.svgOverlay=function(t,e,i){return new Xi(t,e,i)},t.DivOverlay=Qi,t.Popup=tn,t.popup=function(t,e){return new tn(t,e)},t.Tooltip=en,t.tooltip=function(t,e){return new en(t,e)},t.Icon=Li,t.icon=function(t){return new Li(t)},t.DivIcon=nn,t.divIcon=function(t){return new nn(t)},t.Marker=Ai,t.marker=function(t,e){return new Ai(t,e)},t.TileLayer=on,t.tileLayer=sn,t.GridLayer=rn,t.gridLayer=function(t){return new rn(t)},t.SVG=pn,t.svg=mn,t.Renderer=ln,t.Canvas=un,t.canvas=hn,t.Path=Mi,t.CircleMarker=Di,t.circleMarker=function(t,e){return new Di(t,e)},t.Circle=Ni,t.circle=function(t,e,i){return new Ni(t,e,i)},t.Polyline=zi,t.polyline=function(t,e){return new zi(t,e)},t.Polygon=Ri,t.polygon=function(t,e){return new Ri(t,e)},t.Rectangle=_n,t.rectangle=function(t,e){return new _n(t,e)},t.Map=qe,t.map=function(t,e){return new qe(t,e)};var Sn=window.L;t.noConflict=function(){return window.L=Sn,this},window.L=t}));var Tt;function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Et(t){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ot(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function kt(t,e,i){return(kt=Ot()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&Pt(r,i.prototype),r}).apply(null,arguments)}function Lt(t){var e="function"==typeof Map?new Map:void 0;return Lt=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return kt(t,arguments,Et(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Pt(n,t)},Lt(t)}function It(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ct(t){return function(t){if(Array.isArray(t))return Mt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||At(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(t,e){if(t){if("string"==typeof t)return Mt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Mt(t,e):void 0}}function Mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}Tt=JSON.parse('{"name":"rfparty","version":"0.1.1","description":"","source":"src/index.html","scripts":{"test":"echo \\"Error: no test specified\\" && exit 1","start":"parcel src/index.html","build":"parcel build"},"dependencies":{"@abandonware/noble":"^1.9.2-15","debug":"^4.3.3","jsonpath-plus":"^6.0.1","last-eventemitter":"^1.1.1","leaflet":"^1.7.1","lokijs":"^1.5.12","moment":"^2.17.1","moment-timezone":"^0.5.11","node-wifi":"^2.0.16","pcap":"^3.1.0","xml-js":"^1.6.11"},"author":"","license":"Apache-2.0","devDependencies":{"http-server":"^14.1.0","parcel":"^2.2.1"}}');var Dt=Object.prototype.hasOwnProperty;function Nt(t,e){return(t=t.slice()).push(e),t}function zt(t,e){return(e=e.slice()).unshift(t),e}var Rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(r,Lt(Error));var e,i,n=(e=r,i=Ot(),function(){var t,n=Et(e);if(i){var r=Et(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return It(this,t)});function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=n.call(this,'JSONPath should not be called with "new" (it prevents return of (unwrapped) scalar values)')).avoidNew=!0,e.value=t,e.name="NewError",e}return r}();function Ft(t,e,i,n,r){if(!(this instanceof Ft))try{return new Ft(t,e,i,n,r)}catch(t){if(!t.avoidNew)throw t;return t.value}"string"==typeof t&&(r=n,n=i,i=e,e=t,t=null);var o=t&&"object"===St(t);if(t=t||{},this.json=t.json||i,this.path=t.path||e,this.resultType=t.resultType||"value",this.flatten=t.flatten||!1,this.wrap=!Dt.call(t,"wrap")||t.wrap,this.sandbox=t.sandbox||{},this.preventEval=t.preventEval||!1,this.parent=t.parent||null,this.parentProperty=t.parentProperty||null,this.callback=t.callback||n||null,this.otherTypeCallback=t.otherTypeCallback||r||function(){throw new TypeError("You must supply an otherTypeCallback callback option with the @other() operator.")},!1!==t.autostart){var s={path:o?t.path:e};o?"json"in t&&(s.json=t.json):s.json=i;var a=this.evaluate(s);if(!a||"object"!==St(a))throw new Rt(a);return a}}Ft.prototype.evaluate=function(t,e,i,n){var r=this,o=this.parent,s=this.parentProperty,a=this.flatten,l=this.wrap;if(this.currResultType=this.resultType,this.currPreventEval=this.preventEval,this.currSandbox=this.sandbox,i=i||this.callback,this.currOtherTypeCallback=n||this.otherTypeCallback,e=e||this.json,(t=t||this.path)&&"object"===St(t)&&!Array.isArray(t)){if(!t.path&&""!==t.path)throw new TypeError('You must supply a "path" property when providing an object argument to JSONPath.evaluate().');if(!Dt.call(t,"json"))throw new TypeError('You must supply a "json" property when providing an object argument to JSONPath.evaluate().');e=t.json,a=Dt.call(t,"flatten")?t.flatten:a,this.currResultType=Dt.call(t,"resultType")?t.resultType:this.currResultType,this.currSandbox=Dt.call(t,"sandbox")?t.sandbox:this.currSandbox,l=Dt.call(t,"wrap")?t.wrap:l,this.currPreventEval=Dt.call(t,"preventEval")?t.preventEval:this.currPreventEval,i=Dt.call(t,"callback")?t.callback:i,this.currOtherTypeCallback=Dt.call(t,"otherTypeCallback")?t.otherTypeCallback:this.currOtherTypeCallback,o=Dt.call(t,"parent")?t.parent:o,s=Dt.call(t,"parentProperty")?t.parentProperty:s,t=t.path}if(o=o||null,s=s||null,Array.isArray(t)&&(t=Ft.toPathString(t)),(t||""===t)&&e){var u=Ft.toPathArray(t);"$"===u[0]&&u.length>1&&u.shift(),this._hasParentSelector=null;var h=this._trace(u,e,["$"],o,s,i).filter((function(t){return t&&!t.isParentSelector}));return h.length?l||1!==h.length||h[0].hasArrExpr?h.reduce((function(t,e){var i=r._getPreferredOutput(e);return a&&Array.isArray(i)?t=t.concat(i):t.push(i),t}),[]):this._getPreferredOutput(h[0]):l?[]:void 0}},Ft.prototype._getPreferredOutput=function(t){var e=this.currResultType;switch(e){case"all":var i=Array.isArray(t.path)?t.path:Ft.toPathArray(t.path);return t.pointer=Ft.toPointer(i),t.path="string"==typeof t.path?t.path:Ft.toPathString(t.path),t;case"value":case"parent":case"parentProperty":return t[e];case"path":return Ft.toPathString(t[e]);case"pointer":return Ft.toPointer(t.path);default:throw new TypeError("Unknown result type")}},Ft.prototype._handleCallback=function(t,e,i){if(e){var n=this._getPreferredOutput(t);t.path="string"==typeof t.path?t.path:Ft.toPathString(t.path),e(n,i,t)}},Ft.prototype._trace=function(t,e,i,n,r,o,s,a){var l,u=this;if(!t.length)return l={path:i,value:e,parent:n,parentProperty:r,hasArrExpr:s},this._handleCallback(l,o,"value"),l;var h=t[0],c=t.slice(1),d=[];function f(t){Array.isArray(t)?t.forEach((function(t){d.push(t)})):d.push(t)}if(("string"!=typeof h||a)&&e&&Dt.call(e,h))f(this._trace(c,e[h],Nt(i,h),e,h,o,s));else if("*"===h)this._walk(h,c,e,i,n,r,o,(function(t,e,i,n,r,o,s,a){f(u._trace(zt(t,i),n,r,o,s,a,!0,!0))}));else if(".."===h)f(this._trace(c,e,i,n,r,o,s)),this._walk(h,c,e,i,n,r,o,(function(t,e,i,n,r,o,s,a){"object"===St(n[t])&&f(u._trace(zt(e,i),n[t],Nt(r,t),n,t,a,!0))}));else{if("^"===h)return this._hasParentSelector=!0,{path:i.slice(0,-1),expr:c,isParentSelector:!0};if("~"===h)return l={path:Nt(i,h),value:r,parent:n,parentProperty:null},this._handleCallback(l,o,"property"),l;if("$"===h)f(this._trace(c,e,i,null,null,o,s));else if(/^(\x2D?[0-9]*):(\x2D?[0-9]*):?([0-9]*)$/.test(h))f(this._slice(h,c,e,i,n,r,o));else if(0===h.indexOf("?(")){if(this.currPreventEval)throw new Error("Eval [?(expr)] prevented in JSONPath expression.");this._walk(h,c,e,i,n,r,o,(function(t,e,i,n,r,o,s,a){u._eval(e.replace(/^\?\(((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)\)$/,"$1"),n[t],t,r,o,s)&&f(u._trace(zt(t,i),n,r,o,s,a,!0))}))}else if("("===h[0]){if(this.currPreventEval)throw new Error("Eval [(expr)] prevented in JSONPath expression.");f(this._trace(zt(this._eval(h,e,i[i.length-1],i.slice(0,-1),n,r),c),e,i,n,r,o,s))}else if("@"===h[0]){var p=!1,m=h.slice(1,-2);switch(m){case"scalar":e&&["object","function"].includes(St(e))||(p=!0);break;case"boolean":case"string":case"undefined":case"function":St(e)===m&&(p=!0);break;case"integer":!Number.isFinite(e)||e%1||(p=!0);break;case"number":Number.isFinite(e)&&(p=!0);break;case"nonFinite":"number"!=typeof e||Number.isFinite(e)||(p=!0);break;case"object":e&&St(e)===m&&(p=!0);break;case"array":Array.isArray(e)&&(p=!0);break;case"other":p=this.currOtherTypeCallback(e,i,n,r);break;case"null":null===e&&(p=!0);break;default:throw new TypeError("Unknown value type "+m)}if(p)return l={path:i,value:e,parent:n,parentProperty:r},this._handleCallback(l,o,"value"),l}else if("`"===h[0]&&e&&Dt.call(e,h.slice(1))){var _=h.slice(1);f(this._trace(c,e[_],Nt(i,_),e,_,o,s,!0))}else if(h.includes(",")){var g,y=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=At(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw o}}}}(h.split(","));try{for(y.s();!(g=y.n()).done;){var v=g.value;f(this._trace(zt(v,c),e,i,n,r,o,!0))}}catch(t){y.e(t)}finally{y.f()}}else!a&&e&&Dt.call(e,h)&&f(this._trace(c,e[h],Nt(i,h),e,h,o,s,!0))}if(this._hasParentSelector)for(var b=0;b<d.length;b++){var w=d[b];if(w&&w.isParentSelector){var x=this._trace(w.expr,e,w.path,n,r,o,s);if(Array.isArray(x)){d[b]=x[0];for(var T=x.length,S=1;S<T;S++)b++,d.splice(b,0,x[S])}else d[b]=x}}return d},Ft.prototype._walk=function(t,e,i,n,r,o,s,a){if(Array.isArray(i))for(var l=i.length,u=0;u<l;u++)a(u,t,e,i,n,r,o,s);else i&&"object"===St(i)&&Object.keys(i).forEach((function(l){a(l,t,e,i,n,r,o,s)}))},Ft.prototype._slice=function(t,e,i,n,r,o,s){if(Array.isArray(i)){var a=i.length,l=t.split(":"),u=l[2]&&Number.parseInt(l[2])||1,h=l[0]&&Number.parseInt(l[0])||0,c=l[1]&&Number.parseInt(l[1])||a;h=h<0?Math.max(0,h+a):Math.min(a,h),c=c<0?Math.max(0,c+a):Math.min(a,c);for(var d=[],f=h;f<c;f+=u){this._trace(zt(f,e),i,n,r,o,s,!0).forEach((function(t){d.push(t)}))}return d}},Ft.prototype._eval=function(t,e,i,n,r,o){t.includes("@parentProperty")&&(this.currSandbox._$_parentProperty=o,t=t.replace(/@parentProperty/g,"_$_parentProperty")),t.includes("@parent")&&(this.currSandbox._$_parent=r,t=t.replace(/@parent/g,"_$_parent")),t.includes("@property")&&(this.currSandbox._$_property=i,t=t.replace(/@property/g,"_$_property")),t.includes("@path")&&(this.currSandbox._$_path=Ft.toPathString(n.concat([i])),t=t.replace(/@path/g,"_$_path")),t.includes("@root")&&(this.currSandbox._$_root=this.json,t=t.replace(/@root/g,"_$_root")),/@([\t-\r \)\.\[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])/.test(t)&&(this.currSandbox._$_v=e,t=t.replace(/@([\t-\r \)\.\[\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])/g,"_$_v$1"));try{return this.vm.runInNewContext(t,this.currSandbox)}catch(e){throw console.log(e),new Error("jsonPath: "+e.message+": "+t)}},Ft.cache={},Ft.toPathString=function(t){for(var e=t,i=e.length,n="$",r=1;r<i;r++)/^(~|\^|@(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\(\))$/.test(e[r])||(n+=/^[\*0-9]+$/.test(e[r])?"["+e[r]+"]":"['"+e[r]+"']");return n},Ft.toPointer=function(t){for(var e=t,i=e.length,n="",r=1;r<i;r++)/^(~|\^|@(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\(\))$/.test(e[r])||(n+="/"+e[r].toString().replace(/~/g,"~0").replace(/\//g,"~1"));return n},Ft.toPathArray=function(t){var e=Ft.cache;if(e[t])return e[t].concat();var i=[],n=t.replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\(\)/g,";$&;").replace(/['\[](\??\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\))['\]]/g,(function(t,e){return"[#"+(i.push(e)-1)+"]"})).replace(/\[["']((?:(?!['\]])[\s\S])*)["']\]/g,(function(t,e){return"['"+e.replace(/\./g,"%@%").replace(/~/g,"%%@@%%")+"']"})).replace(/~/g,";~;").replace(/["']?\.["']?(?!(?:(?!\[)[\s\S])*\])|\[["']?/g,";").replace(/%@%/g,".").replace(/%%@@%%/g,"~").replace(/(?:;)?(\^+)(?:;)?/g,(function(t,e){return";"+e.split("").join(";")+";"})).replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").split(";").map((function(t){var e=t.match(/#([0-9]+)/);return e&&e[1]?i[e[1]]:t}));return e[t]=n,e[t].concat()};Ft.prototype.vm={runInNewContext:function(t,e){var i=Object.keys(e),n=[];!function(t,e,i){for(var n=t.length,r=0;r<n;r++)i(t[r])&&e.push(t.splice(r--,1)[0])}(i,n,(function(t){return"function"==typeof e[t]}));var r=i.map((function(t,i){return e[t]})),o=n.reduce((function(t,i){var n=e[i].toString();return/function/.test(n)||(n="function "+n),"var "+i+"="+n+";"+t}),"");/(["'])use strict\1/.test(t=o+t)||i.includes("arguments")||(t="var arguments = undefined;"+t);var s=(t=t.replace(/;[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*$/,"")).lastIndexOf(";"),a=s>-1?t.slice(0,s+1)+" return "+t.slice(s+1):" return "+t;return kt(Function,Ct(i).concat([a])).apply(void 0,Ct(r))}};var Bt,jt=Ft;Bt=function(t,e,i){var n=e.split("."),r=t;try{for(var o=0;o<n.length;o++)r=r[n[o]];null==r&&(r=i)}catch(t){r=null!=i?i:null}return r};var Ut,Zt,Yt={};Ut=Yt,Zt=function(){return function(){var e=Object.prototype.hasOwnProperty;function i(t){var e,r;if(Array.isArray(t)){for(r=0;r<t.length;r++)i(t[r]);n(t)}else if(null!==t&&"object"==typeof t){for(e in t)t.hasOwnProperty(e)&&i(t[e]);n(t)}}function n(t){Object.isFrozen(t)||Object.freeze(t)}function o(t){return Object.isFrozen(t)?y(t,"shallow"):t}var s={copyProperties:function(t,e){var i;for(i in t)e[i]=t[i]},resolveTransformObject:function(t,e,i){var n,r;if("number"!=typeof i&&(i=0),++i>=10)return t;for(n in t)"string"==typeof t[n]&&0===t[n].indexOf("[%lktxp]")?(r=t[n].substring(8),e.hasOwnProperty(r)&&(t[n]=e[r])):"object"==typeof t[n]&&(t[n]=s.resolveTransformObject(t[n],e,i));return t},resolveTransformParams:function(t,e){var i,n,r=[];if(void 0===e)return t;for(i=0;i<t.length;i++)n=y(t[i],"shallow-recurse-objects"),r.push(s.resolveTransformObject(n,e));return r},getIn:function(t,e,i){if(null!=t){if(!i)return t[e];if("string"==typeof e&&(e=e.split(".")),!Array.isArray(e))throw new Error("path must be a string or array. Found "+typeof e);for(var n=0,r=e.length;null!=t&&n<r;)t=t[e[n++]];return n&&n==r?t:void 0}}},l={aeq:u,lt:h,gt:c};function u(t,e){var i,n,r,o;if(t===e)return!0;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=t==t?9:0}switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}if(9!==r||9!==o)return r===o}return i=Number(t),n=Number(e),i==i||n==n?i===n:(i=t.toString())==(n=e.toString())}function h(t,e,i){var n,r,o,s;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}if(9!==o||9!==s)return o===s?i:o<s}return n=Number(t),r=Number(e),n==n&&r==r?n<r||!(n>r)&&i:n==n&&r!=r||(r!=r||n==n)&&(t<e||!(t>e)&&(t==e?i:(n=t.toString())<(r=e.toString())||n==r&&i))}function c(t,e,i){var n,r,o,s;if(!t||!e||!0===t||!0===e||t!=t||e!=e){switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}switch(e){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=e==e?9:0}if(9!==o||9!==s)return o===s?i:o>s}return n=Number(t),r=Number(e),n==n&&r==r?n>r||!(n<r)&&i:(n!=n||r==r)&&(r==r&&n!=n||t>e||!(t<e)&&(t==e?i:(n=t.toString())>(r=e.toString())||n==r&&i))}function d(t,e,i){return l.aeq(t,e)?0:l.lt(t,e,!1)?i?1:-1:l.gt(t,e,!1)?i?-1:1:0}function f(t,e,i,n,r,o){var s,a=o||0,l=e[a],u=!1;if("object"==typeof t&&l in t&&(s=t[l]),a+1>=e.length)u=i(s,n,r);else if(Array.isArray(s))for(var h=0,c=s.length;h<c&&!0!==(u=f(s[h],e,i,n,r,a+1));h+=1);else u=f(s,e,i,n,r,a+1);return u}function p(t){return"string"==typeof t||Array.isArray(t)?function(e){return-1!==t.indexOf(e)}:"object"==typeof t&&null!==t?function(i){return e.call(t,i)}:null}function m(t,i,n){for(var r in i)if(e.call(i,r))return _[r](t,i[r],n);return!1}var _={$eq:function(t,e){return t===e},$aeq:function(t,e){return t==e},$ne:function(t,e){return e!=e?t==t:t!==e},$dteq:function(t,e){return l.aeq(t,e)},$gt:function(t,e){return l.gt(t,e,!1)},$gte:function(t,e){return l.gt(t,e,!0)},$lt:function(t,e){return l.lt(t,e,!1)},$lte:function(t,e){return l.lt(t,e,!0)},$jgt:function(t,e){return t>e},$jgte:function(t,e){return t>=e},$jlt:function(t,e){return t<e},$jlte:function(t,e){return t<=e},$between:function(t,e){return null!=t&&l.gt(t,e[0],!0)&&l.lt(t,e[1],!0)},$jbetween:function(t,e){return null!=t&&t>=e[0]&&t<=e[1]},$in:function(t,e){return-1!==e.indexOf(t)},$inSet:function(t,e){return e.has(t)},$nin:function(t,e){return-1===e.indexOf(t)},$keyin:function(t,e){return t in e},$nkeyin:function(t,e){return!(t in e)},$definedin:function(t,e){return void 0!==e[t]},$undefinedin:function(t,e){return void 0===e[t]},$regex:function(t,e){return e.test(t)},$containsString:function(t,e){return"string"==typeof t&&-1!==t.indexOf(e)},$containsNone:function(t,e){return!_.$containsAny(t,e)},$containsAny:function(t,e){var i=p(t);return null!==i&&(Array.isArray(e)?e.some(i):i(e))},$contains:function(t,e){var i=p(t);return null!==i&&(Array.isArray(e)?e.every(i):i(e))},$elemMatch:function(t,e){return!!Array.isArray(t)&&t.some((function(t){return Object.keys(e).every((function(i){var n=e[i];return"object"==typeof n&&n||(n={$eq:n}),-1!==i.indexOf(".")?f(t,i.split("."),m,e[i],t):m(t[i],n,t)}))}))},$type:function(t,e,i){var n=typeof t;return"object"===n&&(Array.isArray(t)?n="array":t instanceof Date&&(n="date")),"object"!=typeof e?n===e:m(n,e,i)},$finite:function(t,e){return e===isFinite(t)},$size:function(t,e,i){return!!Array.isArray(t)&&("object"!=typeof e?t.length===e:m(t.length,e,i))},$len:function(t,e,i){return"string"==typeof t&&("object"!=typeof e?t.length===e:m(t.length,e,i))},$where:function(t,e){return!0===e(t)},$not:function(t,e,i){return!m(t,e,i)},$and:function(t,e,i){for(var n=0,r=e.length;n<r;n+=1)if(!m(t,e[n],i))return!1;return!0},$or:function(t,e,i){for(var n=0,r=e.length;n<r;n+=1)if(m(t,e[n],i))return!0;return!1},$exists:function(t,e){return e?void 0!==t:void 0===t}};["$eq","$aeq","$ne","$dteq","$gt","$gte","$lt","$lte","$jgt","$jgte","$jlt","$jlte","$type"].forEach((function(t){var e=_[t];_["$"+t]=function(t,i,n){if("string"==typeof i)return e(t,n[i]);if("function"==typeof i)return e(t,i(n));throw new Error("Invalid argument to $$ matcher")}}));var g={$eq:_.$eq,$aeq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};function y(t,e){if(null==t)return null;var i;switch(e||"parse-stringify"){case"parse-stringify":i=JSON.parse(JSON.stringify(t));break;case"jquery-extend-deep":i=jQuery.extend(!0,{},t);break;case"shallow":i=Object.create(t.constructor.prototype),Object.keys(t).map((function(e){i[e]=t[e]}));break;case"shallow-assign":i=Object.create(t.constructor.prototype),Object.assign(i,t);break;case"shallow-recurse-objects":i=y(t,"shallow"),Object.keys(t).forEach((function(e){"object"==typeof t[e]&&"Object"===t[e].constructor.name?i[e]=y(t[e],"shallow-recurse-objects"):Array.isArray(t[e])&&(i[e]=function(t,e){if("parse-stringify"==e)return y(t,e);for(var i=[],n=0,r=t.length;n<r;n++)i[n]=y(t[n],e);return i}(t[e],"shallow-recurse-objects"))}))}return i}function v(){try{return window&&void 0!==window.localStorage&&null!==window.localStorage}catch(t){return!1}}function b(){}function w(e,i){this.filename=e||"loki.db",this.collections=[],this.databaseVersion=1.5,this.engineVersion=1.5,this.autosave=!1,this.autosaveInterval=5e3,this.autosaveHandle=null,this.throttledSaves=!0,this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,this.throttledSavePending=!1,this.throttledCallbacks=[],this.verbose=!(!i||!i.hasOwnProperty("verbose"))&&i.verbose,this.events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]},i&&i.hasOwnProperty("env")?this.ENV=i.env:this.ENV=void 0!==t&&(t.android||t.NSObject)?"NATIVESCRIPT":"undefined"==typeof window||void 0!==t&&t.window&&void 0!==a?"NODEJS":"undefined"!=typeof document?-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER":"CORDOVA","undefined"===this.ENV&&(this.ENV="NODEJS"),this.configureOptions(i,!0),this.on("init",this.clearChanges)}function x(t){this.hashStore={},this.options=t||{},this.options.hasOwnProperty("asyncResponses")||(this.options.asyncResponses=!1),this.options.hasOwnProperty("asyncTimeout")||(this.options.asyncTimeout=50)}function T(t,e){if(this.mode="reference",this.adapter=null,this.options=e||{},this.dbref=null,this.dbname="",this.pageIterator={},!t)throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");if("reference"===t.mode)throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");this.adapter=t,this.options.hasOwnProperty("paging")||(this.options.paging=!1),this.options.hasOwnProperty("pageSize")||(this.options.pageSize=26214400),this.options.hasOwnProperty("delimiter")||(this.options.delimiter="$<\n")}function S(){try{this.fs=r("kjyEk")}catch(t){this.fs=null}}function E(){}function P(t,e){return e=e||{},this.collection=t,this.filteredrows=[],this.filterInitialized=!1,this}function O(t,e){if("$regex"===t)Array.isArray(e)?e=new RegExp(e[0],e[1]):e instanceof RegExp||(e=new RegExp(e));else if("object"==typeof e)for(var i in e)"$regex"!==i&&"object"!=typeof e[i]||(e[i]=O(i,e[i]));return e}function k(t,e,i){this.collection=t,this.name=e,this.rebuildPending=!1,this.options=i||{},this.options.hasOwnProperty("persistent")||(this.options.persistent=!1),this.options.hasOwnProperty("sortPriority")||(this.options.sortPriority="passive"),this.options.hasOwnProperty("minRebuildInterval")||(this.options.minRebuildInterval=1),this.resultset=new P(t),this.resultdata=[],this.resultsdirty=!1,this.cachedresultset=null,this.filterPipeline=[],this.collection.disableFreeze||Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,this.events={rebuild:[],filter:[],sort:[]}}function L(t,i){this.name=t,this.data=[],this.idIndex=null,this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[],this.transforms={},this.objType=t,this.dirty=!0,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null;var n=this;(i=i||{}).hasOwnProperty("unique")&&(Array.isArray(i.unique)||(i.unique=[i.unique]),i.unique.forEach((function(t){n.uniqueNames.push(t)}))),i.hasOwnProperty("exact")&&i.exact.forEach((function(t){n.constraints.exact[t]=new j(t)})),this.adaptiveBinaryIndices=!i.hasOwnProperty("adaptiveBinaryIndices")||i.adaptiveBinaryIndices,this.transactional=!!i.hasOwnProperty("transactional")&&i.transactional,this.cloneObjects=!!i.hasOwnProperty("clone")&&i.clone,this.cloneMethod=i.hasOwnProperty("cloneMethod")?i.cloneMethod:"parse-stringify",this.asyncListeners=!!i.hasOwnProperty("asyncListeners")&&i.asyncListeners,this.disableMeta=!!i.hasOwnProperty("disableMeta")&&i.disableMeta,this.disableChangesApi=!i.hasOwnProperty("disableChangesApi")||i.disableChangesApi,this.disableDeltaChangesApi=!i.hasOwnProperty("disableDeltaChangesApi")||i.disableDeltaChangesApi,this.disableChangesApi&&(this.disableDeltaChangesApi=!0),this.autoupdate=!!i.hasOwnProperty("autoupdate")&&i.autoupdate,this.serializableIndices=!i.hasOwnProperty("serializableIndices")||i.serializableIndices,this.disableFreeze=!i.hasOwnProperty("disableFreeze")||i.disableFreeze,this.ttl={age:null,ttlInterval:null,daemon:null},this.setTTL(i.ttl||-1,i.ttlInterval),this.maxId=0,this.DynamicViews=[],this.events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this.changes=[],this.dirtyIds=[];var r=[];if(i&&i.indices)if("[object Array]"===Object.prototype.toString.call(i.indices))r=i.indices;else{if("string"!=typeof i.indices)throw new TypeError("Indices needs to be a string or an array of strings");r=[i.indices]}for(var o=0;o<r.length;o++)this.ensureIndex(r[o]);function s(t,e){var i=null!==e&&"object"==typeof e?Object.keys(e):null;if(i&&i.length&&["string","boolean","number"].indexOf(typeof e)<0){for(var r={},o=0;o<i.length;o++){var a=i[o];if(e.hasOwnProperty(a))if(!t.hasOwnProperty(a)||n.uniqueNames.indexOf(a)>=0||"$loki"==a||"meta"==a)r[a]=e[a];else{var l=s(t[a],e[a]);void 0!==l&&l!={}&&(r[a]=l)}}return 0===Object.keys(r).length?void 0:r}return t===e?void 0:e}function a(){n.changes=[]}this.observerCallback=function(t){var i="function"==typeof Set?new Set:[];i.add||(i.add=function(t){return-1===this.indexOf(t)&&this.push(t),this}),t.forEach((function(t){i.add(t.object)})),i.forEach((function(t){if(!e.call(t,"$loki"))return n.removeAutoUpdateObserver(t);try{n.update(t)}catch(t){}}))},this.getChangeDelta=function(t,e){return e?s(e,t):JSON.parse(JSON.stringify(t))},this.getObjectDelta=s,this.getChanges=function(){return n.changes},this.flushChanges=a,this.setChangesApi=function(t){n.disableChangesApi=!t,t||(n.disableDeltaChangesApi=!1)},this.on("delete",(function(t){n.disableChangesApi||n.createChange(n.name,"R",t)})),this.on("warning",(function(t){n.lokiConsoleWrapper.warn(t)})),a()}function I(t){return-1!==t.indexOf(".")}function C(t){return parseFloat(t,10)}function A(t,e){return t+e}function M(t,e){return t-e}function D(t){return t.reduce(A,0)/t.length}function N(t,e,i){if(!1===i)return t[e];for(var n=e.split("."),r=t;n.length>0;)r=r[n.shift()];return r}function z(t,e,i){for(var n,r,o=0,s=t.length;o<s;){if(r=o+s>>1,0===(n=i.apply(null,[e,t[r]])))return{found:!0,index:r};n<0?s=r:o=r+1}return{found:!1,index:s}}function R(t){return function(e,i){return z(e,i,t)}}function F(){}function B(t){this.field=t,this.keyMap=Object.create(null),this.lokiMap=Object.create(null)}function j(t){this.index=Object.create(null),this.field=t}return b.prototype.events={},b.prototype.asyncListeners=!1,b.prototype.on=function(t,e){var i,n=this;return Array.isArray(t)?(t.forEach((function(t){n.on(t,e)})),e):((i=this.events[t])||(i=this.events[t]=[]),i.push(e),e)},b.prototype.emit=function(t){var e,i=this;if(!t||!this.events[t])throw new Error("No event "+t+" defined");this.events[t].length&&(e=Array.prototype.slice.call(arguments,1),this.events[t].forEach((function(t){i.asyncListeners?setTimeout((function(){t.apply(i,e)}),1):t.apply(i,e)})))},b.prototype.addListener=b.prototype.on,b.prototype.removeListener=function(t,e){var i=this;if(Array.isArray(t))t.forEach((function(t){i.removeListener(t,e)}));else if(this.events[t]){var n=this.events[t];n.splice(n.indexOf(e),1)}},w.prototype=new b,w.prototype.constructor=w,w.prototype.getIndexedAdapter=function(){return r("k03Ww")},w.prototype.configureOptions=function(t,e){var i={fs:S,localStorage:E,memory:x};if(this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,void 0!==t){if(this.options=t,this.options.hasOwnProperty("persistenceMethod")&&"function"==typeof i[t.persistenceMethod]&&(this.persistenceMethod=t.persistenceMethod,this.persistenceAdapter=new i[t.persistenceMethod]),this.options.hasOwnProperty("adapter")&&(this.persistenceMethod="adapter",this.persistenceAdapter=t.adapter,this.options.adapter=null,this.isIncremental="incremental"===this.persistenceAdapter.mode),t.autoload&&e){var n=this;setTimeout((function(){n.loadDatabase(t,t.autoloadCallback)}),1)}this.options.hasOwnProperty("autosaveInterval")&&(this.autosaveDisable(),this.autosaveInterval=parseInt(this.options.autosaveInterval,10)),this.options.hasOwnProperty("autosave")&&this.options.autosave&&(this.autosaveDisable(),this.autosave=!0,this.options.hasOwnProperty("autosaveCallback")?this.autosaveEnable(t,t.autosaveCallback):this.autosaveEnable()),this.options.hasOwnProperty("throttledSaves")&&(this.throttledSaves=this.options.throttledSaves)}this.options.hasOwnProperty("serializationMethod")||(this.options.serializationMethod="normal"),this.options.hasOwnProperty("destructureDelimiter")||(this.options.destructureDelimiter="$<\n"),null===this.persistenceAdapter&&(this.persistenceMethod={NODEJS:"fs",BROWSER:"localStorage",CORDOVA:"localStorage",MEMORY:"memory"}[this.ENV],this.persistenceMethod&&(this.persistenceAdapter=new i[this.persistenceMethod]))},w.prototype.copy=function(t){var e,i,n=new w(this.filename,{env:"NA"});if(t=t||{},n.loadJSONObject(this,{retainDirtyFlags:!0}),t.hasOwnProperty("removeNonSerializable")&&!0===t.removeNonSerializable)for(n.autosaveHandle=null,n.persistenceAdapter=null,e=n.collections.length,i=0;i<e;i++)n.collections[i].constraints=null,n.collections[i].ttl=null;return n},w.prototype.addCollection=function(t,e){var i,n=this.collections.length;if(e&&!0===e.disableMeta){if(!1===e.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===e.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof e.ttl&&e.ttl>0)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}for(i=0;i<n;i+=1)if(this.collections[i].name===t)return this.collections[i];var r=new L(t,e);return r.isIncremental=this.isIncremental,this.collections.push(r),this.verbose&&(r.lokiConsoleWrapper=console),r},w.prototype.loadCollection=function(t){if(!t.name)throw new Error("Collection must have a name property to be loaded");this.collections.push(t)},w.prototype.getCollection=function(t){var e,i=this.collections.length;for(e=0;e<i;e+=1)if(this.collections[e].name===t)return this.collections[e];return this.emit("warning","collection "+t+" not found"),null},w.prototype.renameCollection=function(t,e){var i=this.getCollection(t);return i&&(i.name=e),i},w.prototype.listCollections=function(){for(var t=this.collections.length,e=[];t--;)e.push({name:this.collections[t].name,type:this.collections[t].objType,count:this.collections[t].data.length});return e},w.prototype.removeCollection=function(t){var e,i=this.collections.length;for(e=0;e<i;e+=1)if(this.collections[e].name===t){var n=new L(t,{}),r=this.collections[e];for(var o in r)r.hasOwnProperty(o)&&n.hasOwnProperty(o)&&(r[o]=n[o]);return void this.collections.splice(e,1)}},w.prototype.getName=function(){return this.name},w.prototype.serializeReplacer=function(t,e){switch(t){case"autosaveHandle":case"persistenceAdapter":case"constraints":case"ttl":case"lokiConsoleWrapper":return null;case"throttledSavePending":case"throttledCallbacks":return;default:return e}},w.prototype.serialize=function(t){switch((t=t||{}).hasOwnProperty("serializationMethod")||(t.serializationMethod=this.options.serializationMethod),t.serializationMethod){case"normal":default:return JSON.stringify(this,this.serializeReplacer);case"pretty":return JSON.stringify(this,this.serializeReplacer,2);case"destructured":return this.serializeDestructured()}},w.prototype.toJson=w.prototype.serialize,w.prototype.serializeDestructured=function(t){var e,i,n,r,o,s=[];if((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),!0===t.partitioned&&t.hasOwnProperty("partition")&&t.partition>=0)return this.serializeCollection({delimited:t.delimited,delimiter:t.delimiter,collectionIndex:t.partition});for((o=new w(this.filename)).loadJSONObject(this),e=0;e<o.collections.length;e++)o.collections[e].data=[];if(!0===t.partitioned&&-1===t.partition)return o.serialize({serializationMethod:"normal"});for(s.push(o.serialize({serializationMethod:"normal"})),o=null,e=0;e<this.collections.length;e++)if(n=this.serializeCollection({delimited:t.delimited,delimiter:t.delimiter,collectionIndex:e}),!1===t.partitioned&&!1===t.delimited){if(!Array.isArray(n))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(r=n.length,i=0;i<r;i++)s.push(n[i]),n[i]=null;s.push("")}else s.push(n);return t.partitioned?(t.delimited,s):t.delimited?(s.push(""),s.join(t.delimiter)):(s.push(""),s)},w.prototype.serializeCollection=function(t){var e,i,n=[];if((t=t||{}).hasOwnProperty("delimited")||(t.delimited=!0),!t.hasOwnProperty("collectionIndex"))throw new Error("serializeCollection called without 'collectionIndex' option");for(e=this.collections[t.collectionIndex].data.length,n=[],i=0;i<e;i++)n.push(JSON.stringify(this.collections[t.collectionIndex].data[i]));return t.delimited?(n.push(""),n.join(t.delimiter)):n},w.prototype.deserializeDestructured=function(t,e){var i,n,r,o=[],s=0,a=1,l=!1;if((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),e.partitioned){if(e.hasOwnProperty("partition"))return-1===e.partition?i=JSON.parse(t[0]):this.deserializeCollection(t[e.partition+1],e);for(n=(i=JSON.parse(t[0])).collections.length,s=0;s<n;s++)i.collections[s].data=this.deserializeCollection(t[s+1],e);return i}if(e.delimited){if(o=t.split(e.delimiter),t=null,0===o.length)return null}else o=t;for(n=(i=JSON.parse(o[0])).collections.length,o[0]=null;!l;)o[a],""===o[a]?++s>n&&(l=!0):(r=JSON.parse(o[a]),i.collections[s].data.push(r)),o[a++]=null;return i},w.prototype.deserializeCollection=function(t,e){var i,n,r=[];for((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),e.delimited?(r=t.split(e.delimiter)).pop():r=t,n=r.length,i=0;i<n;i++)r[i]=JSON.parse(r[i]);return r},w.prototype.loadJSON=function(t,e){var i;if(0===t.length)i={};else switch(this.options.serializationMethod){case"normal":case"pretty":default:i=JSON.parse(t);break;case"destructured":i=this.deserializeDestructured(t)}this.loadJSONObject(i,e)},w.prototype.loadJSONObject=function(t,e){var n,r,o,a,l,u,h=0,c=t.collections?t.collections.length:0;function d(t){var i,n=e[t.name];return n.proto?(i=n.inflate||s.copyProperties,function(t){var e=new n.proto;return i(t,e),e}):n.inflate}for(this.name=t.name,t.hasOwnProperty("throttledSaves")&&e&&!e.hasOwnProperty("throttledSaves")&&(this.throttledSaves=t.throttledSaves),this.collections=[];h<c;h+=1){if(n=t.collections[h],(r=this.addCollection(n.name,{disableChangesApi:n.disableChangesApi,disableDeltaChangesApi:n.disableDeltaChangesApi,disableMeta:n.disableMeta,disableFreeze:!n.hasOwnProperty("disableFreeze")||n.disableFreeze})).adaptiveBinaryIndices=!!n.hasOwnProperty("adaptiveBinaryIndices")&&!0===n.adaptiveBinaryIndices,r.transactional=n.transactional,r.asyncListeners=n.asyncListeners,r.cloneObjects=n.cloneObjects,r.cloneMethod=n.cloneMethod||"parse-stringify",r.autoupdate=n.autoupdate,r.changes=n.changes,r.dirtyIds=n.dirtyIds||[],e&&!0===e.retainDirtyFlags?r.dirty=n.dirty:r.dirty=!1,o=n.data.length,a=0,e&&e.hasOwnProperty(n.name))for(l=d(n);a<o;a++)u=l(n.data[a]),r.data[a]=u,r.addAutoUpdateObserver(u),r.disableFreeze||i(r.data[a]);else for(;a<o;a++)r.data[a]=n.data[a],r.addAutoUpdateObserver(r.data[a]),r.disableFreeze||i(r.data[a]);if(r.maxId=void 0===n.maxId?0:n.maxId,void 0!==n.binaryIndices&&(r.binaryIndices=n.binaryIndices),void 0!==n.transforms&&(r.transforms=n.transforms),r.uniqueNames=[],n.hasOwnProperty("uniqueNames")&&(r.uniqueNames=n.uniqueNames),void 0!==n.DynamicViews){for(var f=0;f<n.DynamicViews.length;f++){var p=n.DynamicViews[f],m=r.addDynamicView(p.name,p.options);m.resultdata=p.resultdata,m.resultsdirty=p.resultsdirty,m.filterPipeline=p.filterPipeline,m.sortCriteriaSimple=p.sortCriteriaSimple,m.sortCriteria=p.sortCriteria,m.sortFunction=null,m.sortDirty=p.sortDirty,r.disableFreeze||(i(m.filterPipeline),m.sortCriteriaSimple?i(m.sortCriteriaSimple):m.sortCriteria&&i(m.sortCriteria)),m.resultset.filteredrows=p.resultset.filteredrows,m.resultset.filterInitialized=p.resultset.filterInitialized,m.rematerialize({removeWhereFilters:!0})}t.databaseVersion<1.5&&(r.ensureAllIndexes(!0),r.dirty=!0)}}},w.prototype.close=function(t){this.autosave&&(this.autosaveDisable(),this.autosaveDirty()&&(this.saveDatabase(t),t=void 0)),t&&this.on("close",t),this.emit("close")},w.prototype.generateChangesNotification=function(t){function e(t){return t.name}var i=[],n=t||this.collections.map(e);return this.collections.forEach((function(t){-1!==n.indexOf(e(t))&&(i=i.concat(t.getChanges()))})),i},w.prototype.serializeChanges=function(t){return JSON.stringify(this.generateChangesNotification(t))},w.prototype.clearChanges=function(){this.collections.forEach((function(t){t.flushChanges&&t.flushChanges()}))},x.prototype.loadDatabase=function(t,e){var i=this;this.options.asyncResponses?setTimeout((function(){i.hashStore.hasOwnProperty(t)?e(i.hashStore[t].value):e(null)}),this.options.asyncTimeout):this.hashStore.hasOwnProperty(t)?e(this.hashStore[t].value):e(null)},x.prototype.saveDatabase=function(t,e,i){var n,r=this;this.options.asyncResponses?setTimeout((function(){n=r.hashStore.hasOwnProperty(t)?r.hashStore[t].savecount:0,r.hashStore[t]={savecount:n+1,lastsave:new Date,value:e},i()}),this.options.asyncTimeout):(n=this.hashStore.hasOwnProperty(t)?this.hashStore[t].savecount:0,this.hashStore[t]={savecount:n+1,lastsave:new Date,value:e},i())},x.prototype.deleteDatabase=function(t,e){this.hashStore.hasOwnProperty(t)&&delete this.hashStore[t],"function"==typeof e&&e()},T.prototype.loadDatabase=function(t,e){var i=this;this.dbname=t,this.dbref=new w(t),this.adapter.loadDatabase(t,(function(t){if(t){"string"!=typeof t&&e(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()"));var n=JSON.parse(t);i.dbref.loadJSONObject(n),n=null,i.dbref.collections.length,0!==i.dbref.collections.length?(i.pageIterator={collection:0,pageIndex:0},i.loadNextPartition(0,(function(){e(i.dbref)}))):e(i.dbref)}else e(t)}))},T.prototype.loadNextPartition=function(t,e){var i=this.dbname+"."+t,n=this;if(!0===this.options.paging)return this.pageIterator.pageIndex=0,void this.loadNextPage(e);this.adapter.loadDatabase(i,(function(i){var r=n.dbref.deserializeCollection(i,{delimited:!0,collectionIndex:t});n.dbref.collections[t].data=r,++t<n.dbref.collections.length?n.loadNextPartition(t,e):e()}))},T.prototype.loadNextPage=function(t){var e=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,i=this;this.adapter.loadDatabase(e,(function(e){var n=e.split(i.options.delimiter);e="";var r,o=n.length,s=""===n[o-1];for(s&&(n.pop(),""===n[(o=n.length)-1]&&1===o&&(n.pop(),o=n.length)),r=0;r<o;r++)i.dbref.collections[i.pageIterator.collection].data.push(JSON.parse(n[r])),n[r]=null;n=[],s?++i.pageIterator.collection<i.dbref.collections.length?i.loadNextPartition(i.pageIterator.collection,t):t():(i.pageIterator.pageIndex++,i.loadNextPage(t))}))},T.prototype.exportDatabase=function(t,e,i){var n,r=e.collections.length;for(this.dbref=e,this.dbname=t,this.dirtyPartitions=[-1],n=0;n<r;n++)e.collections[n].dirty&&this.dirtyPartitions.push(n);this.saveNextPartition((function(t){i(t)}))},T.prototype.saveNextPartition=function(t){var e=this,i=this.dirtyPartitions.shift(),n=this.dbname+(-1===i?"":"."+i);if(this.options.paging&&-1!==i)return this.pageIterator={collection:i,docIndex:0,pageIndex:0},void this.saveNextPage((function(i){0===e.dirtyPartitions.length?t(i):e.saveNextPartition(t)}));var r=this.dbref.serializeDestructured({partitioned:!0,delimited:!0,partition:i});this.adapter.saveDatabase(n,r,(function(i){i?t(i):0===e.dirtyPartitions.length?t(null):e.saveNextPartition(t)}))},T.prototype.saveNextPage=function(t){var e=this,i=this.dbref.collections[this.pageIterator.collection],n=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,r=0,o=i.data.length,s=this.options.delimiter.length,a="",l="",u=!1,h=!1,c=function(i){l="",i&&t(i),u?t(null):(e.pageIterator.pageIndex++,e.saveNextPage(t))};for(0===i.data.length&&(u=!0);;)if(u||(a=JSON.stringify(i.data[this.pageIterator.docIndex]),l+=a,r+=a.length,++this.pageIterator.docIndex>=o&&(u=!0)),r>=this.options.pageSize&&(h=!0),h&&!u||(l+=this.options.delimiter,r+=s),u||h)return void this.adapter.saveDatabase(n,l,c)},S.prototype.loadDatabase=function(t,e){var i=this;this.fs.stat(t,(function(n,r){!n&&r.isFile()?i.fs.readFile(t,{encoding:"utf8"},(function(t,i){e(t?new Error(t):i)})):e(null)}))},S.prototype.saveDatabase=function(t,e,i){var n=this,r=t+"~";this.fs.writeFile(r,e,(function(e){e?i(new Error(e)):n.fs.rename(r,t,i)}))},S.prototype.deleteDatabase=function(t,e){this.fs.unlink(t,(function(t){t?e(new Error(t)):e()}))},E.prototype.loadDatabase=function(t,e){v()?e(localStorage.getItem(t)):e(new Error("localStorage is not available"))},E.prototype.saveDatabase=function(t,e,i){v()?(localStorage.setItem(t,e),i(null)):i(new Error("localStorage is not available"))},E.prototype.deleteDatabase=function(t,e){v()?(localStorage.removeItem(t),e(null)):e(new Error("localStorage is not available"))},w.prototype.throttledSaveDrain=function(t,e){var i=this,n=(new Date).getTime();if(this.throttledSaves||t(!0),(e=e||{}).hasOwnProperty("recursiveWait")||(e.recursiveWait=!0),e.hasOwnProperty("recursiveWaitLimit")||(e.recursiveWaitLimit=!1),e.hasOwnProperty("recursiveWaitLimitDuration")||(e.recursiveWaitLimitDuration=2e3),e.hasOwnProperty("started")||(e.started=(new Date).getTime()),this.throttledSaves&&this.throttledSavePending){if(!e.recursiveWait)return void this.throttledCallbacks.push(t);this.throttledCallbacks.push((function(){return i.throttledSavePending?e.recursiveWaitLimit&&n-e.started>e.recursiveWaitLimitDuration?void t(!1):void i.throttledSaveDrain(t,e):void t(!0)}))}else t(!0)},w.prototype.loadDatabaseInternal=function(t,e){var i=e||function(t,e){if(t)throw t},n=this;null!==this.persistenceAdapter?this.persistenceAdapter.loadDatabase(this.filename,(function(e){if("string"==typeof e){var r=!1;try{n.loadJSON(e,t||{}),r=!0}catch(t){i(t)}r&&(i(null),n.emit("loaded","database "+n.filename+" loaded"))}else{if(!e)return i(null),void n.emit("loaded","empty database "+n.filename+" loaded");if(e instanceof Error)return void i(e);if("object"==typeof e)return n.loadJSONObject(e,t||{}),i(null),void n.emit("loaded","database "+n.filename+" loaded");i("unexpected adapter response : "+e)}})):i(new Error("persistenceAdapter not configured"))},w.prototype.loadDatabase=function(t,e){var i=this;this.throttledSaves?this.throttledSaveDrain((function(n){if(n)return i.throttledSavePending=!0,void i.loadDatabaseInternal(t,(function(t){0===i.throttledCallbacks.length?i.throttledSavePending=!1:i.saveDatabase(),"function"==typeof e&&e(t)}));"function"==typeof e&&e(new Error("Unable to pause save throttling long enough to read database"))}),t):this.loadDatabaseInternal(t,e)},w.prototype.saveDatabaseInternal=function(t){var e,i=t||function(t){if(t)throw t},n=this;this.persistenceAdapter?"incremental"===this.persistenceAdapter.mode?(this.ignoreAutosave=!0,this.persistenceAdapter.saveDatabase(this.filename,(function(){if(n.ignoreAutosave=!1,!e){var t=n.copy({removeNonSerializable:!0});return e=n.collections.map((function(t){return[t.dirty,t.dirtyIds]})),n.collections.forEach((function(t){t.dirty=!1,t.dirtyIds=[]})),t}i(new Error("adapter error - getLokiCopy called more than once"))}),(function(t){n.ignoreAutosave=!1,t&&e&&n.collections.forEach((function(t,i){var n=e[i];t.dirty=t.dirty||n[0],t.dirtyIds=t.dirtyIds.concat(n[1])})),i(t)}))):"reference"===this.persistenceAdapter.mode&&"function"==typeof this.persistenceAdapter.exportDatabase?this.persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}),(function(t){n.autosaveClearFlags(),i(t)})):(this.autosaveClearFlags(),this.persistenceAdapter.saveDatabase(this.filename,this.serialize(),(function(t){i(t)}))):i(new Error("persistenceAdapter not configured"))},w.prototype.saveDatabase=function(t){if(this.throttledSaves)if(this.throttledSavePending)this.throttledCallbacks.push(t);else{var e=this.throttledCallbacks;this.throttledCallbacks=[],e.unshift(t),this.throttledSavePending=!0;var i=this;this.saveDatabaseInternal((function(t){i.throttledSavePending=!1,e.forEach((function(e){"function"==typeof e&&setTimeout((function(){e(t)}),1)})),i.throttledCallbacks.length>0&&i.saveDatabase()}))}else this.saveDatabaseInternal(t)},w.prototype.save=w.prototype.saveDatabase,w.prototype.deleteDatabase=function(t,e){var i=e||function(t,e){if(t)throw t};"function"!=typeof t||e||(i=t),null!==this.persistenceAdapter?this.persistenceAdapter.deleteDatabase(this.filename,(function(t){i(t)})):i(new Error("persistenceAdapter not configured"))},w.prototype.autosaveDirty=function(){for(var t=0;t<this.collections.length;t++)if(this.collections[t].dirty)return!0;return!1},w.prototype.autosaveClearFlags=function(){for(var t=0;t<this.collections.length;t++)this.collections[t].dirty=!1},w.prototype.autosaveEnable=function(t,e){this.autosave=!0;var i=5e3,n=this;void 0!==this.autosaveInterval&&null!==this.autosaveInterval&&(i=this.autosaveInterval),this.autosaveHandle=setInterval((function(){n.autosaveDirty()&&!n.ignoreAutosave&&n.saveDatabase(e)}),i)},w.prototype.autosaveDisable=function(){void 0!==this.autosaveHandle&&null!==this.autosaveHandle&&(clearInterval(this.autosaveHandle),this.autosaveHandle=null)},P.prototype.reset=function(){return this.filteredrows.length>0&&(this.filteredrows=[]),this.filterInitialized=!1,this},P.prototype.toJSON=function(){var t=this.copy();return t.collection=null,t},P.prototype.limit=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e=new P(this.collection);return e.filteredrows=this.filteredrows.slice(0,t),e.filterInitialized=!0,e},P.prototype.offset=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e=new P(this.collection);return e.filteredrows=this.filteredrows.slice(t),e.filterInitialized=!0,e},P.prototype.copy=function(){var t=new P(this.collection);return this.filteredrows.length>0&&(t.filteredrows=this.filteredrows.slice()),t.filterInitialized=this.filterInitialized,t},P.prototype.branch=P.prototype.copy,P.prototype.transform=function(t,e){var i,n,r=this;if("string"==typeof t&&this.collection.transforms.hasOwnProperty(t)&&(t=this.collection.transforms[t]),"object"!=typeof t||!Array.isArray(t))throw new Error("Invalid transform");for(void 0!==e&&(t=s.resolveTransformParams(t,e)),i=0;i<t.length;i++)switch((n=t[i]).type){case"find":r.find(n.value);break;case"where":r.where(n.value);break;case"simplesort":r.simplesort(n.property,n.desc||n.options);break;case"compoundsort":r.compoundsort(n.value);break;case"sort":r.sort(n.value);break;case"limit":r=r.limit(n.value);break;case"offset":r=r.offset(n.value);break;case"map":r=r.map(n.value,n.dataOptions);break;case"eqJoin":r=r.eqJoin(n.joinData,n.leftJoinKey,n.rightJoinKey,n.mapFun,n.dataOptions);break;case"mapReduce":r=r.mapReduce(n.mapFunction,n.reduceFunction);break;case"update":r.update(n.value);break;case"remove":r.remove()}return r},P.prototype.sort=function(t){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var e,i,n=(e=t,i=this.collection.data,function(t,n){return e(i[t],i[n])});return this.filteredrows.sort(n),this},P.prototype.simplesort=function(t,e){var i,n=10,r=this.collection.data.length,o=this.filteredrows.length,a=this.collection.binaryIndices.hasOwnProperty(t);if(void 0!==e&&!1!==e||(e={desc:!1}),!0===e&&(e={desc:!0}),0===o){if(this.filterInitialized)return this;if(this.collection.binaryIndices.hasOwnProperty(t))return this.collection.ensureIndex(t),this.filteredrows=this.collection.binaryIndices[t].values.slice(0),e.desc&&this.filteredrows.reverse(),this;this.filteredrows=this.collection.prepareFullDocIndex()}else if(!e.disableIndexIntersect&&a&&(i=r/o,e.useJavascriptSorting&&(n=6),i<=n||e.forceIndexIntersect)){var l,u=this.filteredrows,h={};for(l=0;l<o;l++)h[u[l]]=!0;var c=this.collection.binaryIndices[t].values;return this.filteredrows=c.filter((function(t){return h[t]})),e.desc&&this.filteredrows.reverse(),this}if(e.useJavascriptSorting)return this.sort((function(e,i){return e[t]===i[t]?0:e[t]>i[t]?1:e[t]<i[t]?-1:void 0}));var f,p,m,_,g,y,v=(f=t,p=e.desc,m=this.collection.data,function(t,e){return~f.indexOf(".")?(y=f.split("."),_=s.getIn(m[t],y,!0),g=s.getIn(m[e],y,!0)):(_=m[t][f],g=m[e][f]),d(_,g,p)});return this.filteredrows.sort(v),this},P.prototype.compoundsort=function(t){if(0===t.length)throw new Error("Invalid call to compoundsort, need at least one property");var e;if(1===t.length)return e=t[0],Array.isArray(e)?this.simplesort(e[0],e[1]):this.simplesort(e,!1);for(var i=0,n=t.length;i<n;i+=1)e=t[i],Array.isArray(e)||(t[i]=[e,!1]);this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var r,o,a=(r=t,o=this.collection.data,function(t,e){return function(t,e,i){for(var n,r,o,a,l,u=0,h=0,c=t.length;h<c;h++)if(~(r=(n=t[h])[0]).indexOf(".")?(l=r.split("."),o=s.getIn(e,l,!0),a=s.getIn(i,l,!0)):(o=e[r],a=i[r]),0!==(u=d(o,a,n[1])))return u;return 0}(r,o[t],o[e])});return this.filteredrows.sort(a),this},P.prototype.findOr=function(t){for(var e=null,i=0,n=0,r=[],o=[],s=0,a=(this.count(),0),l=t.length;a<l;a++)for(n=(e=this.branch().find(t[a]).filteredrows).length,i=0;i<n;i++)void 0===o[s=e[i]]&&(o[s]=!0,r.push(s));return this.filteredrows=r,this.filterInitialized=!0,this},P.prototype.$or=P.prototype.findOr,P.prototype.findAnd=function(t){for(var e=0,i=t.length;e<i;e++){if(0===this.count())return this;this.find(t[e])}return this},P.prototype.$and=P.prototype.findAnd,P.prototype.find=function(t,i){if(0===this.collection.data.length)return this.filteredrows=[],this.filterInitialized=!0,this;var n,r,o,a,l,u,h,c=t||"getAll",d=!1,p=[],m=[],y=null;if(i=i||!1,"object"==typeof c){for(n in c)(a={})[n]=c[n],m.push(a),e.call(c,n)&&(r=n,o=c[n]);if(m.length>1)return this.find({$and:m},i)}if(!r||"getAll"===c)return i&&(this.filterInitialized?this.filteredrows=this.filteredrows.slice(0,1):(this.filteredrows=this.collection.data.length>0?[0]:[],this.filterInitialized=!0)),this;if("$and"===r||"$or"===r)return this[r](o),i&&this.filteredrows.length>1&&(this.filteredrows=this.filteredrows.slice(0,1)),this;if(null===o||"object"!=typeof o||o instanceof Date)l="$eq",u=o;else{if("object"!=typeof o)throw new Error("Do not know what you want to do.");for(h in o)if(e.call(o,h)){l=h,u=o[h];break}}"$regex"!==l&&"object"!=typeof u||(u=O(l,u));var v=-1!==r.indexOf(".");!this.filterInitialized&&this.collection.binaryIndices[r]&&g[l]&&(!0!==this.collection.adaptiveBinaryIndices&&this.collection.ensureIndex(r),d=!0,y=this.collection.binaryIndices[r]),!d&&"$in"===l&&Array.isArray(u)&&"undefined"!=typeof Set&&(u=new Set(u),l="$inSet");var b,w,x=_[l],T=this.collection.data,S=0,E=0,P=0;if(this.filterInitialized){if(E=(b=this.filteredrows).length,v){for(r=r.split("."),S=0;S<E;S++)if(f(w=T[P=b[S]],r,x,u,w)&&(p.push(P),i))return this.filteredrows=p,this}else for(S=0;S<E;S++)if(x((w=T[P=b[S]])[r],u,w)&&(p.push(P),i))return this.filteredrows=p,this}else if(d){var k=this.collection.calculateRange(l,r,u);if("$in"!==l){for(S=k[0];S<=k[1];S++)if(!0!==g[l]){if(g[l](s.getIn(T[y.values[S]],r,v),u)&&(p.push(y.values[S]),i))return this.filteredrows=p,this.filterInitialized=!0,this}else if(p.push(y.values[S]),i)return this.filteredrows=p,this.filterInitialized=!0,this}else for(S=0,E=k.length;S<E;S++)if(p.push(y.values[k[S]]),i)return this.filteredrows=p,this.filterInitialized=!0,this}else if(E=T.length,v){for(r=r.split("."),S=0;S<E;S++)if(f(w=T[S],r,x,u,w)&&(p.push(S),i))return this.filteredrows=p,this.filterInitialized=!0,this}else for(S=0;S<E;S++)if(x((w=T[S])[r],u,w)&&(p.push(S),i))return this.filteredrows=p,this.filterInitialized=!0,this;return this.filteredrows=p,this.filterInitialized=!0,this},P.prototype.where=function(t){var e,i=[];if("function"!=typeof t)throw new TypeError("Argument is not a stored view or a function");e=t;try{if(this.filterInitialized){for(var n=this.filteredrows.length;n--;)!0===e(this.collection.data[this.filteredrows[n]])&&i.push(this.filteredrows[n]);return this.filteredrows=i,this}for(var r=this.collection.data.length;r--;)!0===e(this.collection.data[r])&&i.push(r);return this.filteredrows=i,this.filterInitialized=!0,this}catch(t){throw t}},P.prototype.count=function(){return this.filterInitialized?this.filteredrows.length:this.collection.count()},P.prototype.data=function(t){var e,i,n,r,o=[],s=this.collection.data;if((t=t||{}).removeMeta&&!t.forceClones&&(t.forceClones=!0,t.forceCloneMethod=t.forceCloneMethod||"shallow"),!this.collection.disableDeltaChangesApi&&this.collection.disableFreeze&&(t.forceClones=!0,t.forceCloneMethod="parse-stringify"),!this.filterInitialized){if(0===this.filteredrows.length){if(this.collection.cloneObjects||t.forceClones){for(i=s.length,r=t.forceCloneMethod||this.collection.cloneMethod,n=0;n<i;n++)e=y(s[n],r),t.removeMeta&&(delete e.$loki,delete e.meta),o.push(e);return o}return s.slice()}this.filterInitialized=!0}var a=this.filteredrows;if(i=a.length,this.collection.cloneObjects||t.forceClones)for(r=t.forceCloneMethod||this.collection.cloneMethod,n=0;n<i;n++)e=y(s[a[n]],r),t.removeMeta&&(delete e.$loki,delete e.meta),o.push(e);else for(n=0;n<i;n++)o.push(s[a[n]]);return o},P.prototype.update=function(t){if("function"!=typeof t)throw new TypeError("Argument is not a function");this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());for(var e,i=this.filteredrows.length,n=this.collection.data,r=0;r<i;r++)this.disableFreeze&&!this.collection.cloneObjects&&this.collection.disableDeltaChangesApi?(t(n[this.filteredrows[r]]),this.collection.update(n[this.filteredrows[r]])):(t(e=y(n[this.filteredrows[r]],this.collection.cloneMethod)),this.collection.update(e));return this},P.prototype.remove=function(){return this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex()),this.collection.removeBatchByPositions(this.filteredrows),this.filteredrows=[],this},P.prototype.mapReduce=function(t,e){try{return e(this.data().map(t))}catch(t){throw t}},P.prototype.eqJoin=function(t,e,i,n,r){var o,s,a,l,u=[],h=[],c="function"==typeof e,d="function"==typeof i,f={};if(s=(o=this.data(r)).length,t instanceof L)u=t.chain().data(r);else if(t instanceof P)u=t.data(r);else{if(!Array.isArray(t))throw new TypeError("joinData needs to be an array or result set");u=t}a=u.length;for(var p=0;p<a;p++)f[l=d?i(u[p]):u[p][i]]=u[p];n||(n=function(t,e){return{left:t,right:e}});for(var m=0;m<s;m++)l=c?e(o[m]):o[m][e],h.push(n(o[m],f[l]||{}));return this.collection=new L("joinData"),this.collection.insert(h),this.filteredrows=[],this.filterInitialized=!1,this},P.prototype.map=function(t,e){var i=this.data(e).map(t);return this.collection=new L("mappedData"),this.collection.insert(i),this.filteredrows=[],this.filterInitialized=!1,this},k.prototype=new b,k.prototype.constructor=k,k.prototype.getSort=function(){return this.sortFunction||this.sortCriteria||this.sortCriteriaSimple},k.prototype.rematerialize=function(t){var e,i,n;t=t||{},this.resultdata=[],this.resultsdirty=!0,this.resultset=new P(this.collection),(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple)&&(this.sortDirty=!0);var r=Object.isFrozen(this.filterPipeline);if(t.hasOwnProperty("removeWhereFilters"))for(r&&(this.filterPipeline=this.filterPipeline.slice()),i=e=this.filterPipeline.length;i--;)"where"===this.filterPipeline[i].type&&(i!==this.filterPipeline.length-1&&(this.filterPipeline[i]=this.filterPipeline[this.filterPipeline.length-1]),this.filterPipeline.length--);var o=this.filterPipeline;for(this.filterPipeline=[],e=o.length,n=0;n<e;n++)this.applyFind(o[n].val,o[n].uid);return r&&Object.freeze(this.filterPipeline),this.data(),this.emit("rebuild",this),this},k.prototype.branchResultset=function(t,e){var i=this.resultset.branch();return void 0===t?i:i.transform(t,e)},k.prototype.toJSON=function(){var t=new k(this.collection,this.name,this.options);return t.resultset=this.resultset,t.resultdata=[],t.resultsdirty=!0,t.filterPipeline=this.filterPipeline,t.sortFunction=this.sortFunction,t.sortCriteria=this.sortCriteria,t.sortCriteriaSimple=this.sortCriteriaSimple||null,t.sortDirty=this.sortDirty,t.collection=null,t},k.prototype.removeFilters=function(t){t=t||{},this.rebuildPending=!1,this.resultset.reset(),this.resultdata=[],this.resultsdirty=!0,this.cachedresultset=null;var e=Object.isFrozen(this.filterPipeline),i=this.filterPipeline.length>0;this.filterPipeline=[],e&&Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,!0===t.queueSortPhase&&this.queueSortPhase(),i&&this.emit("filter")},k.prototype.applySort=function(t){return this.sortFunction=t,this.sortCriteria=null,this.sortCriteriaSimple=null,this.queueSortPhase(),this.emit("sort"),this},k.prototype.applySimpleSort=function(t,e){return this.sortCriteriaSimple={propname:t,options:e||!1},this.collection.disableFreeze||i(this.sortCriteriaSimple),this.sortCriteria=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},k.prototype.applySortCriteria=function(t){return this.sortCriteria=t,this.collection.disableFreeze||i(this.sortCriteria),this.sortCriteriaSimple=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},k.prototype.startTransaction=function(){return this.cachedresultset=this.resultset.copy(),this},k.prototype.commit=function(){return this.cachedresultset=null,this},k.prototype.rollback=function(){return this.resultset=this.cachedresultset,this.options.persistent&&(this.resultdata=this.resultset.data(),this.emit("rebuild",this)),this},k.prototype._indexOfFilterWithId=function(t){if("string"==typeof t||"number"==typeof t)for(var e=0,i=this.filterPipeline.length;e<i;e+=1)if(t===this.filterPipeline[e].uid)return e;return-1},k.prototype._addFilter=function(t){var e=Object.isFrozen(this.filterPipeline);e&&(this.filterPipeline=this.filterPipeline.slice()),this.collection.disableFreeze||i(t),this.filterPipeline.push(t),e&&Object.freeze(this.filterPipeline),this.resultset[t.type](t.val)},k.prototype.reapplyFilters=function(){this.resultset.reset(),this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0);var t=this.filterPipeline,e=Object.isFrozen(t);this.filterPipeline=[];for(var i=0,n=t.length;i<n;i+=1)this._addFilter(t[i]);return e&&Object.freeze(this.filterPipeline),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this},k.prototype.applyFilter=function(t){var e=this._indexOfFilterWithId(t.uid);if(e>=0){var i=Object.isFrozen(this.filterPipeline);return i&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline[e]=t,i&&(n(t),Object.freeze(this.filterPipeline)),this.reapplyFilters()}return this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0),this._addFilter(t),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this},k.prototype.applyFind=function(t,e){return this.applyFilter({type:"find",val:t,uid:e}),this},k.prototype.applyWhere=function(t,e){return this.applyFilter({type:"where",val:t,uid:e}),this},k.prototype.removeFilter=function(t){var e=this._indexOfFilterWithId(t);if(e<0)throw new Error("Dynamic view does not contain a filter with ID: "+t);var i=Object.isFrozen(this.filterPipeline);return i&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline.splice(e,1),i&&Object.freeze(this.filterPipeline),this.reapplyFilters(),this},k.prototype.count=function(){return this.resultsdirty&&(this.resultdata=this.resultset.data()),this.resultset.count()},k.prototype.data=function(t){return(this.sortDirty||this.resultsdirty)&&this.performSortPhase({suppressRebuildEvent:!0}),this.options.persistent?this.resultdata:this.resultset.data(t)},k.prototype.queueRebuildEvent=function(){if(!this.rebuildPending){this.rebuildPending=!0;var t=this;setTimeout((function(){t.rebuildPending&&(t.rebuildPending=!1,t.emit("rebuild",t))}),this.options.minRebuildInterval)}},k.prototype.queueSortPhase=function(){if(!this.sortDirty){this.sortDirty=!0;var t=this;"active"===this.options.sortPriority?setTimeout((function(){t.performSortPhase()}),this.options.minRebuildInterval):this.queueRebuildEvent()}},k.prototype.performSortPhase=function(t){(this.sortDirty||this.resultsdirty)&&(t=t||{},this.sortDirty&&(this.sortFunction?this.resultset.sort(this.sortFunction):this.sortCriteria?this.resultset.compoundsort(this.sortCriteria):this.sortCriteriaSimple&&this.resultset.simplesort(this.sortCriteriaSimple.propname,this.sortCriteriaSimple.options),this.sortDirty=!1),this.options.persistent&&(this.resultdata=this.resultset.data(),this.resultsdirty=!1),t.suppressRebuildEvent||this.emit("rebuild",this))},k.prototype.evaluateDocument=function(t,e){if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var i,n=this.resultset.filteredrows,r=e?-1:n.indexOf(+t),o=n.length,s=new P(this.collection);s.filteredrows=[t],s.filterInitialized=!0;for(var a=0,l=this.filterPipeline.length;a<l;a++)s[(i=this.filterPipeline[a]).type](i.val);var u=0===s.filteredrows.length?-1:0;return-1!==r||-1!==u?-1===r&&-1!==u?(n.push(t),this.options.persistent&&this.resultdata.push(this.collection.data[t]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==r&&-1===u?(r<o-1?(n.splice(r,1),this.options.persistent&&this.resultdata.splice(r,1)):(n.length=o-1,this.options.persistent&&(this.resultdata.length=o-1)),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==r&&-1!==u?(this.options.persistent&&(this.resultdata[r]=this.collection.data[t]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):void 0:void 0},k.prototype.removeDocument=function(t){var e,i,n,r={},o={},s=[],a=this.resultset,l=this.resultset.filteredrows,u=l.length;if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());for(Array.isArray(t)||(t=[t]),n=t.length,i=0;i<n;i++)r[t[i]]=!0;for(e=0;e<u;e++)r[l[e]]&&(o[e]=!0);Object.keys(o).length>0&&(this.resultset.filteredrows=this.resultset.filteredrows.filter((function(t,e){return!o[e]})),this.options.persistent&&(this.resultdata=this.resultdata.filter((function(t,e){return!o[e]}))),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var h=function(t){return function(e){return e<a.filteredrows[t]}};for(u=a.filteredrows.length,e=0;e<u;e++)s=t.filter(h(e)),a.filteredrows[e]-=s.length},k.prototype.mapReduce=function(t,e){try{return e(this.data().map(t))}catch(t){throw t}},L.prototype=new b,L.prototype.contructor=L,L.prototype.createChange=function(t,e,i,n){this.changes.push({name:t,operation:e,obj:"U"!=e||this.disableDeltaChangesApi?JSON.parse(JSON.stringify(i)):this.getChangeDelta(i,n)})},L.prototype.insertMeta=function(t){var e,i;if(!this.disableMeta&&t)if(Array.isArray(t))for(e=t.length,i=0;i<e;i++)t[i].hasOwnProperty("meta")||(t[i].meta={}),t[i].meta.created=(new Date).getTime(),t[i].meta.revision=0;else t.meta||(t.meta={}),t.meta.created=(new Date).getTime(),t.meta.revision=0},L.prototype.updateMeta=function(t){return this.disableMeta||!t||(this.disableFreeze||((t=o(t)).meta=o(t.meta)),t.meta.updated=(new Date).getTime(),t.meta.revision+=1),t},L.prototype.createInsertChange=function(t){this.createChange(this.name,"I",t)},L.prototype.createUpdateChange=function(t,e){this.createChange(this.name,"U",t,e)},L.prototype.insertMetaWithChange=function(t){this.insertMeta(t),this.createInsertChange(t)},L.prototype.updateMetaWithChange=function(t,e,i){return t=this.updateMeta(t,i),this.createUpdateChange(t,e),t},L.prototype.lokiConsoleWrapper={log:function(){},warn:function(){},error:function(){}},L.prototype.addAutoUpdateObserver=function(t){this.autoupdate&&"function"==typeof Object.observe&&Object.observe(t,this.observerCallback,["add","update","delete","reconfigure","setPrototype"])},L.prototype.removeAutoUpdateObserver=function(t){this.autoupdate&&"function"==typeof Object.observe&&Object.unobserve(t,this.observerCallback)},L.prototype.addTransform=function(t,e){if(this.transforms.hasOwnProperty(t))throw new Error("a transform by that name already exists");this.transforms[t]=e},L.prototype.getTransform=function(t){return this.transforms[t]},L.prototype.setTransform=function(t,e){this.transforms[t]=e},L.prototype.removeTransform=function(t){delete this.transforms[t]},L.prototype.byExample=function(t){var e,i,n;for(e in n=[],t)t.hasOwnProperty(e)&&n.push(((i={})[e]=t[e],i));return{$and:n}},L.prototype.findObject=function(t){return this.findOne(this.byExample(t))},L.prototype.findObjects=function(t){return this.find(this.byExample(t))},L.prototype.ttlDaemonFuncGen=function(){var t=this,e=this.ttl.age;return function(){var i=Date.now();t.chain().where((function(t){var n=t.meta.updated||t.meta.created;return e<i-n})).remove()}},L.prototype.setTTL=function(t,e){t<0?clearInterval(this.ttl.daemon):(this.ttl.age=t,this.ttl.ttlInterval=e,this.ttl.daemon=setInterval(this.ttlDaemonFuncGen(),e))},L.prototype.prepareFullDocIndex=function(){for(var t=this.data.length,e=new Array(t),i=0;i<t;i+=1)e[i]=i;return e},L.prototype.configureOptions=function(t){(t=t||{}).hasOwnProperty("adaptiveBinaryIndices")&&(this.adaptiveBinaryIndices=t.adaptiveBinaryIndices,this.adaptiveBinaryIndices&&this.ensureAllIndexes())},L.prototype.ensureIndex=function(t,e){if(void 0===e&&(e=!1),null==t)throw new Error("Attempting to set index without an associated property");if((!this.binaryIndices[t]||e||this.binaryIndices[t].dirty)&&(!0!==this.adaptiveBinaryIndices||!this.binaryIndices.hasOwnProperty(t)||e)){var i={name:t,dirty:!0,values:this.prepareFullDocIndex()};this.binaryIndices[t]=i;var n,r,o,a,u,h=(n=t,r=this.data,u=!!~n.indexOf(".")&&n.split("."),function(t,e){if(u?(o=s.getIn(r[t],u,!0),a=s.getIn(r[e],u,!0)):(o=r[t][n],a=r[e][n]),o!==a){if(l.lt(o,a,!1))return-1;if(l.gt(o,a,!1))return 1}return 0});i.values.sort(h),i.dirty=!1,this.dirty=!0}},L.prototype.checkAllIndexes=function(t){var i,n=this.binaryIndices,r=[];for(i in n)e.call(n,i)&&(this.checkIndex(i,t)||r.push(i));return r},L.prototype.checkIndex=function(t,e){(e=e||{}).randomSamplingFactor&&!1!==e.randomSampling&&(e.randomSampling=!0),e.randomSamplingFactor=e.randomSamplingFactor||.1,(e.randomSamplingFactor<0||e.randomSamplingFactor>1)&&(e.randomSamplingFactor=.1);var i,n,r,o,a,l=!0;if(!this.binaryIndices.hasOwnProperty(t))throw new Error("called checkIndex on property without an index: "+t);if(this.adaptiveBinaryIndices||this.ensureIndex(t),(o=(a=this.binaryIndices[t].values).length)!==this.data.length)return e.repair&&this.ensureIndex(t,!0),!1;if(0===o)return!0;var u=-1!==t.indexOf(".");if(1===o)l=0===a[0];else if(e.randomSampling){if(_.$lte(s.getIn(this.data[a[0]],t,u),s.getIn(this.data[a[1]],t,u))||(l=!1),_.$lte(s.getIn(this.data[a[o-2]],t,u),s.getIn(this.data[a[o-1]],t,u))||(l=!1),l)for(n=Math.floor((o-1)*e.randomSamplingFactor),i=0;i<n-1;i++)if(r=Math.floor(Math.random()*(o-1)),!_.$lte(s.getIn(this.data[a[r]],t,u),s.getIn(this.data[a[r+1]],t,u))){l=!1;break}}else for(i=0;i<o-1;i++)if(!_.$lte(s.getIn(this.data[a[i]],t,u),s.getIn(this.data[a[i+1]],t,u))){l=!1;break}return!l&&e.repair&&this.ensureIndex(t,!0),l},L.prototype.getBinaryIndexValues=function(t){var e,i=this.binaryIndices[t].values,n=[];for(e=0;e<i.length;e++)n.push(s.getIn(this.data[i[e]],t,!0));return n},L.prototype.getUniqueIndex=function(t,e){var i=this.constraints.unique[t];return!i&&e?this.ensureUniqueIndex(t):i},L.prototype.ensureUniqueIndex=function(t){var e=this.constraints.unique[t];return e||-1==this.uniqueNames.indexOf(t)&&this.uniqueNames.push(t),this.constraints.unique[t]=e=new B(t),this.data.forEach((function(t){e.set(t)})),e},L.prototype.ensureAllIndexes=function(t){var i,n=this.binaryIndices;for(i in n)e.call(n,i)&&this.ensureIndex(i,t)},L.prototype.flagBinaryIndexesDirty=function(){var t,i=this.binaryIndices;for(t in i)e.call(i,t)&&(i[t].dirty=!0)},L.prototype.flagBinaryIndexDirty=function(t){this.binaryIndices[t]&&(this.binaryIndices[t].dirty=!0)},L.prototype.count=function(t){return t?this.chain().find(t).filteredrows.length:this.data.length},L.prototype.ensureId=function(){if(!this.idIndex){for(var t=this.data,e=0,i=t.length,n=new Array(i);e<i;e++)n[e]=t[e].$loki;this.idIndex=n}},L.prototype.ensureIdAsync=function(t){this.async((function(){this.ensureId()}),t)},L.prototype.addDynamicView=function(t,e){var i=new k(this,t,e);return this.DynamicViews.push(i),i},L.prototype.removeDynamicView=function(t){this.DynamicViews=this.DynamicViews.filter((function(e){return e.name!==t}))},L.prototype.getDynamicView=function(t){for(var e=0;e<this.DynamicViews.length;e++)if(this.DynamicViews[e].name===t)return this.DynamicViews[e];return null},L.prototype.findAndUpdate=function(t,e){"function"==typeof t?this.updateWhere(t,e):this.chain().find(t).update(e)},L.prototype.findAndRemove=function(t){this.chain().find(t).remove()},L.prototype.insert=function(t,e){if(!Array.isArray(t))return this.insertOne(t);var i,n=[],r=e&&!this.cloneObjects&&this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0;r&&(this.adaptiveBinaryIndices=!1);try{this.emit("pre-insert",t);for(var o=0,s=t.length;o<s;o++){if(!(i=this.insertOne(t[o],!0)))return;n.push(i)}}finally{r&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}return this.emit("insert",n),1===(n=this.cloneObjects?y(n,this.cloneMethod):n).length?n[0]:n},L.prototype.insertOne=function(t,e){var n,r=null;if("object"!=typeof t?r=new TypeError("Document needs to be an object"):null===t&&(r=new TypeError("Object cannot be null")),null!==r)throw this.emit("error",r),r;var s=this.cloneObjects?y(t,this.cloneMethod):t;if(this.disableFreeze||(s=o(s)),this.disableMeta||(void 0===s.meta?s.meta={revision:0,created:0}:this.disableFreeze||(s.meta=o(s.meta))),e||this.emit("pre-insert",s),this.add(s))return this.disableChangesApi?this.insertMeta(s):this.insertMetaWithChange(s),this.disableFreeze||i(s),n=this.cloneObjects?y(s,this.cloneMethod):s,e||this.emit("insert",n),this.addAutoUpdateObserver(n),n},L.prototype.clear=function(t){var e=this;t=t||{},this.data=[],this.idIndex=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null,this.maxId=0,this.DynamicViews=[],this.dirty=!0,this.constraints={unique:{},exact:{}},!0===t.removeIndices?(this.binaryIndices={},this.uniqueNames=[]):Object.keys(this.binaryIndices).forEach((function(t){e.binaryIndices[t].dirty=!1,e.binaryIndices[t].values=[]}))},L.prototype.update=function(t){var n,r,o;if(Array.isArray(t)){o=t.length,(n=!this.cloneObjects&&this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0)&&(this.adaptiveBinaryIndices=!1);try{for(r=0;r<o;r+=1)this.update(t[r])}finally{n&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}}else{if(!e.call(t,"$loki"))throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();var s,a,l,u,h,c=this.get(t.$loki,!0),d=this;if(!c)throw new Error("Trying to update a document not in collection.");s=c[0],l=c[1],a=this.cloneObjects||!this.disableDeltaChangesApi&&this.disableFreeze?y(t,this.cloneMethod):t,this.emit("pre-update",t),this.uniqueNames.forEach((function(t){d.getUniqueIndex(t,!0).update(s,a)})),this.data[l]=a,a!==t&&this.addAutoUpdateObserver(t);for(var f=0;f<this.DynamicViews.length;f++)this.DynamicViews[f].evaluateDocument(l,!1);if(this.adaptiveBinaryIndices){var p=this.binaryIndices;for(u in p)this.adaptiveBinaryIndexUpdate(l,u)}else this.flagBinaryIndexesDirty();return this.idIndex[l]=a.$loki,this.isIncremental&&this.dirtyIds.push(a.$loki),this.commit(),this.dirty=!0,a=this.disableChangesApi?this.updateMeta(a):this.updateMetaWithChange(a,s),this.disableFreeze||i(a),h=this.cloneObjects?y(a,this.cloneMethod):a,this.emit("update",h,s),h}catch(t){throw this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),t}}},L.prototype.add=function(t){if("object"!=typeof t)throw new TypeError("Object being added needs to be an object");if(void 0!==t.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this.maxId++,isNaN(this.maxId)&&(this.maxId=this.data[this.data.length-1].$loki+1);var e=this.maxId;t.$loki=e,this.disableMeta||(t.meta.version=0);for(var i=0,n=this.uniqueNames.length;i<n;i++)this.getUniqueIndex(this.uniqueNames[i],!0).set(t);this.idIndex&&this.idIndex.push(e),this.isIncremental&&this.dirtyIds.push(e),this.data.push(t);var r=this.data.length-1,o=this.DynamicViews.length;for(i=0;i<o;i++)this.DynamicViews[i].evaluateDocument(r,!0);if(this.adaptiveBinaryIndices){var s=this.binaryIndices;for(var a in s)this.adaptiveBinaryIndexInsert(r,a)}else this.flagBinaryIndexesDirty();return this.commit(),this.dirty=!0,this.cloneObjects?y(t,this.cloneMethod):t}catch(t){throw this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),t}},L.prototype.updateWhere=function(t,e){var i,n=this.where(t),r=0;try{for(;r<n.length;r++)i=e(n[r]),this.update(i)}catch(t){this.rollback(),this.lokiConsoleWrapper.error(t.message)}},L.prototype.removeWhere=function(t){var e;"function"==typeof t?(e=this.data.filter(t),this.remove(e)):this.chain().find(t).remove()},L.prototype.removeDataOnly=function(){this.remove(this.data.slice())},L.prototype.removeBatchByPositions=function(t){var e,i,n,r,o=t.length,s={},a=Object.keys(this.binaryIndices).length,l=Object.keys(this.constraints.unique).length,u=this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0,h=this;try{for(this.startTransaction(),this.ensureId(),n=0;n<o;n++)s[this.idIndex[t[n]]]=!0;if((e=this.DynamicViews.length)>0||a>0||l>0){if(e>0)for(i=0;i<e;i++)this.DynamicViews[i].removeDocument(t);if(this.adaptiveBinaryIndices&&!u){var c,d=this.binaryIndices;for(c in d)this.adaptiveBinaryIndexRemove(t,c)}else this.flagBinaryIndexesDirty();l&&this.uniqueNames.forEach((function(e){var i=h.getUniqueIndex(e);if(i)for(n=0;n<o;n++)null!==(r=h.data[t[n]])[e]&&void 0!==r[e]&&i.remove(r[e])}))}if(!this.disableChangesApi||this.events.delete.length>1)for(n=0;n<o;n++)this.emit("delete",this.data[t[n]]);if(this.data=this.data.filter((function(t){return!s[t.$loki]})),this.isIncremental)for(n=0;n<o;n++)this.dirtyIds.push(this.idIndex[t[n]]);this.idIndex=this.idIndex.filter((function(t){return!s[t]})),this.adaptiveBinaryIndices&&u&&(this.adaptiveBinaryIndices=!1,this.ensureAllIndexes(!0),this.adaptiveBinaryIndices=!0),this.commit(),this.dirty=!0}catch(t){return this.rollback(),u&&(this.adaptiveBinaryIndices=!0),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),null}},L.prototype.removeBatch=function(t){var e,i=t.length,n=this.data.length,r={},o=[];for(e=0;e<n;e++)r[this.data[e].$loki]=e;for(e=0;e<i;e++)"object"==typeof t[e]?o.push(r[t[e].$loki]):o.push(r[t[e]]);this.removeBatchByPositions(o)},L.prototype.remove=function(t){if("number"==typeof t&&(t=this.get(t)),"object"!=typeof t)throw new Error("Parameter is not an object");if(Array.isArray(t))this.removeBatch(t);else{if(!e.call(t,"$loki"))throw new Error("Object is not a document stored in the collection");try{this.startTransaction();var i=this.get(t.$loki,!0),r=i[1],s=this;this.uniqueNames.forEach((function(e){if(null!==t[e]&&void 0!==t[e]){var i=s.getUniqueIndex(e);i&&i.remove(t[e])}}));for(var a=0;a<this.DynamicViews.length;a++)this.DynamicViews[a].removeDocument(r);if(this.adaptiveBinaryIndices){var l,u=this.binaryIndices;for(l in u)this.adaptiveBinaryIndexRemove(r,l)}else this.flagBinaryIndexesDirty();return this.data.splice(r,1),this.removeAutoUpdateObserver(t),this.idIndex.splice(r,1),this.isIncremental&&this.dirtyIds.push(t.$loki),this.commit(),this.dirty=!0,this.emit("delete",i[0]),this.disableFreeze||(t=o(t)),delete t.$loki,delete t.meta,this.disableFreeze||n(t),t}catch(t){return this.rollback(),this.lokiConsoleWrapper.error(t.message),this.emit("error",t),null}}},L.prototype.get=function(t,e){this.idIndex||this.ensureId();var i=e||!1,n=this.idIndex,r=n.length-1,o=0,s=o+r>>1;if(t="number"==typeof t?t:parseInt(t,10),isNaN(t))throw new TypeError("Passed id is not an integer");for(;n[o]<n[r];)n[s=o+r>>1]<t?o=s+1:r=s;return r===o&&n[o]===t?i?[this.data[o],o]:this.data[o]:null},L.prototype.getBinaryIndexPosition=function(t,e){var i=s.getIn(this.data[t],e,!0),n=this.binaryIndices[e].values,r=this.calculateRange("$eq",e,i);if(0===r[0]&&-1===r[1])return null;for(var o=r[0],a=r[1],l=o;l<=a;l++)if(n[l]===t)return l;return null},L.prototype.adaptiveBinaryIndexInsert=function(t,e){var i=-1!==e.indexOf("."),n=this.binaryIndices[e].values,r=s.getIn(this.data[t],e,i);!0===this.serializableIndices&&r instanceof Date&&(this.data[t][e]=r.getTime(),r=s.getIn(this.data[t],e));var o=0===n.length?0:this.calculateRangeStart(e,r,!0,i);this.binaryIndices[e].values.splice(o,0,t)},L.prototype.adaptiveBinaryIndexUpdate=function(t,e){var i,n=this.binaryIndices[e].values,r=n.length;for(i=0;i<r&&n[i]!==t;i++);this.binaryIndices[e].values.splice(i,1),this.adaptiveBinaryIndexInsert(t,e)},L.prototype.adaptiveBinaryIndexRemove=function(t,e,i){var n,r,o,s,a,l,u,h=this.binaryIndices[e],c={};if(Array.isArray(t)){if(1!==(s=t.length)){for(o=0;o<s;o++)c[t[o]]=!0;if(h.values=h.values.filter((function(t){return!c[t]})),!0===i)return;var d=t.slice();for(d.sort((function(t,e){return t-e})),n=h.values.length,r=0;r<n;r++){for(a=h.values[r],l=0,o=0;o<s&&a>d[o];o++)l++;h.values[r]-=l}return}t=t[0]}if(null===(u=this.getBinaryIndexPosition(t,e)))return null;if(h.values.splice(u,1),!0!==i)for(n=h.values.length,r=0;r<n;r++)h.values[r]>t&&h.values[r]--},L.prototype.calculateRangeStart=function(t,e,i,n){var r=this.data,o=this.binaryIndices[t].values,a=0,u=o.length-1,h=0;if(0===o.length)return-1;for(s.getIn(r[o[a]],t,n),s.getIn(r[o[u]],t,n);a<u;)h=a+u>>1,l.lt(s.getIn(r[o[h]],t,n),e,!1)?a=h+1:u=h;var c=a;return l.aeq(e,s.getIn(r[o[c]],t,n))?c:l.lt(e,s.getIn(r[o[c]],t,n),!1)?i?c:c-1:i?c+1:c},L.prototype.calculateRangeEnd=function(t,e,i){var n=this.data,r=this.binaryIndices[t].values,o=0,a=r.length-1,u=0;if(0===r.length)return-1;for(s.getIn(n[r[o]],t,i),s.getIn(n[r[a]],t,i);o<a;)u=o+a>>1,l.lt(e,s.getIn(n[r[u]],t,i),!1)?a=u:o=u+1;var h=a;return l.aeq(e,s.getIn(n[r[h]],t,i))?h:l.gt(e,s.getIn(n[r[h]],t,i),!1)?h+1:l.aeq(e,s.getIn(n[r[h-1]],t,i))?h-1:h},L.prototype.calculateRange=function(t,e,i){var n,r,o,a=this.data,u=this.binaryIndices[e].values,h=u.length-1;if(0===a.length)return[0,-1];var c=-1!==e.indexOf("."),d=s.getIn(a[u[0]],e,c),f=s.getIn(a[u[h]],e,c);switch(t){case"$eq":case"$aeq":case"$dteq":if(l.lt(i,d,!1)||l.gt(i,f,!1))return[0,-1];break;case"$gt":if(l.gt(i,f,!0))return[0,-1];if(l.gt(d,i,!1))return[0,h];break;case"$gte":if(l.gt(i,f,!1))return[0,-1];if(l.gt(d,i,!0))return[0,h];break;case"$lt":if(l.lt(i,d,!0))return[0,-1];if(l.lt(f,i,!1))return[0,h];break;case"$lte":if(l.lt(i,d,!1))return[0,-1];if(l.lt(f,i,!0))return[0,h];break;case"$between":return l.gt(i[0],f,!1)||l.lt(i[1],d,!1)?[0,-1]:((n=this.calculateRangeStart(e,i[0],!1,c))<0&&n++,(o=this.calculateRangeEnd(e,i[1],c))>h&&o--,l.gt(s.getIn(a[u[n]],e,c),i[0],!0)||n++,l.lt(s.getIn(a[u[o]],e,c),i[1],!0)||o--,o<n?[0,-1]:[n,o]);case"$in":for(var p=[],m=[],_=0,g=i.length;_<g;_++)for(var y=this.calculateRange("$eq",e,i[_]),v=y[0];v<=y[1];v++)void 0===p[v]&&(p[v]=!0,m.push(v));return m}switch(t){case"$eq":case"$aeq":case"$dteq":case"$gte":case"$lt":n=this.calculateRangeStart(e,i,!1,c),r=s.getIn(a[u[n]],e,c)}switch(t){case"$eq":case"$aeq":case"$dteq":case"$lte":case"$gt":o=this.calculateRangeEnd(e,i,c),s.getIn(a[u[o]],e,c)}switch(t){case"$eq":case"$aeq":case"$dteq":return l.aeq(r,i)?[n,o]:[0,-1];case"$gt":return l.aeq(s.getIn(a[u[o]],e,c),i)?[o+1,h]:[o,h];case"$gte":return l.aeq(s.getIn(a[u[n]],e,c),i)?[n,h]:[n+1,h];case"$lt":return l.aeq(s.getIn(a[u[n]],e,c),i)?[0,n-1]:[0,n];case"$lte":return l.aeq(s.getIn(a[u[o]],e,c),i)?[0,o]:[0,o-1];default:return[0,a.length-1]}},L.prototype.by=function(t,e){var i;if(void 0===e)return i=this,function(e){return i.by(t,e)};var n=this.getUniqueIndex(t,!0).get(e);return this.cloneObjects?y(n,this.cloneMethod):n},L.prototype.findOne=function(t){t=t||{};var e=this.chain().find(t,!0).data();return Array.isArray(e)&&0===e.length?null:this.cloneObjects?y(e[0],this.cloneMethod):e[0]},L.prototype.chain=function(t,e){var i=new P(this);return void 0===t?i:i.transform(t,e)},L.prototype.find=function(t){return this.chain().find(t).data()},L.prototype.findOneUnindexed=function(t,e){for(var i=this.data.length;i--;)if(s.getIn(this.data[i],t,!0)===e)return this.data[i];return null},L.prototype.startTransaction=function(){if(this.transactional){this.cachedData=y(this.data,this.cloneMethod),this.cachedIndex=this.idIndex,this.cachedBinaryIndex=this.binaryIndices,this.cachedDirtyIds=this.dirtyIds;for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].startTransaction()}},L.prototype.commit=function(){if(this.transactional){this.cachedData=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedDirtyIds=null;for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].commit()}},L.prototype.rollback=function(){if(this.transactional){null!==this.cachedData&&null!==this.cachedIndex&&(this.data=this.cachedData,this.idIndex=this.cachedIndex,this.binaryIndices=this.cachedBinaryIndex,this.dirtyIds=this.cachedDirtyIds);for(var t=0;t<this.DynamicViews.length;t++)this.DynamicViews[t].rollback()}},L.prototype.async=function(t,e){setTimeout((function(){if("function"!=typeof t)throw new TypeError("Argument passed for async execution is not a function");t(),e()}),0)},L.prototype.where=function(t){return this.chain().where(t).data()},L.prototype.mapReduce=function(t,e){try{return e(this.data.map(t))}catch(t){throw t}},L.prototype.eqJoin=function(t,e,i,n,r){return new P(this).eqJoin(t,e,i,n,r)},L.prototype.stages={},L.prototype.getStage=function(t){return this.stages[t]||(this.stages[t]={}),this.stages[t]},L.prototype.commitLog=[],L.prototype.stage=function(t,e){var i=JSON.parse(JSON.stringify(e));return this.getStage(t)[e.$loki]=i,i},L.prototype.commitStage=function(t,e){var i,n=this.getStage(t),r=(new Date).getTime();for(i in n)this.update(n[i]),this.commitLog.push({timestamp:r,message:e,data:JSON.parse(JSON.stringify(n[i]))});this.stages[t]={}},L.prototype.no_op=function(){},L.prototype.extract=function(t){for(var e=0,i=this.data.length,n=I(t),r=[];e<i;e+=1)r.push(N(this.data[e],t,n));return r},L.prototype.max=function(t){return Math.max.apply(null,this.extract(t))},L.prototype.min=function(t){return Math.min.apply(null,this.extract(t))},L.prototype.maxRecord=function(t){for(var e,i=0,n=this.data.length,r=I(t),o={index:0,value:void 0};i<n;i+=1)void 0!==e?e<N(this.data[i],t,r)&&(e=N(this.data[i],t,r),o.index=this.data[i].$loki):(e=N(this.data[i],t,r),o.index=this.data[i].$loki);return o.value=e,o},L.prototype.minRecord=function(t){for(var e,i=0,n=this.data.length,r=I(t),o={index:0,value:void 0};i<n;i+=1)void 0!==e?e>N(this.data[i],t,r)&&(e=N(this.data[i],t,r),o.index=this.data[i].$loki):(e=N(this.data[i],t,r),o.index=this.data[i].$loki);return o.value=e,o},L.prototype.extractNumerical=function(t){return this.extract(t).map(C).filter(Number).filter((function(t){return!isNaN(t)}))},L.prototype.avg=function(t){return D(this.extractNumerical(t))},L.prototype.stdDev=function(t){return e=this.extractNumerical(t),i=D(e),n=D(e.map((function(t){var e=t-i;return e*e}))),Math.sqrt(n);var e,i,n},L.prototype.mode=function(t){var e,i,n,r={},o=this.extract(t);for(i in o.forEach((function(t){r[t]?r[t]+=1:r[t]=1})),r)e?e<r[i]&&(n=i):(n=i,e=r[i]);return n},L.prototype.median=function(t){var e=this.extractNumerical(t);e.sort(M);var i=Math.floor(e.length/2);return e.length%2?e[i]:(e[i-1]+e[i])/2},F.prototype={keys:[],values:[],sort:function(t,e){return t<e?-1:t>e?1:0},setSort:function(t){this.bs=new R(t)},bs:function(){return new R(this.sort)},set:function(t,e){var i=this.bs(this.keys,t);i.found?this.values[i.index]=e:(this.keys.splice(i.index,0,t),this.values.splice(i.index,0,e))},get:function(t){return this.values[z(this.keys,t,this.sort).index]}},B.prototype.keyMap={},B.prototype.lokiMap={},B.prototype.set=function(t){var e=t[this.field];if(null!=e){if(this.keyMap[e])throw new Error("Duplicate key for property "+this.field+": "+e);this.keyMap[e]=t,this.lokiMap[t.$loki]=e}},B.prototype.get=function(t){return this.keyMap[t]},B.prototype.byId=function(t){return this.keyMap[this.lokiMap[t]]},B.prototype.update=function(t,e){if(this.lokiMap[t.$loki]!==e[this.field]){var i=this.lokiMap[t.$loki];this.set(e),this.keyMap[i]=void 0}else this.keyMap[t[this.field]]=e},B.prototype.remove=function(t){var e=this.keyMap[t];if(null==e)throw new Error("Key is not in unique index: "+this.field);this.keyMap[t]=void 0,this.lokiMap[e.$loki]=void 0},B.prototype.clear=function(){this.keyMap=Object.create(null),this.lokiMap=Object.create(null)},j.prototype={set:function(t,e){this.index[t]?this.index[t].push(e):this.index[t]=[e]},remove:function(t,e){var i=this.index[t];for(var n in i)i[n]==e&&i.splice(n,1);i.length<1&&(this.index[t]=void 0)},get:function(t){return this.index[t]},clear:function(t){this.index={}}},w.deepFreeze=i,w.freeze=n,w.unFreeze=o,w.LokiOps=_,w.Collection=L,w.DynamicView=k,w.Resultset=P,w.KeyValueStore=F,w.LokiMemoryAdapter=x,w.LokiPartitioningAdapter=T,w.LokiLocalStorageAdapter=E,w.LokiFsAdapter=S,w.persistenceAdapters={fs:S,localStorage:E},w.aeq=u,w.lt=h,w.gt=c,w.Comparators=l,w}()},"function"==typeof define&&define.amd?define([],Zt):"object"==typeof Yt?Yt=Zt():Ut.loki=Zt();var Wt,Ht=r("45fvw");Wt={UUID:{"06aa1910f22a11e39daa0002a5d5c51b":"/Organization/Nestle_Nespresso_SA/","07775dd0111b11e491910800200c9a66":"/Product/XY-Findables_Beacon/","0d60a2892039442198216b12c4274890":"/Product/Bluetooth_World_2017_Beacon/","2f234454cf6d4a0fadf2f4911ba9ffa6":"/Product/Radius-Networks_Beacon/","3d4f13b4d1fd404980e5d3edcc840b69":"/Product/Orange_Beacon/","52052c11e701478299f58ce88dbb1500":"/Product/Allegion_ENGAGE/","61687109905f443691f8e602f514c96d":"/Product/BlueCats_Beacon/","6e400001b5a3f393e0a9e50e24dcca9e":"/Organization/Nordic_Semiconductor_ASA/","7265656c794163746976652055554944":"/Product/reelyActive_RA-R436/","7265656c7941707020416e64726f6964":"/Product/reelyActive_reelyApp-Android/","7265656c7941707020666f7220694f53":"/Product/reelyActive_reelyApp-iOS/","74278bdab64445208f0c720eaf059935":"/Product/Minew_Beacon/","7a4385c9f7c74e229afd16d68fc588ca":"/Product/SocketMobile_S550/","8deefbb9f7384297804096668bb44281":"/Product/Roximity_Beacon/",adab0bd16e7d4601bda2bffaa68956ba:"/Product/Fitbit_Wearable/",adab0cf56e7d4601bda2bffaa68956ba:"/Product/Fitbit_Wearable/",adab71766e7d4601bda2bffaa68956ba:"/Product/Fitbit_Wearable/",adabfb006e7d4601bda2bffaa68956ba:"/Product/Fitbit_Wearable/",b9407f30f5f8466eaff925556b57fe6d:"/Product/Estimote_Beacon/",cbbfe0e1f7f3420684e084cbb3d09dfc:"/Product/ASUS_Nexus-Player/",d0d3fa86ca7645ec9bd96af4927d7be1:"/Product/Estimote_Beacon/",d2d3f8ef9c994d9ca2b391c85d44326c:"/Product/Nest_Cam/",d5060001a904deb947482c7f4a124842:"/Product/Thalmic-Labs_Myo/",dab59c4fa4d6ee286bfe8e0000bbc2bb:"/Product/Cocoanut-Manor_eNote/",e2c56db5dffb48d2b060d0f5a71096e0:"/Product/Bright_Beacon/",f0018b9b75094c31a9051a27d39c003c:"/Product/Locoslab_Beacon/",f02adfc026e711e49edc0002a5d5c51b:"/Product/Shortcut-Labs_FLIC/",f3077abe93ac465aacf167f080cb7aef:"/Product/The-Bubbles-Company_Beacon/",f7826da64fa24e988024bc5b71e0893e:"/Product/Kontakt_Beacon/"},UUID16:{fefd:"/Organization/Gimbal_Inc/",fefc:"/Organization/Gimbal_Inc/",fefa:"/Organization/PayPal_Inc/",fef9:"/Organization/PayPal_Inc/",fef8:"/Organization/Aplix_Corporation/",fef7:"/Organization/Aplix_Corporation/",fef6:"/Organization/Wicentric_Inc/",fef5:"/Organization/Dialog_Semiconductor_BV/",fef4:"/Organization/Google/",fef3:"/Organization/Google/",fef2:"/Organization/CSR/",fef1:"/Organization/CSR/",feef:"/Organization/Polar_Electro_Oy/",feee:"/Organization/Polar_Electro_Oy/",feed:"/Product/Tile_Tile/",feec:"/Product/Tile_Tile/",feeb:"/Organization/Swirl_Networks_Inc/",feea:"/Organization/Swirl_Networks_Inc/",fee7:"/Organization/Tencent_Holdings_Limited/",fee6:"/Organization/Seed_Labs_Inc/",fee5:"/Organization/Nordic_Semiconductor_ASA/",fee4:"/Organization/Nordic_Semiconductor_ASA/",fedd:"/Organization/Jawbone/",fedc:"/Organization/Jawbone/",fed9:"/Organization/Pebble_Technology_Corporation/",fed4:"/Organization/Apple_Inc/",fed3:"/Organization/Apple_Inc/",fed2:"/Organization/Apple_Inc/",fed1:"/Organization/Apple_Inc/",fed0:"/Organization/Apple_Inc/",fecf:"/Organization/Apple_Inc/",fece:"/Organization/Apple_Inc/",fecd:"/Organization/Apple_Inc/",fecc:"/Organization/Apple_Inc/",fecb:"/Organization/Apple_Inc/",feca:"/Organization/Apple_Inc/",fec9:"/Organization/Apple_Inc/",fec8:"/Organization/Apple_Inc/",fec7:"/Organization/Apple_Inc/",fec4:"/Organization/PLUS_Location_Systems/",febe:"/Organization/Bose_Corporation/",feba:"/Organization/Tencent_Holdings_Limited/",feb9:"/Organization/LG_Electronics/",feb8:"/Organization/Facebook_Inc/",feb7:"/Organization/Facebook_Inc/",feb2:"/Organization/Microsoft/",feb0:"/Organization/Nest_Labs/",feaf:"/Organization/Nest_Labs/",feaa:"/Product/Google_Eddystone/",fea6:"/Organization/GoPro_Inc/",fea5:"/Organization/GoPro_Inc/",fea0:"/Product/Google_Chromecast/",fe9f:"/Product/Google_Chromecast/",fe9e:"/Organization/Dialog_Semiconductor_BV/",fe9a:"/Organization/Estimote_Inc/",fe95:"/Organization/Xiaomi/",fe8f:"/Organization/CSR/",fe8b:"/Organization/Apple_Inc/",fe8a:"/Organization/Apple_Inc/",fe86:"/Organization/Huawei_Technologies_Co_Ltd/",fe78:"/Organization/HP_Inc/",fe77:"/Organization/HP_Inc/",fe65:"/Organization/CHIPOLO/",fe61:"/Organization/Logitech_International_SA/",fe59:"/Organization/Nordic_Semiconductor_ASA/",fe58:"/Organization/Nordic_Semiconductor_ASA/",fe56:"/Organization/Google/",fe55:"/Organization/Google/",fe50:"/Organization/Google/",fe4b:"/Organization/Signify/",fe3b:"https://www.dolby.com/",fe36:"/Organization/Huawei_Technologies_Co_Ltd/",fe35:"/Organization/Huawei_Technologies_Co_Ltd/",fe33:"/Organization/CHIPOLO/",fe2c:"/Organization/Google/",fe27:"/Organization/Google/",fe26:"/Organization/Google/",fe25:"/Organization/Apple_Inc/",fe24:"/Organization/August_Home_Inc/",fe21:"/Organization/Bose_Corporation/",fe1f:"/Organization/Garmin_International/",fe19:"/Organization/Google/",fe15:"/Organization/Amazon_com_Services_Inc/",fe13:"/Organization/Apple_Inc/",fe0f:"/Organization/Signify/",fe08:"/Organization/Microsoft/",fe07:"/Organization/Sonos_Inc/",fe03:"/Organization/Amazon_com_Services_Inc/",fe00:"/Organization/Amazon_com_Services_Inc/",fdf7:"/Organization/HP_Inc/",fdf0:"/Organization/Google/",fdee:"/Organization/Huawei_Technologies_Co_Ltd/",fde2:"/Organization/Google/",fddb:"/Organization/Samsung/",fdd2:"/Organization/Bose_Corporation/",fdd1:"/Organization/Huawei_Technologies_Co_Ltd/",fdd0:"/Organization/Huawei_Technologies_Co_Ltd/",fdb4:"/Organization/HP_Inc/",fdab:"/Organization/Xiaomi/",fdaa:"/Organization/Xiaomi/",fd9c:"/Organization/Huawei_Technologies_Co_Ltd/",fd9b:"/Organization/Huawei_Technologies_Co_Ltd/",fd9a:"/Organization/Huawei_Technologies_Co_Ltd/",fd96:"/Organization/Google/",fd8c:"/Organization/Google/",fd8a:"/Organization/Signify/",fd87:"/Organization/Google/",fd84:"/Product/Tile_Tile/",fd82:"/Organization/Sony_Corporation/",fd7e:"/Organization/Samsung/",fd7c:"/Organization/Toshiba_Corporation/",fd72:"/Organization/Logitech_International_SA/",fd6f:"/Service/Contact_Tracing/",fd6c:"/Organization/Samsung/",fd69:"/Organization/Samsung/",fd63:"/Product/Fitbit_Wearable/",fd62:"/Product/Fitbit_Wearable/",fd5a:"/Organization/Samsung/",fd59:"/Organization/Samsung/",fd4b:"/Organization/Samsung/",fd44:"/Organization/Apple_Inc/",fd43:"/Organization/Apple_Inc/",fd36:"/Organization/Google/",fd31:"/Organization/LG_Electronics/",fd2d:"/Organization/Xiaomi/",fd2a:"/Organization/Sony_Corporation/",fd22:"/Organization/Huawei_Technologies_Co_Ltd/",fd21:"/Organization/Huawei_Technologies_Co_Ltd/",fd1d:"/Organization/Samsung/"},COMPANY_IDENTIFIERS:{"0003":"/Organization/IBM_Corporation/","0004":"/Organization/Toshiba_Corporation/","0006":"/Organization/Microsoft/","000a":"/Organization/CSR/","0044":"/Organization/Socket_Mobile/","004c":"/Organization/Apple_Inc/","0059":"/Organization/Nordic_Semiconductor_ASA/","005f":"/Organization/Wicentric_Inc/","0065":"/Organization/HP_Inc/","006b":"/Organization/Polar_Electro_Oy/","0075":"/Organization/Samsung/","0077":"/Organization/Laird_Connectivity/","0078":"/Organization/Nike_Inc/","0087":"/Organization/Garmin_International/","008a":"/Organization/Jawbone/","008c":"/Organization/Gimbal_Inc/","009e":"/Organization/Bose_Corporation/","00b5":"/Organization/Swirl_Networks_Inc/","00bd":"/Organization/Aplix_Corporation/","00c4":"/Organization/LG_Electronics/","00c7":"/Organization/Quuppa_Oy/","00cc":"/Organization/Beats_Electronics/","00cd":"/Organization/Microchip_Technology_Inc/","00d2":"/Organization/Dialog_Semiconductor_BV/","00df":"/Organization/Misfit_Inc/","00e0":"/Organization/Google/","00f0":"/Organization/PayPal_Inc/","0104":"/Organization/PLUS_Location_Systems/","011b":"/Organization/Aruba_Networks/","012d":"/Organization/Sony_Corporation/","0131":"/Organization/Cypress_Semiconductor_Corporation/","0136":"/Organization/Seed_Labs_Inc/","013a":"/Organization/Tencent_Holdings_Limited/","0147":"/Organization/Mighty_Cast_Inc/","0154":"/Organization/Pebble_Technology_Corporation/","0157":"/Organization/Xiaomi/","015d":"/Organization/Estimote_Inc/","015e":"/Organization/UniKey_Technologies_Inc/","0171":"/Organization/Amazon_com_Services_Inc/","0180":"/Organization/Gigaset_Communications_GmbH/","0195":"/Organization/Zuli_Inc/","01ab":"/Organization/Facebook_Inc/","01b5":"/Organization/Nest_Labs/","01d1":"/Organization/August_Home_Inc/","01da":"/Organization/Logitech_International_SA/","0211":"/Organization/Telink_Semiconductor_Co_Ltd/","0225":"/Organization/Nestle_Nespresso_SA/","027d":"/Organization/Huawei_Technologies_Co_Ltd/","02b2":"/Product/OURA_Ring/","02d3":"/Organization/Powercast_Corporation/","02f2":"/Organization/GoPro_Inc/","0309":"/https://www.dolby.com/","0399":"/Organization/Nikon_Corporation/","03c2":"/Organization/Snapchat_Inc/","03da":"/Organization/EnOcean_GmbH/","0499":"/Organization/Ruuvi_Innovations_Ltd/","0528":"/Organization/Lunera_Inc/","0583":"/Organization/Code_Blue_Communications_Inc/","0590":"/Organization/Pur3_Ltd/","05a7":"/Organization/Sonos_Inc/","060f":"/Organization/Signify/","0639":"/Organization/Shenzhen_Minew_Technologies_Co_Ltd/"},APPLE_Continuity:{"03":"AirPrint","05":"AirDrop","06":"HomeKit","07":"ProximityPairing","08":"HeySiri","09":"AirPlay","0b":"MagicSwitch","0c":"Handoff","0d":"TetheringTargetPresence","0e":"TetheringSourcePresence","0f":"NearbyAction",10:"NearbyInfo"}};const Vt={maxZoom:20,id:"mapbox/dark-v10",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiZGF0YXBhcnR5IiwiYSI6ImNremFnMnlyZjIzZHMycG5mczZ1bDljM2gifQ.uGoEE_YpTbIlELvytTzbNQ"};async function qt(t=100){return new Promise(((e,i)=>{setTimeout(e,t)}))}class Gt{constructor(t){this.showAllTracks=!1,this.showAwayTracks=!1,this.map=xt.map(t,{attributionControl:!1}).setView([47.6,-122.35],13),xt.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",Vt).addTo(this.map),this.db=new Yt("session"),this.db.addCollection("locationTrack",{indices:["timestamp","lat","lon","filename","source"]}),this.db.addCollection("homeState",{indices:["timestamp","filename"]}),this.db.addCollection("awayTime",{indices:["starttime","endtime","bounds.min.x","bounds.min.y","bounds.max.x","bounds.max.y"]}),this.db.addCollection("ble",{indices:["firstseen","lastseen","address","duration","advertisement.localName","connectable","addressType","services","hasUnknownService","company","product","companyCode","productCode","appleContinuityTypeCode","appleIp"]}),this.db.addCollection("appleDevices",{indices:["address","continuityCode","ip"]}),this.mobileSegments=[],this.srcs={},this.deviceLayers={},this.searchResults=null,this.scanDb=null,this.gpxLines={}}async start(){console.log("starting");let t=this.db.getCollection("awayTime").find();console.log("found",t.length,"away time periods");let e=[];for(let i of t){let t=this.getTrackByTime(i.starttime,i.endtime);if(0==t.length)continue;let n=this.trackToLatLonArray(t);console.log("\trendering",n.length,"track points"),this.showAwayTracks&&xt.polyline(n,{color:"yellow",opacity:.74,weight:"2"}).addTo(this.map);let r=this.db.getCollection("ble").find({lastseen:{$between:[i.starttime,i.endtime]},duration:{$gt:18e5}});e=e.concat(r)}this.renderBleDeviceList(e)}handleSearch(t){let e=null,i=t.slice(1).join(" ");switch(t[0]){case"name":case"localname":console.log("select by name",t),e=this.db.getCollection("ble").find({"advertisement.localName":{$contains:i}}),console.log("term["+i+"]");break;case"company":console.log("select by company",t),e=this.db.getCollection("ble").find({company:{$contains:i}});break;case"product":console.log("select by product",t),e=this.db.getCollection("ble").find({product:{$contains:i}});break;case"unknown-service":e=this.db.getCollection("ble").find({hasUnknownService:{$exists:!0}});break;case"service":console.log("select by service",t);let n=Gt.reverseLookupService(i);console.log("possible",n),e=this.db.getCollection("ble").find({services:{$containsAny:n}});break;case"appleIp":console.log("select by appleIp",t),e=t.length<2?this.db.getCollection("ble").find({appleIp:{$exists:!0}}):this.db.getCollection("ble").find({appleIp:{$contains:i}});break;case"random":e=this.db.getCollection("ble").find({addressType:{$eq:"random"}});break;case"public":e=this.db.getCollection("ble").find({addressType:{$eq:"public"}});break;case"connectable":e=this.db.getCollection("ble").find({connectable:{$eq:!0}});break;case"duration":e=this.db.getCollection("ble").find({duration:{$gt:18e5}});break;default:console.log("unknown select type",t[0])}console.log(e),null!=e&&this.renderBleDeviceList(e)}renderBleDeviceList(t){console.log("\trendering",t.length,"ble devices"),null!=this.searchResults&&(this.map.removeLayer(this.searchResults),delete this.searchResults);let e=xt.layerGroup();for(let i of t){let t=this.getTrackPointByTime(i.lastseen);if(t){let n=xt.circle([t.lat,t.lon],{color:"white",radius:10,fill:!0,weight:1,opacity:1,fillOpacity:.3,fillColor:"white"});e.addLayer(n);let r=t=>{this.handleClick({event:t,type:"ble",value:i.address,timestamp:i.lastseen})};n.on("click",r);let o=this.getTrackPointByTime(i.firstseen);if(o){let n=xt.polyline([this.trackToLatLonArray([o,t])],{color:"blue",opacity:.5,weight:"5"});e.addLayer(n),n.on("click",r);let s=xt.circle([o.lat,o.lon],{color:"yellow",radius:5,fill:!0,weight:1,opacity:1});e.addLayer(s),s.on("click",(t=>{this.handleClick({event:t,type:"ble",value:i.address,timestamp:i.firstseen})}))}}}this.searchResults=e,e.addTo(this.map)}getBLEDevice(t){return this.db.getCollection("ble").find({address:t})[0]}updateDeviceInfoHud(){let t=Object.keys(this.deviceLayers);if(0==t.length){document.getElementsByClassName("device-info").classList.add("hidden")}else{let e=this.getBLEDevice(t[0]);console.log(e);let i="";Bt(e,"company")?i=Bt(e,"company")+"("+Bt(e,"companyCode")+")":Bt(e,"companyCode")&&(i="Unknown Company(0x"+Bt(e,"companyCode")+")"),Bt(e,"product")&&(i.length>0&&(i+="\n"),i+=Bt(e,"product")),document.getElementById("device-info-address").textContent=Bt(e,"address"),Bt(e,"advertisement.localName")?(document.getElementById("device-info-name").textContent=Bt(e,"advertisement.localName"),window.MainWindow.showDiv("device-info-name")):window.MainWindow.hideDiv("device-info-name"),document.getElementById("device-info-company").textContent=i;let n="";if(e.appleContinuityTypeCode){let t=Gt.lookupAppleService(e.appleContinuityTypeCode);n+=t?"Apple "+t+"(0x"+e.appleContinuityTypeCode+"); \n":"Apple 0x"+e.appleContinuityTypeCode+"; \n"}e.appleIp&&(n+="Apple IP "+e.appleIp+"; \n"),e.advertisement.serviceUuids.map((t=>{let e=Gt.lookupDeviceUuid(t);n+=e?e+"(0x"+t+"); \n":"0x"+t+"; \n"})),document.getElementById("device-info-services").textContent=n,document.getElementsByClassName("device-info")[0].classList.remove("hidden")}}handleClick({type:t,value:e,timestamp:i,event:n}){if(console.log("clicked type=",t,e,i,n),"ble"==t){console.log("shift",n.originalEvent.shiftKey);let t=xt.layerGroup(),i=this.getBLEDevice(e),r=[];for(let e of i.seen){let i=this.getTrackPointByTime(e.timestamp);if(i){r.push([i.lat,i.lon]);let e=xt.circle([i.lat,i.lon],{color:"green",radius:8,fill:!0,weight:1,opacity:.9});t.addLayer(e)}}if(r.length>0){let e=xt.polyline(r,{color:"green",opacity:.9,weight:"4"});t.addLayer(e)}if(!n.originalEvent.shiftKey)for(let t in this.deviceLayers){let e=this.deviceLayers[t];this.map.removeLayer(e),delete this.deviceLayers[t]}this.deviceLayers[e]=t,t.addTo(this.map),this.updateDeviceInfoHud()}}getTrackPointByTime(t){let e=null,i=null,n=this.getTrackByTime(t-6e4,t+6e3);for(let t of n){let r=Math.abs(Ht(t.timestamp).diff(n.timestamp));(r<e||null==e)&&(e=r,i=t)}return i}getTrackByTime(t,e){return this.db.getCollection("locationTrack").find({timestamp:{$between:[t,e]}})}trackToLatLonArray(t){let e=[];for(let i of t)e.push([i.lat,i.lon]);return e}getTrackPointsByTime(t,e){let i=[],n=this.getTrackByTime(t,e);for(let t of n)i.push(xt.point(t.lat,t.lon));return i}getTrackBoundsByTime(t,e){let i=this.getTrackPointsByTime(t,e);return xt.bounds(i)}async addScanDb(t,e){let i=new Yt(e);i.loadJSON(t);let n=this.db.getCollection("homeState"),r=this.db.getCollection("ble"),o=i.getCollection("wifi"),s=i.getCollection("homeState"),a=i.getCollection("ble"),l=(i.listCollections(),s.count()+a.count()+o.count());window.loadingState.startStep("index "+e,l),console.log("importing home state . . .");let u=null,h=!1,c=0;for(let t of s.chain().find().simplesort("timestamp").data())if(n.insert({timestamp:t.timestamp,isHome:t.isHome,filename:e}),window.loadingState.completePart("index "+e),c++,c%3e3==0&&await qt(10),h||t.isHome){if(h&&t.isHome){
//! Device is now home
u.endtime=t.timestamp,u.duration=Ht(t.timestamp).diff(u.starttime);let e=this.getTrackPointsByTime(u.starttime,u.endtime);if(e.length>0){let t=xt.bounds(e);u.bounds={min:{x:t.min.x,y:t.min.y},max:{x:t.max.x,y:t.max.y}}}this.db.getCollection("awayTime").insert(u),u=null,h=!1}}else
//! Device is now away
u={starttime:t.timestamp,endtime:null,duration:null},h=!0;console.log("importing ble . . .");for(let t of a.chain().find().data({removeMeta:!0})){let i=t.seen[0].timestamp,n=t.seen[t.seen.length-1].timestamp;window.loadingState.completePart("index "+e),c++,c%500==0&&await qt(10);let o={firstseen:i,lastseen:n,duration:Math.abs(Ht(i).diff(n)),product:[],services:[],...t};if(t.advertisement.serviceUuids.map((e=>{let i=Gt.lookupDeviceUuid(e);i?i&&-1!=i.indexOf("Product")?o.product=i:i&&-1!=i.indexOf("Service")?o.services.push(i):!t.advertisement.manufacturerData&&i&&(o.company=i):(o.hasUnknownService||(o.hasUnknownService=[]),o.hasUnknownService.push(e))})),t.advertisement.manufacturerData){t.advertisement.manufacturerData.data.length;let e=Uint8Array.from(t.advertisement.manufacturerData.data),i=new wt(e.buffer);const n=i.slice(0,2).toString("hex").match(/.{2}/g).reverse().join("");if(o.companyCode=n,o.company=Gt.lookupDeviceCompany(n),"004c"==n){const t=i.slice(2,3).toString("hex");o.appleContinuityTypeCode=t;let e=Gt.lookupAppleService(t);if(e&&o.services.push(e),"09"==t){const t=i.slice(i.length-4,i.length),e=t[0]+"."+t[1]+"."+t[2]+"."+t[3];o.appleIp=e}}}r.insert(o)}for(let t of o.chain().find().data({removeMeta:!0}))window.loadingState.completePart("index "+e),c++,c%500==0&&await qt(1);console.log("importing wifi . . ."),window.loadingState.completeStep("index "+e),await qt(200)}async addGpx(t,e){console.log("adding gpx",e);let i=this.db.getCollection("locationTrack");const n=jt({json:t,path:"$..trkpt"})[0];window.loadingState.startStep("index "+e,n.length);const r=[];let o=0;for(let t of n){const n=Bt(t,"src.value"),s=Bt(t,"_attributes.lat"),a=Bt(t,"_attributes.lon"),l=Ht(Bt(t,"time.value"));window.loadingState.completePart("index "+e),o++,o%500==0&&await qt(0),i.insert({filename:e,elevation:Bt(t,"ele.value"),course:Bt(t,"course.value"),speed:Bt(t,"speed.value"),source:Bt(t,"src.value"),timestamp:l.valueOf(),lat:s,lon:a}),r.push([s,a]),n&&(this.srcs[n]||(this.srcs[n]=1),this.srcs[n]++)}this.showAllTracks&&xt.polyline(r,{color:"white",opacity:.4,weight:"2"}).addTo(this.map),window.loadingState.completeStep("index "+e)}static get Version(){return Tt.version}static lookupDeviceCompany(t){return Wt.COMPANY_IDENTIFIERS[t]}static lookupAppleService(t){return Wt.APPLE_Continuity[t]}static lookupDeviceUuid(t){let e=null;return 4==t.length?e=Wt.UUID16[t]:32==t.length&&(e=Wt.UUID[t]),e}static reverseLookupService(t){return[].concat(Gt.reverseLookupByName(Wt.APPLE_Continuity,t),Gt.reverseLookupByName(Wt.UUID,t),Gt.reverseLookupByName(Wt.UUID16,t))}static reverseLookupByName(t,e){let i=[];for(let n in t){const r=t[n];-1!=r.indexOf(e)&&i.push(r)}return i}}Ht=r("45fvw");var Kt={};!function(t){"function"==typeof define&&define.amd?define(t):Kt=t()}((function(){var t=function(){return this._events={},this},e=function(t,e,i){var n=[];e||(e=0),i||(i=t.length);for(var r=e;r<i;r++)n.push(t[r]);return n},i=t.execListener=function(t,e){return"function"==typeof t?t.apply(t,e):"object"==typeof t&&"function"==typeof t.handleEvent?t.handleEvent.apply(t,e):void 0},n=t.regexps={},r=t.eventRegexp=function(t){return n[t]||(n[t]=new RegExp("^"+t.replace("*",".*")+"$")),n[t]};t.prototype.emit=t.prototype.fire=t.prototype.trigger=function(t){var n=e(arguments,1);n.push(t);var o=r(t);t:for(var s in this._events){var a=r(s);if(a.test(t)||o.test(s))for(var l=this._events[s],u=0,h=l.length;u<h;u++){var c=i(l[u],n,t);if(!1===c)break t}}return this},t.prototype.on=t.prototype.addListener=t.prototype.addEventListener=function(t,e){return this._events[t]||(this._events[t]=[]),this._events[t].push(e),r(t),this.emit("newListener",t,e),this},t.prototype.once=t.prototype.addOnceListener=function(t,e){var n=this;return this.addListener(t,(function(){i(e,arguments),n.removeListener(t,this)})),this},t.prototype.many=t.prototype.addManyListener=function(t,e,n){var r=this,o=0;return this.addListener(t,(function(){i(e,arguments),++o===n&&r.removeListener(t,this)})),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeEventListener=function(t,e,i){var n=r(t);if(i){for(var o in this._events)if(n.test(o)){for(var s=this._events[o],a=[],l=0,u=s.length;l<u;l++)s[l]!==e&&a.push(s[l]);this._events[o]=a}}else for(var o in this._events)if(n.test(o)){var h=this._events[o].indexOf(e);if(h>-1){this._events[o].splice(h,1);break}}return this},t.prototype.offAll=t.prototype.removeAllListeners=function(t){if(t){var e=r(t);for(var i in this._events)e.test(i)&&(this._events[i]=[])}else this._events={};return this},t.prototype.count=t.prototype.countListeners=function(t){var e=0;if(t){var i=r(t);for(var n in this._events){(r(n).test(t)||i.test(n))&&(e+=this._events[n].length)}}else for(var n in this._events)e+=this._events[n].length;return e},t.prototype.listeners=t.prototype.getListeners=function(t){var e=[];if(t){var i=r(t);for(var n in this._events){(r(n).test(t)||i.test(n))&&e.push.apply(e,this._events[n])}}else{e=[];for(var n in this._events)e.push.apply(e,this._events[n])}return e};var o=function(t,e){var i={emitter:t,scope:e};return e+=":",i.emit=function(i){return arguments[0]=e+i,t.emit.apply(t,arguments),this},i.on=i.addListener=i.addEventListener=function(i,n){return t.addListener(e+i,n),this},i.once=i.addOnceListener=function(i,n){return t.addOnceListener(e+i,n),this},i.many=i.addManyListener=function(i,n,r){return t.addManyListener(e+i,n,r),this},i.off=i.removeListener=i.removeEventListener=function(i,n){return t.removeListener(e+i,n),this},i.offAll=i.removeAllListeners=function(i){return t.removeAllListeners(e+(i||"*")),this},i.count=i.countListeners=function(i){return t.countListeners(e+(i||"*"))},i.listeners=i.getListeners=function(i){return t.getListeners(e+(i||"*"))},i.namespace=function(i){return o(t,e+i)},i};return t.prototype.namespace=function(t){return o(this,t)},t}));class $t extends Kt{constructor(){super(),this.steps={}}get stepCount(){return Object.keys(this.steps).length}get completedCount(){let t=0;for(let e in this.steps){const i=this.steps[e];i.parts>1?t+=i.completedParts/i.parts:null!==i.successOrFail&&t++}return t}get progress(){return this.stepCount>0?this.completedCount/this.stepCount:0}hasStep(t){return void 0!==this.steps[t]}startStep(t,e=1){if(this.hasStep(t))throw new Error("duplicate step name: "+t);this.steps[t]={name:t,parts:e,completedParts:0,started:Date.now(),message:null,finished:null,successOrFail:null},this.emit("step-start",t),this.emit("progress",this.progress)}getStepProgress(t){const e=this.steps[t];return e.completedParts/e.parts}completePart(t){this.steps[t].completedParts++}completeStep(t,e=!0,i){this.steps[t].finished=Date.now(),this.steps[t].successOrFail=e,this.steps[t].message=i,this.emit("progress",this.progress),this.emit("step-complete",t,e),this.progress>=1&&this.emit("finished",this),!1===e&&this.emit("error",{step:t,message:i})}toString(){let t="";for(let e in this.steps){const i=this.steps[e];if(null==i.finished)t+=`\t◌\t ${i.name} \t\t\t ${Math.round(100*this.getStepProgress(e))}%\n`;else{let e=Math.abs(Ht(i.started).diff(i.finished));t+=`\t✓\t ${i.name} (${e}ms) \t\t\t🤘🏿 \n`}}return"\n"+t}}var Jt,Xt,Qt={},te=b;!function(t){t.parser=function(t,e){return new n(t,e)},t.SAXParser=n,t.SAXStream=s,t.createStream=function(t,e){return new s(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function n(e,r){if(!(this instanceof n))return new n(e,r);var o=this;!function(t){for(var e=0,n=i.length;e<n;e++)t[i[e]]=""}(o),o.q=o.c="",o.bufferCheckPosition=t.MAX_BUFFER_LENGTH,o.opt=r||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!e,o.noscript=!(!e&&!o.opt.noscript),o.state=x.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(u)),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),S(o,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}),n.prototype={end:function(){L(this)},write:function(e){var n=this;if(this.error)throw this.error;if(n.closed)return k(n,"Cannot write after close. Assign an onready handler.");if(null===e)return L(n);"object"==typeof e&&(e=e.toString());var r=0,o="";for(;o=F(e,r++),n.c=o,o;)switch(n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++),n.state){case x.BEGIN:if(n.state=x.BEGIN_WHITESPACE,"\ufeff"===o)continue;R(n,o);continue;case x.BEGIN_WHITESPACE:R(n,o);continue;case x.TEXT:if(n.sawRoot&&!n.closedRoot){for(var s=r-1;o&&"<"!==o&&"&"!==o;)(o=F(e,r++))&&n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++);n.textNode+=e.substring(s,r-1)}"<"!==o||n.sawRoot&&n.closedRoot&&!n.strict?(p(o)||n.sawRoot&&!n.closedRoot||I(n,"Text data outside of root node."),"&"===o?n.state=x.TEXT_ENTITY:n.textNode+=o):(n.state=x.OPEN_WAKA,n.startTagPosition=n.position);continue;case x.SCRIPT:"<"===o?n.state=x.SCRIPT_ENDING:n.script+=o;continue;case x.SCRIPT_ENDING:"/"===o?n.state=x.CLOSE_TAG:(n.script+="<"+o,n.state=x.SCRIPT);continue;case x.OPEN_WAKA:if("!"===o)n.state=x.SGML_DECL,n.sgmlDecl="";else if(p(o));else if(g(h,o))n.state=x.OPEN_TAG,n.tagName=o;else if("/"===o)n.state=x.CLOSE_TAG,n.tagName="";else if("?"===o)n.state=x.PROC_INST,n.procInstName=n.procInstBody="";else{if(I(n,"Unencoded <"),n.startTagPosition+1<n.position){var a=n.position-n.startTagPosition;o=new Array(a).join(" ")+o}n.textNode+="<"+o,n.state=x.TEXT}continue;case x.SGML_DECL:"[CDATA["===(n.sgmlDecl+o).toUpperCase()?(E(n,"onopencdata"),n.state=x.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+o==="--"?(n.state=x.COMMENT,n.comment="",n.sgmlDecl=""):"DOCTYPE"===(n.sgmlDecl+o).toUpperCase()?(n.state=x.DOCTYPE,(n.doctype||n.sawRoot)&&I(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===o?(E(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=x.TEXT):m(o)?(n.state=x.SGML_DECL_QUOTED,n.sgmlDecl+=o):n.sgmlDecl+=o;continue;case x.SGML_DECL_QUOTED:o===n.q&&(n.state=x.SGML_DECL,n.q=""),n.sgmlDecl+=o;continue;case x.DOCTYPE:">"===o?(n.state=x.TEXT,E(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=o,"["===o?n.state=x.DOCTYPE_DTD:m(o)&&(n.state=x.DOCTYPE_QUOTED,n.q=o));continue;case x.DOCTYPE_QUOTED:n.doctype+=o,o===n.q&&(n.q="",n.state=x.DOCTYPE);continue;case x.DOCTYPE_DTD:n.doctype+=o,"]"===o?n.state=x.DOCTYPE:m(o)&&(n.state=x.DOCTYPE_DTD_QUOTED,n.q=o);continue;case x.DOCTYPE_DTD_QUOTED:n.doctype+=o,o===n.q&&(n.state=x.DOCTYPE_DTD,n.q="");continue;case x.COMMENT:"-"===o?n.state=x.COMMENT_ENDING:n.comment+=o;continue;case x.COMMENT_ENDING:"-"===o?(n.state=x.COMMENT_ENDED,n.comment=O(n.opt,n.comment),n.comment&&E(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+o,n.state=x.COMMENT);continue;case x.COMMENT_ENDED:">"!==o?(I(n,"Malformed comment"),n.comment+="--"+o,n.state=x.COMMENT):n.state=x.TEXT;continue;case x.CDATA:"]"===o?n.state=x.CDATA_ENDING:n.cdata+=o;continue;case x.CDATA_ENDING:"]"===o?n.state=x.CDATA_ENDING_2:(n.cdata+="]"+o,n.state=x.CDATA);continue;case x.CDATA_ENDING_2:">"===o?(n.cdata&&E(n,"oncdata",n.cdata),E(n,"onclosecdata"),n.cdata="",n.state=x.TEXT):"]"===o?n.cdata+="]":(n.cdata+="]]"+o,n.state=x.CDATA);continue;case x.PROC_INST:"?"===o?n.state=x.PROC_INST_ENDING:p(o)?n.state=x.PROC_INST_BODY:n.procInstName+=o;continue;case x.PROC_INST_BODY:if(!n.procInstBody&&p(o))continue;"?"===o?n.state=x.PROC_INST_ENDING:n.procInstBody+=o;continue;case x.PROC_INST_ENDING:">"===o?(E(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=x.TEXT):(n.procInstBody+="?"+o,n.state=x.PROC_INST_BODY);continue;case x.OPEN_TAG:g(c,o)?n.tagName+=o:(C(n),">"===o?D(n):"/"===o?n.state=x.OPEN_TAG_SLASH:(p(o)||I(n,"Invalid character in tag name"),n.state=x.ATTRIB));continue;case x.OPEN_TAG_SLASH:">"===o?(D(n,!0),N(n)):(I(n,"Forward-slash in opening tag not followed by >"),n.state=x.ATTRIB);continue;case x.ATTRIB:if(p(o))continue;">"===o?D(n):"/"===o?n.state=x.OPEN_TAG_SLASH:g(h,o)?(n.attribName=o,n.attribValue="",n.state=x.ATTRIB_NAME):I(n,"Invalid attribute name");continue;case x.ATTRIB_NAME:"="===o?n.state=x.ATTRIB_VALUE:">"===o?(I(n,"Attribute without value"),n.attribValue=n.attribName,M(n),D(n)):p(o)?n.state=x.ATTRIB_NAME_SAW_WHITE:g(c,o)?n.attribName+=o:I(n,"Invalid attribute name");continue;case x.ATTRIB_NAME_SAW_WHITE:if("="===o)n.state=x.ATTRIB_VALUE;else{if(p(o))continue;I(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",E(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===o?D(n):g(h,o)?(n.attribName=o,n.state=x.ATTRIB_NAME):(I(n,"Invalid attribute name"),n.state=x.ATTRIB)}continue;case x.ATTRIB_VALUE:if(p(o))continue;m(o)?(n.q=o,n.state=x.ATTRIB_VALUE_QUOTED):(I(n,"Unquoted attribute value"),n.state=x.ATTRIB_VALUE_UNQUOTED,n.attribValue=o);continue;case x.ATTRIB_VALUE_QUOTED:if(o!==n.q){"&"===o?n.state=x.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=o;continue}M(n),n.q="",n.state=x.ATTRIB_VALUE_CLOSED;continue;case x.ATTRIB_VALUE_CLOSED:p(o)?n.state=x.ATTRIB:">"===o?D(n):"/"===o?n.state=x.OPEN_TAG_SLASH:g(h,o)?(I(n,"No whitespace between attributes"),n.attribName=o,n.attribValue="",n.state=x.ATTRIB_NAME):I(n,"Invalid attribute name");continue;case x.ATTRIB_VALUE_UNQUOTED:if(!_(o)){"&"===o?n.state=x.ATTRIB_VALUE_ENTITY_U:n.attribValue+=o;continue}M(n),">"===o?D(n):n.state=x.ATTRIB;continue;case x.CLOSE_TAG:if(n.tagName)">"===o?N(n):g(c,o)?n.tagName+=o:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=x.SCRIPT):(p(o)||I(n,"Invalid tagname in closing tag"),n.state=x.CLOSE_TAG_SAW_WHITE);else{if(p(o))continue;y(h,o)?n.script?(n.script+="</"+o,n.state=x.SCRIPT):I(n,"Invalid tagname in closing tag."):n.tagName=o}continue;case x.CLOSE_TAG_SAW_WHITE:if(p(o))continue;">"===o?N(n):I(n,"Invalid characters in closing tag");continue;case x.TEXT_ENTITY:case x.ATTRIB_VALUE_ENTITY_Q:case x.ATTRIB_VALUE_ENTITY_U:var l,u;switch(n.state){case x.TEXT_ENTITY:l=x.TEXT,u="textNode";break;case x.ATTRIB_VALUE_ENTITY_Q:l=x.ATTRIB_VALUE_QUOTED,u="attribValue";break;case x.ATTRIB_VALUE_ENTITY_U:l=x.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===o?(n[u]+=z(n),n.entity="",n.state=l):g(n.entity.length?f:d,o)?n.entity+=o:(I(n,"Invalid character in entity name"),n[u]+="&"+n.entity+o,n.entity="",n.state=l);continue;default:throw new Error(n,"Unknown state: "+n.state)}n.position>=n.bufferCheckPosition&&function(e){for(var n=Math.max(t.MAX_BUFFER_LENGTH,10),r=0,o=0,s=i.length;o<s;o++){var a=e[i[o]].length;if(a>n)switch(i[o]){case"textNode":P(e);break;case"cdata":E(e,"oncdata",e.cdata),e.cdata="";break;case"script":E(e,"onscript",e.script),e.script="";break;default:k(e,"Max buffer length exceeded: "+i[o])}r=Math.max(r,a)}var l=t.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=l+e.position}(n);return n}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;P(t=this),""!==t.cdata&&(E(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(E(t,"onscript",t.script),t.script="")}};try{e=r("ioRHp").Stream}catch(t){e=function(){}}var o=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function s(t,i){if(!(this instanceof s))return new s(t,i);e.apply(this),this._parser=new n(t,i),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(t){r.emit("error",t),r._parser.error=null},this._decoder=null,o.forEach((function(t){Object.defineProperty(r,"on"+t,{get:function(){return r._parser["on"+t]},set:function(e){if(!e)return r.removeAllListeners(t),r._parser["on"+t]=e,e;r.on(t,e)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(e.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof te&&"function"==typeof te.isBuffer&&te.isBuffer(t)){if(!this._decoder){var e=r("eNRCS").StringDecoder;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},s.prototype.on=function(t,i){var n=this;return n._parser["on"+t]||-1===o.indexOf(t)||(n._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),n.emit.apply(n,e)}),e.prototype.on.call(n,t,i)};var a="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2000/xmlns/",u={xml:a,xmlns:l},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,c=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,d=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function p(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function m(t){return'"'===t||"'"===t}function _(t){return">"===t||p(t)}function g(t,e){return t.test(e)}function y(t,e){return!g(t,e)}var v,b,w,x=0;for(var T in t.STATE={BEGIN:x++,BEGIN_WHITESPACE:x++,TEXT:x++,TEXT_ENTITY:x++,OPEN_WAKA:x++,SGML_DECL:x++,SGML_DECL_QUOTED:x++,DOCTYPE:x++,DOCTYPE_QUOTED:x++,DOCTYPE_DTD:x++,DOCTYPE_DTD_QUOTED:x++,COMMENT_STARTING:x++,COMMENT:x++,COMMENT_ENDING:x++,COMMENT_ENDED:x++,CDATA:x++,CDATA_ENDING:x++,CDATA_ENDING_2:x++,PROC_INST:x++,PROC_INST_BODY:x++,PROC_INST_ENDING:x++,OPEN_TAG:x++,OPEN_TAG_SLASH:x++,ATTRIB:x++,ATTRIB_NAME:x++,ATTRIB_NAME_SAW_WHITE:x++,ATTRIB_VALUE:x++,ATTRIB_VALUE_QUOTED:x++,ATTRIB_VALUE_CLOSED:x++,ATTRIB_VALUE_UNQUOTED:x++,ATTRIB_VALUE_ENTITY_Q:x++,ATTRIB_VALUE_ENTITY_U:x++,CLOSE_TAG:x++,CLOSE_TAG_SAW_WHITE:x++,SCRIPT:x++,SCRIPT_ENDING:x++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var i=t.ENTITIES[e],n="number"==typeof i?String.fromCharCode(i):i;t.ENTITIES[e]=n})),t.STATE)t.STATE[t.STATE[T]]=T;function S(t,e,i){t[e]&&t[e](i)}function E(t,e,i){t.textNode&&P(t),S(t,e,i)}function P(t){t.textNode=O(t.opt,t.textNode),t.textNode&&S(t,"ontext",t.textNode),t.textNode=""}function O(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function k(t,e){return P(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,S(t,"onerror",e),t}function L(t){return t.sawRoot&&!t.closedRoot&&I(t,"Unclosed root tag"),t.state!==x.BEGIN&&t.state!==x.BEGIN_WHITESPACE&&t.state!==x.TEXT&&k(t,"Unexpected end"),P(t),t.c="",t.closed=!0,S(t,"onend"),n.call(t,t.strict,t.opt),t}function I(t,e){if("object"!=typeof t||!(t instanceof n))throw new Error("bad call to strictFail");t.strict&&k(t,e)}function C(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,i=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(i.ns=e.ns),t.attribList.length=0,E(t,"onopentagstart",i)}function A(t,e){var i=t.indexOf(":")<0?["",t]:t.split(":"),n=i[0],r=i[1];return e&&"xmlns"===t&&(n="xmlns",r=""),{prefix:n,local:r}}function M(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=A(t.attribName,!0),i=e.prefix,n=e.local;if("xmlns"===i)if("xml"===n&&t.attribValue!==a)I(t,"xml: prefix must be bound to "+a+"\nActual: "+t.attribValue);else if("xmlns"===n&&t.attribValue!==l)I(t,"xmlns: prefix must be bound to "+l+"\nActual: "+t.attribValue);else{var r=t.tag,o=t.tags[t.tags.length-1]||t;r.ns===o.ns&&(r.ns=Object.create(o.ns)),r.ns[n]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,E(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function D(t,e){if(t.opt.xmlns){var i=t.tag,n=A(t.tagName);i.prefix=n.prefix,i.local=n.local,i.uri=i.ns[n.prefix]||"",i.prefix&&!i.uri&&(I(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),i.uri=n.prefix);var r=t.tags[t.tags.length-1]||t;i.ns&&r.ns!==i.ns&&Object.keys(i.ns).forEach((function(e){E(t,"onopennamespace",{prefix:e,uri:i.ns[e]})}));for(var o=0,s=t.attribList.length;o<s;o++){var a=t.attribList[o],l=a[0],u=a[1],h=A(l,!0),c=h.prefix,d=h.local,f=""===c?"":i.ns[c]||"",p={name:l,value:u,prefix:c,local:d,uri:f};c&&"xmlns"!==c&&!f&&(I(t,"Unbound namespace prefix: "+JSON.stringify(c)),p.uri=c),t.tag.attributes[l]=p,E(t,"onattribute",p)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),E(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=x.TEXT:t.state=x.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function N(t){if(!t.tagName)return I(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=x.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=x.SCRIPT);E(t,"onscript",t.script),t.script=""}var e=t.tags.length,i=t.tagName;t.strict||(i=i[t.looseCase]());for(var n=i;e--;){if(t.tags[e].name===n)break;I(t,"Unexpected close tag")}if(e<0)return I(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=x.TEXT);t.tagName=i;for(var r=t.tags.length;r-- >e;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,E(t,"onclosetag",t.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];var l=t.tags[t.tags.length-1]||t;t.opt.xmlns&&o.ns!==l.ns&&Object.keys(o.ns).forEach((function(e){var i=o.ns[e];E(t,"onclosenamespace",{prefix:e,uri:i})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=x.TEXT}function z(t){var e,i=t.entity,n=i.toLowerCase(),r="";return t.ENTITIES[i]?t.ENTITIES[i]:t.ENTITIES[n]?t.ENTITIES[n]:("#"===(i=n).charAt(0)&&("x"===i.charAt(1)?(i=i.slice(2),r=(e=parseInt(i,16)).toString(16)):(i=i.slice(1),r=(e=parseInt(i,10)).toString(10))),i=i.replace(/^0+/,""),isNaN(e)||r.toLowerCase()!==i?(I(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function R(t,e){"<"===e?(t.state=x.OPEN_WAKA,t.startTagPosition=t.position):p(e)||(I(t,"Non-whitespace before first tag."),t.textNode=e,t.state=x.TEXT)}function F(t,e){var i="";return e<t.length&&(i=t.charAt(e)),i}x=t.STATE,String.fromCodePoint||(v=String.fromCharCode,b=Math.floor,w=function(){var t,e,i=16384,n=[],r=-1,o=arguments.length;if(!o)return"";for(var s="";++r<o;){var a=Number(arguments[r]);if(!isFinite(a)||a<0||a>1114111||b(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?n.push(a):(t=55296+((a-=65536)>>10),e=a%1024+56320,n.push(t,e)),(r+1===o||n.length>i)&&(s+=v.apply(null,n),n.length=0)}return s},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:w,configurable:!0,writable:!0}):String.fromCodePoint=w)}(void 0===Qt?Qt.sax={}:Qt);var ee,ie,ne=(ie={isArray:function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}}).isArray;ee={copyOptions:function(t){var e,i={};for(e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i},ensureFlagExists:function(t,e){t in e&&"boolean"==typeof e[t]||(e[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||"number"!=typeof t.spaces&&"string"!=typeof t.spaces)&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){"alwaysArray"in t&&("boolean"==typeof t.alwaysArray||ne(t.alwaysArray))||(t.alwaysArray=!1)},ensureKeyExists:function(t,e){t+"Key"in e&&"string"==typeof e[t+"Key"]||(e[t+"Key"]=e.compact?"_"+t:t)},checkFnExists:function(t,e){return t+"Fn"in e}};var re,oe,se=ie.isArray;function ae(t){var e=Number(t);if(!isNaN(e))return e;var i=t.toLowerCase();return"true"===i||"false"!==i&&t}function le(t,e){var i;if(re.compact){if(!oe[re[t+"Key"]]&&(se(re.alwaysArray)?-1!==re.alwaysArray.indexOf(re[t+"Key"]):re.alwaysArray)&&(oe[re[t+"Key"]]=[]),oe[re[t+"Key"]]&&!se(oe[re[t+"Key"]])&&(oe[re[t+"Key"]]=[oe[re[t+"Key"]]]),t+"Fn"in re&&"string"==typeof e&&(e=re[t+"Fn"](e,oe)),"instruction"===t&&("instructionFn"in re||"instructionNameFn"in re))for(i in e)if(e.hasOwnProperty(i))if("instructionFn"in re)e[i]=re.instructionFn(e[i],i,oe);else{var n=e[i];delete e[i],e[re.instructionNameFn(i,n,oe)]=n}se(oe[re[t+"Key"]])?oe[re[t+"Key"]].push(e):oe[re[t+"Key"]]=e}else{oe[re.elementsKey]||(oe[re.elementsKey]=[]);var r={};if(r[re.typeKey]=t,"instruction"===t){for(i in e)if(e.hasOwnProperty(i))break;r[re.nameKey]="instructionNameFn"in re?re.instructionNameFn(i,e,oe):i,re.instructionHasAttributes?(r[re.attributesKey]=e[i][re.attributesKey],"instructionFn"in re&&(r[re.attributesKey]=re.instructionFn(r[re.attributesKey],i,oe))):("instructionFn"in re&&(e[i]=re.instructionFn(e[i],i,oe)),r[re.instructionKey]=e[i])}else t+"Fn"in re&&(e=re[t+"Fn"](e,oe)),r[re[t+"Key"]]=e;re.addParent&&(r[re.parentKey]=oe),oe[re.elementsKey].push(r)}}function ue(t){var e;if("attributesFn"in re&&t&&(t=re.attributesFn(t,oe)),(re.trim||"attributeValueFn"in re||"attributeNameFn"in re||re.nativeTypeAttributes)&&t)for(e in t)if(t.hasOwnProperty(e)&&(re.trim&&(t[e]=t[e].trim()),re.nativeTypeAttributes&&(t[e]=ae(t[e])),"attributeValueFn"in re&&(t[e]=re.attributeValueFn(t[e],e,oe)),"attributeNameFn"in re)){var i=t[e];delete t[e],t[re.attributeNameFn(e,t[e],oe)]=i}return t}function he(t){var e={};if(t.body&&("xml"===t.name.toLowerCase()||re.instructionHasAttributes)){for(var i,n=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(i=n.exec(t.body));)e[i[1]]=i[2]||i[3]||i[4];e=ue(e)}if("xml"===t.name.toLowerCase()){if(re.ignoreDeclaration)return;oe[re.declarationKey]={},Object.keys(e).length&&(oe[re.declarationKey][re.attributesKey]=e),re.addParent&&(oe[re.declarationKey][re.parentKey]=oe)}else{if(re.ignoreInstruction)return;re.trim&&(t.body=t.body.trim());var r={};re.instructionHasAttributes&&Object.keys(e).length?(r[t.name]={},r[t.name][re.attributesKey]=e):r[t.name]=t.body,le("instruction",r)}}function ce(t,e){var i;if("object"==typeof t&&(e=t.attributes,t=t.name),e=ue(e),"elementNameFn"in re&&(t=re.elementNameFn(t,oe)),re.compact){var n;if(i={},!re.ignoreAttributes&&e&&Object.keys(e).length)for(n in i[re.attributesKey]={},e)e.hasOwnProperty(n)&&(i[re.attributesKey][n]=e[n]);!(t in oe)&&(se(re.alwaysArray)?-1!==re.alwaysArray.indexOf(t):re.alwaysArray)&&(oe[t]=[]),oe[t]&&!se(oe[t])&&(oe[t]=[oe[t]]),se(oe[t])?oe[t].push(i):oe[t]=i}else oe[re.elementsKey]||(oe[re.elementsKey]=[]),(i={})[re.typeKey]="element",i[re.nameKey]=t,!re.ignoreAttributes&&e&&Object.keys(e).length&&(i[re.attributesKey]=e),re.alwaysChildren&&(i[re.elementsKey]=[]),oe[re.elementsKey].push(i);i[re.parentKey]=oe,oe=i}function de(t){re.ignoreText||(t.trim()||re.captureSpacesBetweenElements)&&(re.trim&&(t=t.trim()),re.nativeType&&(t=ae(t)),re.sanitize&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),le("text",t))}function fe(t){re.ignoreComment||(re.trim&&(t=t.trim()),le("comment",t))}function pe(t){var e=oe[re.parentKey];re.addParent||delete oe[re.parentKey],oe=e}function me(t){re.ignoreCdata||(re.trim&&(t=t.trim()),le("cdata",t))}function _e(t){re.ignoreDoctype||(t=t.replace(/^ /,""),re.trim&&(t=t.trim()),le("doctype",t))}function ge(t){t.note=t}var ye;ye=function(t,e){var i,n,r;return i=function(t){var e=ee.copyOptions(t);return ee.ensureSpacesExists(e),e}(e),n=Xt(t,i),r="compact"in i&&i.compact?"_parent":"parent",("addParent"in i&&i.addParent?JSON.stringify(n,(function(t,e){return t===r?"_":e}),i.spaces):JSON.stringify(n,null,i.spaces)).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")};var ve,be,we,xe=ie.isArray;function Te(t,e,i){return(!i&&t.spaces?"\n":"")+Array(e+1).join(t.spaces)}function Se(t,e,i){if(e.ignoreAttributes)return"";"attributesFn"in e&&(t=e.attributesFn(t,we,be));var n,r,o,s,a=[];for(n in t)t.hasOwnProperty(n)&&null!==t[n]&&void 0!==t[n]&&(s=e.noQuotesForNativeAttributes&&"string"!=typeof t[n]?"":'"',r=(r=""+t[n]).replace(/"/g,"&quot;"),o="attributeNameFn"in e?e.attributeNameFn(n,r,we,be):n,a.push(e.spaces&&e.indentAttributes?Te(e,i+1,!1):" "),a.push(o+"="+s+("attributeValueFn"in e?e.attributeValueFn(r,n,we,be):r)+s));return t&&Object.keys(t).length&&e.spaces&&e.indentAttributes&&a.push(Te(e,i,!1)),a.join("")}function Ee(t,e,i){return be=t,we="xml",e.ignoreDeclaration?"":"<?xml"+Se(t[e.attributesKey],e,i)+"?>"}function Pe(t,e,i){if(e.ignoreInstruction)return"";var n;for(n in t)if(t.hasOwnProperty(n))break;var r="instructionNameFn"in e?e.instructionNameFn(n,t[n],we,be):n;if("object"==typeof t[n])return be=t,we=r,"<?"+r+Se(t[n][e.attributesKey],e,i)+"?>";var o=t[n]?t[n]:"";return"instructionFn"in e&&(o=e.instructionFn(o,n,we,be)),"<?"+r+(o?" "+o:"")+"?>"}function Oe(t,e){return e.ignoreComment?"":"\x3c!--"+("commentFn"in e?e.commentFn(t,we,be):t)+"--\x3e"}function ke(t,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(t,we,be):t.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function Le(t,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(t,we,be):t)+">"}function Ie(t,e){return e.ignoreText?"":(t=(t=(t=""+t).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(t,we,be):t)}function Ce(t,e,i,n){return t.reduce((function(t,r){var o=Te(e,i,n&&!t);switch(r.type){case"element":return t+o+function(t,e,i){be=t,we=t.name;var n=[],r="elementNameFn"in e?e.elementNameFn(t.name,t):t.name;n.push("<"+r),t[e.attributesKey]&&n.push(Se(t[e.attributesKey],e,i));var o=t[e.elementsKey]&&t[e.elementsKey].length||t[e.attributesKey]&&"preserve"===t[e.attributesKey]["xml:space"];return o||(o="fullTagEmptyElementFn"in e?e.fullTagEmptyElementFn(t.name,t):e.fullTagEmptyElement),o?(n.push(">"),t[e.elementsKey]&&t[e.elementsKey].length&&(n.push(Ce(t[e.elementsKey],e,i+1)),be=t,we=t.name),n.push(e.spaces&&function(t,e){var i;if(t.elements&&t.elements.length)for(i=0;i<t.elements.length;++i)switch(t.elements[i][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;default:return!0}return!1}(t,e)?"\n"+Array(i+1).join(e.spaces):""),n.push("</"+r+">")):n.push("/>"),n.join("")}(r,e,i);case"comment":return t+o+Oe(r[e.commentKey],e);case"doctype":return t+o+Le(r[e.doctypeKey],e);case"cdata":return t+(e.indentCdata?o:"")+ke(r[e.cdataKey],e);case"text":return t+(e.indentText?o:"")+Ie(r[e.textKey],e);case"instruction":var s={};return s[r[e.nameKey]]=r[e.attributesKey]?r:r[e.instructionKey],t+(e.indentInstruction?o:"")+Pe(s,e,i)}}),"")}function Ae(t,e,i){var n;for(n in t)if(t.hasOwnProperty(n))switch(n){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||i)return!0;break;case e.cdataKey:if(e.indentCdata||i)return!0;break;case e.instructionKey:if(e.indentInstruction||i)return!0;break;case e.doctypeKey:case e.commentKey:default:return!0}return!1}function Me(t,e,i,n,r){be=t,we=e;var o="elementNameFn"in i?i.elementNameFn(e,t):e;if(null==t||""===t)return"fullTagEmptyElementFn"in i&&i.fullTagEmptyElementFn(e,t)||i.fullTagEmptyElement?"<"+o+"></"+o+">":"<"+o+"/>";var s=[];if(e){if(s.push("<"+o),"object"!=typeof t)return s.push(">"+Ie(t,i)+"</"+o+">"),s.join("");t[i.attributesKey]&&s.push(Se(t[i.attributesKey],i,n));var a=Ae(t,i,!0)||t[i.attributesKey]&&"preserve"===t[i.attributesKey]["xml:space"];if(a||(a="fullTagEmptyElementFn"in i?i.fullTagEmptyElementFn(e,t):i.fullTagEmptyElement),!a)return s.push("/>"),s.join("");s.push(">")}return s.push(De(t,i,n+1,!1)),be=t,we=e,e&&s.push((r?Te(i,n,!1):"")+"</"+o+">"),s.join("")}function De(t,e,i,n){var r,o,s,a=[];for(o in t)if(t.hasOwnProperty(o))for(s=xe(t[o])?t[o]:[t[o]],r=0;r<s.length;++r){switch(o){case e.declarationKey:a.push(Ee(s[r],e,i));break;case e.instructionKey:a.push((e.indentInstruction?Te(e,i,n):"")+Pe(s[r],e,i));break;case e.attributesKey:case e.parentKey:break;case e.textKey:a.push((e.indentText?Te(e,i,n):"")+Ie(s[r],e));break;case e.cdataKey:a.push((e.indentCdata?Te(e,i,n):"")+ke(s[r],e));break;case e.doctypeKey:a.push(Te(e,i,n)+Le(s[r],e));break;case e.commentKey:a.push(Te(e,i,n)+Oe(s[r],e));break;default:a.push(Te(e,i,n)+Me(s[r],o,e,i,Ae(s[r],e)))}n=n&&!a.length}return a.join("")}var Ne,ze=b;Ne=function(t,e){t instanceof ze&&(t=t.toString());var i=null;if("string"==typeof t)try{i=JSON.parse(t)}catch(t){throw new Error("The JSON structure is invalid")}else i=t;return ve(i,e)},Jt={xml2js:Xt=function(t,e){var i=Qt.parser(!0,{}),n={};if(oe=n,re=function(t){return re=ee.copyOptions(t),ee.ensureFlagExists("ignoreDeclaration",re),ee.ensureFlagExists("ignoreInstruction",re),ee.ensureFlagExists("ignoreAttributes",re),ee.ensureFlagExists("ignoreText",re),ee.ensureFlagExists("ignoreComment",re),ee.ensureFlagExists("ignoreCdata",re),ee.ensureFlagExists("ignoreDoctype",re),ee.ensureFlagExists("compact",re),ee.ensureFlagExists("alwaysChildren",re),ee.ensureFlagExists("addParent",re),ee.ensureFlagExists("trim",re),ee.ensureFlagExists("nativeType",re),ee.ensureFlagExists("nativeTypeAttributes",re),ee.ensureFlagExists("sanitize",re),ee.ensureFlagExists("instructionHasAttributes",re),ee.ensureFlagExists("captureSpacesBetweenElements",re),ee.ensureAlwaysArrayExists(re),ee.ensureKeyExists("declaration",re),ee.ensureKeyExists("instruction",re),ee.ensureKeyExists("attributes",re),ee.ensureKeyExists("text",re),ee.ensureKeyExists("comment",re),ee.ensureKeyExists("cdata",re),ee.ensureKeyExists("doctype",re),ee.ensureKeyExists("type",re),ee.ensureKeyExists("name",re),ee.ensureKeyExists("elements",re),ee.ensureKeyExists("parent",re),ee.checkFnExists("doctype",re),ee.checkFnExists("instruction",re),ee.checkFnExists("cdata",re),ee.checkFnExists("comment",re),ee.checkFnExists("text",re),ee.checkFnExists("instructionName",re),ee.checkFnExists("elementName",re),ee.checkFnExists("attributeName",re),ee.checkFnExists("attributeValue",re),ee.checkFnExists("attributes",re),re}(e),i.opt={strictEntities:!0},i.onopentag=ce,i.ontext=de,i.oncomment=fe,i.onclosetag=pe,i.onerror=ge,i.oncdata=me,i.ondoctype=_e,i.onprocessinginstruction=he,i.write(t).close(),n[re.elementsKey]){var r=n[re.elementsKey];delete n[re.elementsKey],n[re.elementsKey]=r,delete n.text}return n},xml2json:ye,js2xml:ve=function(t,e){e=function(t){var e=ee.copyOptions(t);return ee.ensureFlagExists("ignoreDeclaration",e),ee.ensureFlagExists("ignoreInstruction",e),ee.ensureFlagExists("ignoreAttributes",e),ee.ensureFlagExists("ignoreText",e),ee.ensureFlagExists("ignoreComment",e),ee.ensureFlagExists("ignoreCdata",e),ee.ensureFlagExists("ignoreDoctype",e),ee.ensureFlagExists("compact",e),ee.ensureFlagExists("indentText",e),ee.ensureFlagExists("indentCdata",e),ee.ensureFlagExists("indentAttributes",e),ee.ensureFlagExists("indentInstruction",e),ee.ensureFlagExists("fullTagEmptyElement",e),ee.ensureFlagExists("noQuotesForNativeAttributes",e),ee.ensureSpacesExists(e),"number"==typeof e.spaces&&(e.spaces=Array(e.spaces+1).join(" ")),ee.ensureKeyExists("declaration",e),ee.ensureKeyExists("instruction",e),ee.ensureKeyExists("attributes",e),ee.ensureKeyExists("text",e),ee.ensureKeyExists("comment",e),ee.ensureKeyExists("cdata",e),ee.ensureKeyExists("doctype",e),ee.ensureKeyExists("type",e),ee.ensureKeyExists("name",e),ee.ensureKeyExists("elements",e),ee.checkFnExists("doctype",e),ee.checkFnExists("instruction",e),ee.checkFnExists("cdata",e),ee.checkFnExists("comment",e),ee.checkFnExists("text",e),ee.checkFnExists("instructionName",e),ee.checkFnExists("elementName",e),ee.checkFnExists("attributeName",e),ee.checkFnExists("attributeValue",e),ee.checkFnExists("attributes",e),ee.checkFnExists("fullTagEmptyElement",e),e}(e);var i=[];return be=t,we="_root_",e.compact?i.push(De(t,e,0,!0)):(t[e.declarationKey]&&i.push(Ee(t[e.declarationKey],e,0)),t[e.elementsKey]&&t[e.elementsKey].length&&i.push(Ce(t[e.elementsKey],e,0,!i.length))),i.join("")},json2xml:Ne};class Re{static onload(t){console.log("RFParty.onload"),window.rfparty=new Gt(t);document.getElementsByName("setupForm")[0].addEventListener("submit",Re.startSession);document.getElementById("version-text").innerText="v"+Gt.Version,Re.openSetupForm()}static hideDiv(t){return Re.addRemoveClass(t,"add","hidden")}static showDiv(t){return Re.addRemoveClass(t,"remove","hidden")}static addRemoveClass(t,e="add",i="hidden",n="block"){var r=document.getElementById(t);"remove"===e?(r.classList.remove(i),"hidden"==i&&(r.style.display=n)):("hidden"==i&&(r.style.display="none"),r.classList.add(i))}static openSetupForm(){Re.showDiv("setup-modal"),Re.showDiv("modal-shadow"),Re.showDiv("logo"),Re.showDiv("center-modal","remove","hidden","flex")}static closeSetupForm(){null!=window.rfparty&&(Re.hideDiv("center-modal"),Re.hideDiv("logo"),Re.hideDiv("setup-modal"))}static openLoading(){Re.showDiv("modal-shadow"),Re.showDiv("center-modal","remove","hidden","flex"),Re.showDiv("logo"),Re.showDiv("loading-bar"),Re.addRemoveClass("logo","add","rainbow-busy"),window.loadingState=new $t,window.loadingState.on("step-start",(t=>{document.getElementById("loading-details").value=window.loadingState.toString()})),window.loadingState.on("step-complete",(t=>{document.getElementById("loading-details").value=window.loadingState.toString()})),window.loadingState.on("progress",(t=>{document.getElementById("loading-value").innerText=""+Math.round(100*t),document.getElementById("loading-progress-bar").value=100*t}))}static closeLoading(){Re.addRemoveClass("center-modal","add","fadeOut"),setTimeout((()=>{Re.hideDiv("center-modal"),Re.hideDiv("logo"),Re.hideDiv("modal-shadow"),Re.hideDiv("loading-bar"),Re.addRemoveClass("logo","remove","rainbow-busy")}),2e3)}static async startSession(t){t.preventDefault(),console.log("startSession"),Re.closeSetupForm(),Re.openLoading(),await Re.setupSession(),Re.closeLoading()}static async delay(t=100){return new Promise(((e,i)=>{setTimeout(e,t)}))}static async setupSession(){const t=document.getElementById("gpxFiles"),e=[],i=document.getElementById("scanDBFile"),n=new FileReader;let r=new Promise(((t,e)=>{window.loadingState.startStep("read "+i.files[0].name),n.onload=()=>{window.loadingState.completeStep("read "+i.files[0].name),t(window.rfparty.addScanDb(n.result,i.files[0].name))},n.onabort=e,n.addEventListener("error",e)}));n.readAsText(i.files[0]),e.push(r);for(let i of t.files){const t=new FileReader;window.loadingState.startStep("read "+i.name);let n=new Promise(((e,n)=>{t.onload=()=>{const n=Jt.xml2js(t.result,{compact:!0,textKey:"value",nativeType:!0,nativeTypeAttributes:!0});window.loadingState.completeStep("read "+i.name),e(window.rfparty.addGpx(n,i.name))},t.onabort=n,t.addEventListener("error",n)}));t.readAsText(i),e.push(n)}await Promise.all(e);Re.delay(1e3),await window.rfparty.start(),document.getElementById("search-input").addEventListener("change",(t=>{const e=t.target.value;console.log("search input",e);const i=e.split(" ");window.rfparty.handleSearch.bind(window.rfparty)(i)}))}}var Fe=Ft;window.JSONPath=Fe,window.rfparty=null,window.RFParty=Gt,window.MainWindow=Re;
//# sourceMappingURL=index.ee3d241c.js.map
